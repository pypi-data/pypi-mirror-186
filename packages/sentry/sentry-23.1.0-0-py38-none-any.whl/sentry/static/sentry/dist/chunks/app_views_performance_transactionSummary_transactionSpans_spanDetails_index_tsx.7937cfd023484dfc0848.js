"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionSpans_spanDetails_index_tsx"],{"./app/actionCreators/events.tsx":(e,t,s)=>{s.d(t,{JE:()=>p,eV:()=>d,lI:()=>l});var a=s("../node_modules/lodash/pick.js"),n=s.n(a),r=s("./app/components/charts/utils.tsx"),o=s("./app/utils/getPeriod.tsx"),i=s("./app/utils/performance/constants.tsx");const l=(e,t)=>{let{organization:s,project:a,environment:n,team:i,period:l,start:d,end:p,interval:c,comparisonDelta:u,includePrevious:m,query:h,yAxis:g,field:x,topEvents:v,orderby:y,partial:Z,withoutZerofill:f,referrer:b,queryBatching:S,generatePathname:j,queryExtras:w,excludeOther:D,includeAllArgs:_}=t;const T=j?.(s)??`/organizations/${s.slug}/events-stats/`,C=(0,r.Sw)(m,l),k={includeAllArgs:_,query:{...Object.fromEntries(Object.entries({interval:c,comparisonDelta:u,project:a,environment:n,team:i,query:h,yAxis:g,field:x,topEvents:v,orderby:y,partial:Z?"1":void 0,withoutZerofill:f?"1":void 0,referrer:b||"api.organization-event-stats",excludeOther:D?"1":void 0}).filter((e=>{let[,t]=e;return void 0!==t}))),...(0,o.X)({period:l,start:d,end:p},{shouldDoublePeriod:C}),...w}};return S?.batchRequest?S.batchRequest(e,T,k):e.requestPromise(T,k)};function d(e,t,s){const a={...n()(s,Object.values(i.s)),query:s.query};return e.requestPromise(`/organizations/${t}/events-facets/`,{query:a})}function p(e,t,s){const a={...n()(s,Object.values(i.s)),query:s.query};return e.requestPromise(`/organizations/${t}/events-meta/`,{query:a}).then((e=>e.count))}},"./app/components/charts/barChartZoom.tsx":(e,t,s)=>{s.d(t,{Z:()=>d});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),r=s("../node_modules/react-router/es/index.js"),o=s("./app/components/charts/components/dataZoomInside.tsx"),i=s("./app/components/charts/components/toolBox.tsx");class l extends n.Component{constructor(){super(...arguments),(0,a.Z)(this,"zooming",null),(0,a.Z)(this,"handleChartReady",(e=>{this.props.onChartReady?.(e)})),(0,a.Z)(this,"handleChartFinished",((e,t)=>{"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const s=t._componentsViews?.find((e=>e._features&&e._features.dataZoom));s&&!s._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0})})),(0,a.Z)(this,"handleDataZoom",((e,t)=>{const s=t.getModel(),{startValue:a,endValue:n}=s._payload.batch[0];if(null!==a&&null!==n){const{buckets:e,location:s,paramStart:o,paramEnd:i,minZoomWidth:l,onHistoryPush:d}=this.props,{start:p}=e[a],{end:c}=e[n];if(void 0===l||c-p>l){const e={pathname:s.pathname,query:{...s.query,[o]:p,[i]:c}};d?d(p,c):r.browserHistory.push(e)}else t.dispatchAction({type:"restore"}),this.props.onDataZoomCancelled?.()}else t.dispatchAction({type:"restore"}),this.props.onDataZoomCancelled?.();this.props.onDataZoom?.(e,t)}))}render(){const{children:e,xAxisIndex:t}=this.props;return e({onChartReady:this.handleChartReady,onFinished:this.handleChartFinished,dataZoom:(0,o.Z)({xAxisIndex:t}),toolBox:(0,i.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom})}}l.displayName="BarChartZoom";const d=l},"./app/components/charts/chartZoom.tsx":(e,t,s)=>{s.d(t,{Z:()=>v});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),r=s("../node_modules/moment/moment.js"),o=s.n(r),i=s("../node_modules/query-string/index.js"),l=s("./app/actionCreators/pageFilters.tsx"),d=s("./app/components/charts/components/dataZoomInside.tsx");s("../node_modules/echarts/lib/component/dataZoomSlider.js");const p={realtime:!1,showDetail:!1,left:0,right:6,bottom:8};function c(e){return e&&Array.isArray(e)?e:[{...p,...e}]}var u=s("./app/components/charts/components/toolBox.tsx"),m=s("./app/utils/callIfFunction.tsx"),h=s("./app/utils/dates.tsx");const g=e=>e?o().utc(e).format(o().HTML5_FMT.DATETIME_LOCAL_SECONDS):null;class x extends n.Component{constructor(e){var t;super(e),t=this,(0,a.Z)(this,"history",void 0),(0,a.Z)(this,"currentPeriod",void 0),(0,a.Z)(this,"zooming",null),(0,a.Z)(this,"saveCurrentPeriod",(e=>{this.currentPeriod={period:e.period,start:g(e.start),end:g(e.end)}})),(0,a.Z)(this,"setPeriod",(function(e){let{period:s,start:a,end:n}=e,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{router:o,onZoom:d,usePageDate:p}=t.props,c=g(a),u=g(n);r&&t.history.push(t.currentPeriod),d?.({period:s,start:c,end:u}),t.zooming=()=>{if(p&&o){const e={...o.location.query,pageStart:a?(0,h.v5)(a):void 0,pageEnd:n?(0,h.v5)(n):void 0,pageStatsPeriod:s??void 0};i.stringify(e)!==i.stringify(o.location.query)&&o.push({pathname:o.location.pathname,query:e})}else(0,l.dR)({period:s,start:c?(0,h.hC)(c):c,end:u?(0,h.hC)(u):u},o);t.saveCurrentPeriod({period:s,start:a,end:n})}})),(0,a.Z)(this,"handleChartReady",(e=>{this.props.onChartReady?.(e)})),(0,a.Z)(this,"handleZoomRestore",((e,t)=>{this.history.length&&(this.setPeriod(this.history[0]),this.history=[],this.props.onRestore?.(e,t))})),(0,a.Z)(this,"handleDataZoom",((e,t)=>{const s=t.getModel(),{startValue:a,endValue:n}=s._payload.batch[0];if(null===a&&null===n){const e=this.history.pop();if(!e)return;this.setPeriod(e)}else{const e=o().utc(a),t=o().utc(n);this.setPeriod({period:null,start:e,end:t},!0)}this.props.onDataZoom?.(e,t)})),(0,a.Z)(this,"handleChartFinished",((e,t)=>{"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const s=t._componentsViews?.find((e=>e._features&&e._features.dataZoom));s&&!s._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0}),(0,m.g)(this.props.onFinished)})),this.history=[],this.saveCurrentPeriod(e)}componentDidUpdate(){this.props.disabled||this.saveCurrentPeriod(this.props)}render(){const{utc:e,start:t,end:s,disabled:a,children:n,xAxisIndex:r,router:o,onZoom:i,onRestore:l,onChartReady:p,onDataZoom:m,onFinished:g,showSlider:x,chartZoomOptions:v,...y}=this.props,Z=e??void 0,f=t?(0,h.hC)(t):void 0,b=s?(0,h.hC)(s):void 0;return n(a?{utc:Z,start:f,end:b,...y}:{isGroupedByDate:!0,onChartReady:this.handleChartReady,utc:Z,start:f,end:b,dataZoom:x?[...c({xAxisIndex:r,...v}),...(0,d.Z)({xAxisIndex:r,...v})]:(0,d.Z)({xAxisIndex:r,...v}),showTimeInTooltip:!0,toolBox:(0,u.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom,onFinished:this.handleChartFinished,onRestore:this.handleZoomRestore,...y})}}x.displayName="ChartZoom";const v=x},"./app/components/charts/components/dataZoomInside.tsx":(e,t,s)=>{s.d(t,{Z:()=>n}),s("../node_modules/echarts/lib/component/dataZoomInside.js");const a={type:"inside",zoomOnMouseWheel:!1,zoomLock:!0,throttle:50};function n(e){return e&&Array.isArray(e)?e:[{...a,...e}]}},"./app/components/charts/components/toolBox.tsx":(e,t,s)=>{function a(){let{dataZoom:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e?{dataZoom:{yAxisIndex:"none",title:{zoom:"zoom",back:"undo"},...e}}:{},...t}}function n(e,t){return{right:0,top:0,itemSize:16,z:-1,feature:a(t),...e}}s.d(t,{Z:()=>n})},"./app/components/charts/errorPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>a});const a=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1t1x7f30"})("display:flex;flex-direction:column;justify-content:center;align-items:center;flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height||"200px"),";position:relative;border-color:transparent;margin-bottom:0;color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeExtraLarge),";")},"./app/components/charts/eventsRequest.tsx":(e,t,s)=>{s.d(t,{Z:()=>b});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),r=s("../node_modules/lodash/isEqual.js"),o=s.n(r),i=s("../node_modules/lodash/omitBy.js"),l=s.n(i),d=s("./app/actionCreators/events.tsx"),p=s("./app/actionCreators/indicator.tsx"),c=s("./app/components/charts/loadingPanel.tsx"),u=s("./app/components/charts/utils.tsx"),m=s("./app/locale.tsx"),h=s("./app/utils.tsx"),g=s("./app/utils/discover/fieldRenderers.tsx"),x=s("./app/utils/discover/fields.tsx"),v=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const y=["api","children","organization","loading","queryBatching","generatePathname"],Z=e=>l()(e,((e,t)=>y.includes(t)));class f extends n.PureComponent{constructor(){var e;super(...arguments),e=this,(0,a.Z)(this,"state",{reloading:!!this.props.loading,errored:!1,timeseriesData:null,fetchedWithPrevious:!1}),(0,a.Z)(this,"unmounting",!1),(0,a.Z)(this,"fetchData",(async()=>{const{api:e,confirmedQuery:t,onError:s,expired:a,name:n,hideError:r,...o}=this.props;let i,l=null;if(!1!==t){if(this.setState((e=>({reloading:null!==e.timeseriesData,errored:!1,errorMessage:void 0}))),a)i=(0,m.t)("%s has an invalid date range. Please try a more recent date range.",n),(0,p.Iw)(i,{append:!0}),this.setState({errored:!0,errorMessage:i});else try{e.clear(),l=await(0,d.lI)(e,o)}catch(e){i=e&&e.responseJSON&&e.responseJSON.detail?e.responseJSON.detail:(0,m.t)("Error loading chart data"),r||(0,p.Iw)(i),s&&s(i),this.setState({errored:!0,errorMessage:i})}this.unmounting||(this.setState({reloading:!1,timeseriesData:l,fetchedWithPrevious:o.includePrevious}),o.dataLoadedCallback&&o.dataLoadedCallback(l))}})),(0,a.Z)(this,"getData",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const{fetchedWithPrevious:s}=e.state,{period:a,includePrevious:n}=e.props,r=s||(0,u.Sw)(n,a),o=Math.floor(t.length/2);return{current:r?t.slice(o):t,previous:r?t.slice(0,o):null}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){o()(Z(e),Z(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}calculateTotalsPerTimestamp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>1e3*e;return e.map(((e,s)=>{let[a,n]=e;return{name:t(a,n,s),value:n.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)}}))}transformPreviousPeriodData(e,t,s){return t?{seriesName:s??"Previous",data:this.calculateTotalsPerTimestamp(t,((t,s,a)=>1e3*e[a][0])),stack:"previous"}:null}transformAggregatedTimeseries(e){return{seriesName:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",data:this.calculateTotalsPerTimestamp(e)}}transformTimeseriesData(e,t,s){let a=1;if(s){const e=t?.units?.[(0,x.LY)(s)];a=(e&&(g.a_[e]??g.en[e]))??1}return[{seriesName:s||"Current",data:e.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)*a}}))}]}transformComparisonTimeseriesData(e){return[{seriesName:"comparisonCount()",data:e.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{comparisonCount:s}=t;return e+(s??0)}),0)}}))}]}processData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0;const{data:a,isMetricsData:n,totals:r,meta:o}=e,{includeTransformedData:i,includeTimeAggregation:l,timeAggregationSeriesName:d,currentSeriesNames:p,previousSeriesNames:c,comparisonDelta:m}=this.props,{current:h,previous:g}=this.getData(a);return{data:i?this.transformTimeseriesData(h,o,s??p?.[t]):[],comparisonData:i&&m?this.transformComparisonTimeseriesData(h):[],allData:a,originalData:h,totals:r,isMetricsData:n,originalPreviousData:g,previousData:i?this.transformPreviousPeriodData(h,g,(s?(0,u.TE)(s):void 0)??c?.[t]):null,timeAggregatedData:l?this.transformAggregatedTimeseries(h,d||""):{},timeframe:e.start&&e.end?g?{start:500*(e.start+e.end),end:1e3*e.end}:{start:1e3*e.start,end:1e3*e.end}:void 0}}render(){const{children:e,showLoading:t,...s}=this.props,{topEvents:a,yAxis:n}=this.props,{timeseriesData:r,reloading:o,errored:i,errorMessage:l}=this.state,d=this.props.loading||null===r;if(t&&d)return(0,v.tZ)(c.Z,{"data-test-id":"events-request-loading"});if((0,u.Xe)(r,(0,h.ri)(a))){let t;const a={},n=Object.keys(r).map(((e,s)=>{const n=r[e],o=this.processData(n,s,(0,x.bQ)(e));return t||(t=o.timeframe),o.isMetricsData&&(a[e]={isMetricsData:o.isMetricsData}),[n.order||0,o.data[0],o.previousData,{isMetricsData:o.isMetricsData}]})).sort(((e,t)=>e[0]-t[0])),p={};Object.keys(r).forEach((e=>{const t=r[e].meta?.fields[(0,x.LY)(e)];t&&(p[e]=t)}));const c=n.map((e=>e[1])),u=n.some((e=>null===e[2]))?void 0:n.map((e=>e[2]));return e({loading:d,reloading:o,errored:i,errorMessage:l,results:c,timeframe:t,previousTimeseriesData:u,seriesAdditionalInfo:a,timeseriesResultsTypes:p,...s})}if(r){const t=n&&("string"==typeof n?n:n[0]),a=t&&r.meta?.fields[(0,x.LY)(t)],p=a?{[t]:a}:void 0,{data:c,comparisonData:u,allData:m,originalData:h,totals:g,originalPreviousData:v,previousData:y,timeAggregatedData:Z,timeframe:f,isMetricsData:b}=this.processData(r);return e({loading:d,reloading:o,errored:i,errorMessage:l,seriesAdditionalInfo:{[this.props.currentSeriesNames?.[0]??"current"]:{isMetricsData:b}},timeseriesData:c,comparisonTimeseriesData:u,allTimeseriesData:m,originalTimeseriesData:h,timeseriesTotals:g,originalPreviousTimeseriesData:v,previousTimeseriesData:y?[y]:y,timeAggregatedData:Z,timeframe:f,timeseriesResultsTypes:p,...s})}return e({loading:d,reloading:o,errored:i,errorMessage:l,...s})}}f.displayName="EventsRequest",(0,a.Z)(f,"defaultProps",{period:void 0,start:null,end:null,interval:"1d",comparisonDelta:void 0,limit:15,query:"",includePrevious:!0,includeTransformedData:!0});const b=f},"./app/components/charts/lineChart.tsx":(e,t,s)=>{s.d(t,{w:()=>o});var a=s("./app/components/charts/series/lineSeries.tsx"),n=s("./app/components/charts/baseChart.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){let{series:t,seriesOptions:s,...o}=e;return(0,r.tZ)(n.Z,{...o,series:t.map((e=>{let{seriesName:t,data:n,dataArray:r,...o}=e;return(0,a.Z)({...s,...o,name:t,data:r||n?.map((e=>{let{value:t,name:s}=e;return[s,t]})),animation:!1,animationThreshold:1,animationDuration:0})}))})}o.displayName="LineChart"},"./app/components/charts/loadingPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("./app/components/loadingMask.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o=(0,a.Z)((e=>{let{height:t,...s}=e;return(0,r.tZ)("div",{...s,children:(0,r.tZ)(n.Z,{})})}),{target:"e16jayu70"})("flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height),";position:relative;border-color:transparent;margin-bottom:0;");o.defaultProps={height:"200px"};const i=o},"./app/components/charts/optionSelector.tsx":(e,t,s)=>{s.d(t,{Z:()=>u});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),r=s("./app/components/compactSelect.tsx"),o=s("./app/components/featureBadge.tsx"),i=s("./app/components/truncate.tsx"),l=s("./app/utils.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{options:t,onChange:s,selected:a,title:o,featureType:p,multiple:u,...m}=e;const h=(0,n.useMemo)((()=>t.map((e=>({...e,label:(0,d.tZ)(i.Z,{value:String(e.label),maxLength:60,expandDirection:"left"})})))),[t]);return(0,d.tZ)(r.Z,{size:"sm",options:h,value:a,onChange:e=>{s(u?e.map((e=>e.value)):e.value)},isOptionDisabled:function(e){return e.disabled||u&&3===a.length&&!a.includes(e.value)},multiple:u,triggerProps:{borderless:!0,prefix:(0,d.BX)(n.Fragment,{children:[o,(0,l.ri)(p)?(0,d.tZ)(c,{type:p}):null]})},position:"bottom-end",...m})}p.displayName="OptionSelector";const c=(0,a.Z)(o.Z,{target:"e56rtee0"})({name:"6og82r",styles:"margin-left:0px"}),u=p},"./app/components/charts/transitionChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/react/index.js"),r=s("./app/components/charts/loadingPanel.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends n.Component{constructor(){super(...arguments),(0,a.Z)(this,"state",{prevReloading:this.props.reloading,prevLoading:this.props.loading,key:1})}static getDerivedStateFromProps(e,t){const s=t.prevReloading,a=e.reloading,n=t.prevLoading,r=e.loading;return n!==r?{prevReloading:a,prevLoading:r,key:t.key+1}:r?{prevReloading:a,prevLoading:r,key:t.key}:s&&!a?{prevReloading:a,prevLoading:r,key:t.key+1}:{prevReloading:a,prevLoading:r,key:t.key}}render(){const{height:e,loading:t,reloading:s}=this.props;return t&&!s?(0,o.tZ)(r.Z,{height:e,"data-test-id":"events-request-loading"}):(0,o.tZ)(n.Fragment,{children:this.props.children},String(this.state.key))}}i.displayName="TransitionChart",(0,a.Z)(i,"defaultProps",{height:"200px"});const l=i},"./app/components/charts/transparentLoadingMask.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("./app/components/loadingMask.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o=(0,a.Z)((e=>{let{className:t,visible:s,children:a,...o}=e;const i=s?{...o,"data-test-id":"loading-placeholder"}:o;return(0,r.tZ)(n.Z,{className:t,...i,children:a})}),{target:"e1t3xibm0"})((e=>!e.visible&&"display: none;"),";opacity:0.4;z-index:1;")},"./app/components/events/searchBar.tsx":(e,t,s)=>{s.d(t,{Z:()=>z}),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/core-js/modules/es.array.includes.js");var a=s("../node_modules/react/index.js"),n=s("../node_modules/@sentry/core/esm/exports.js"),r=s("../node_modules/lodash/assign.js"),o=s.n(r),i=s("../node_modules/lodash/flatten.js"),l=s.n(i),d=s("../node_modules/lodash/memoize.js"),p=s.n(d),c=s("../node_modules/lodash/omit.js"),u=s.n(c),m=s("./app/actionCreators/tags.tsx"),h=s("./app/components/smartSearchBar/index.tsx"),g=s("./app/constants/index.tsx"),x=s("./app/types/index.tsx"),v=s("./app/utils.tsx"),y=s("./app/utils/discover/fields.tsx"),Z=s("./app/utils/fields/index.ts"),f=s("./app/utils/measurements/measurements.tsx"),b=s("./app/utils/useApi.tsx"),S=s("./app/utils/withTags.tsx"),j=s("./app/views/dashboardsV2/utils.tsx"),w=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const D=new RegExp(`^${g.c$}|\\${g.ir}`,"g"),_=new Set(Object.keys(y.wZ)),T=Object.keys(y.wZ).reduce(((e,t)=>(e[t]={...y.wZ[t],kind:Z.IV.FIELD},e)),{}),C=u()(T,y.J8),k=y.$4.reduce(((e,t)=>(e[t]={name:t,kind:Z.IV.METRICS},e)),{}),P=Object.keys(y.jg).reduce(((e,t)=>(e[t]={...y.jg[t],kind:Z.IV.FIELD},e)),{});function E(e){const{maxSearchItems:t,organization:s,tags:r,omitTags:i,fields:d,projectIds:c,includeSessionTagsValues:g,maxMenuHeight:S,customMeasurements:E}=e,z=(0,b.Z)(),A=(0,a.useRef)(!1),q=(0,a.useMemo)((()=>(e=>e?.length?e.reduce(((e,t)=>(_.has(t.field)||(0,y.GO)(t.field)||(0,j.nk)(t.field)||(e[t.field]={key:t.field,name:t.field,kind:Z.IV.FUNCTION}),e)),{}):[])(d)),[d]),N=(0,a.useMemo)((()=>Object.keys(r).reduce(((e,t)=>(e[t]={...r[t],kind:Z.IV.TAG},e)),{})),[r]);(0,a.useEffect)((()=>{R.cache.clear?.()}),[c]);const R=p()(((e,t,a)=>{const n=c?.map(String);return(0,y.h1)(e.key)||(0,y.Xr)(e.key)?Promise.resolve([]):(0,m.Fo)({api:z,orgSlug:s.slug,tagKey:e.key,search:t,projectIds:n,endpointParams:a,includeTransactions:!0,includeSessions:g}).then((e=>l()(e.filter((e=>{let{name:t}=e;return(0,v.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:s}=e;return`${s}-${t}`})),I=e=>{let t;!A.current&&Object.keys(r).length>0&&(t=n.Yr({name:"SearchBar.getTagList"}),A.current=!0);const a=((e,t)=>{const s=Object.keys(e).reduce(((t,s)=>(t[s]={...e[s],kind:Z.IV.MEASUREMENT},t)),{});return t?Object.keys(t).reduce(((e,s)=>(e[s]={...t[s],kind:Z.IV.MEASUREMENT},e)),s):s})(e,E),l=s.features.includes("performance-view")?Object.assign({},a,q,k,T):Object.assign({},C);o()(l,N,T,P),l.has={key:Z.Sh.HAS,name:"Has property",values:Object.keys(l).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),predefined:!0,kind:Z.IV.FIELD};const d=i&&i.length>0?u()(l,i):l;if(t){const e=Object.keys(d).length;t.setTag("tags.totalCount",e);const s=[1,5,10,20,50,100,200,300,400,500,600,700,800,900,1e3,1e4].find((t=>e<=t));t.setTag("tags.totalCount.grouped",`<=${s}`),t.finish()}return d};return(0,w.tZ)(f.Z,{children:s=>{let{measurements:a}=s;return(0,w.tZ)(h.Z,{hasRecentSearches:!0,savedSearchType:x.L4.EVENT,onGetTagValues:R,supportedTags:I(a),prepareQuery:e=>e.replace(D,""),maxSearchItems:t,excludedTags:[Z.Sh.ENVIRONMENT,Z.Sh.TOTAL_COUNT],maxMenuHeight:S??300,customPerformanceMetrics:E,...e})}})}E.displayName="SearchBar";const z=(0,S.Z)(E)},"./app/components/gridEditable/sortLink.tsx":(e,t,s)=>{s.d(t,{Z:()=>h});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("../node_modules/react-router/es/index.js"),r=s("../node_modules/lodash/omit.js"),o=s.n(r),i=s("./app/components/links/link.tsx"),l=s("./app/icons/index.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{align:t,title:s,canSort:a,generateSortLink:r,onClick:o,direction:i,replace:l}=e;const p=r();if(!p||!a)return(0,d.tZ)(u,{align:t,children:s});const h=i?(0,d.tZ)(m,{size:"xs",direction:"desc"===i?"down":"up"}):null;return(0,d.BX)(c,{align:t,to:p,onClick:e=>{l&&(e.preventDefault(),n.browserHistory.replace(p)),o?.(e)},children:[s," ",h]})}p.displayName="SortLink";const c=(0,a.Z)((e=>{const t=o()(e,["align","css"]);return(0,d.tZ)(i.Z,{...t})}),{target:"esdhr0u2"})("display:block;width:100%;white-space:nowrap;color:inherit;&:hover,&:active,&:focus,&:visited{color:inherit;}",(e=>e.align?`text-align: ${e.align};`:""),";"),u=(0,a.Z)("div",{target:"esdhr0u1"})("display:block;width:100%;white-space:nowrap;",(e=>e.align?`text-align: ${e.align};`:""),";"),m=(0,a.Z)(l.CC,{target:"esdhr0u0"})({name:"40f4ru",styles:"vertical-align:top"}),h=p},"./app/components/loadingMask.tsx":(e,t,s)=>{s.d(t,{Z:()=>a});const a=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e9w1nku0"})("background-color:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";position:absolute;top:0;bottom:0;left:0;right:0;")},"./app/components/performanceDuration.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var a=s("./app/components/duration.tsx"),n=s("./app/utils.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){const t=function(e){return(0,n.ri)(e.nanoseconds)}(e)?e.nanoseconds/1e9:function(e){return(0,n.ri)(e.milliseconds)}(e)?e.milliseconds/1e3:e.seconds;return(0,r.tZ)(a.Z,{abbreviation:e.abbreviation,seconds:t,fixedDigits:2})}o.displayName="PerformanceDuration";const i=o},"./app/utils/discover/discoverQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>l,_:()=>i});var a=s("./app/utils/discover/genericDiscoverQuery.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function o(e){return(0,n.tZ)(a.ZP,{route:"events",shouldRefetchData:r,afterFetch:(e,t)=>{const{fields:s,...a}=e.meta??{};return{...e,meta:{...s,...a}}},...e})}function i(e){return(0,a.JC)({route:"events",shouldRefetchData:r,afterFetch:(e,t)=>{const{fields:s,...a}=e.meta??{};return{...e,meta:{...s,...a}}},...e})}o.displayName="DiscoverQuery";const l=o},"./app/utils/getPeriod.tsx":(e,t,s)=>{s.d(t,{X:()=>i}),s("../node_modules/core-js/modules/es.error.cause.js");var a=s("../node_modules/moment/moment.js"),n=s.n(a),r=s("./app/constants/index.tsx"),o=s("./app/utils/dates.tsx");function i(e){let{period:t,start:s,end:a}=e,{shouldDoublePeriod:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t||s||a||(t=r.GY),t){if(!i)return{statsPeriod:t};const[,e,s]=t.match(/([0-9]+)([mhdw])/);return{statsPeriod:`${2*parseInt(e,10)}${s}`}}if(!s||!a)throw new Error("start and end required");const l=(0,o.v5)(s),d=(0,o.v5)(a);if(i){const e=n()(a).diff(n()(s)),t=n()(s).subtract(e);return{start:(0,o.v5)(t),end:d}}return{start:l,end:d}}},"./app/utils/performance/histogram/constants.tsx":(e,t,s)=>{s.d(t,{d:()=>n});var a=s("./app/locale.tsx");const n=[{label:(0,a.t)("Exclude"),value:"exclude_outliers"},{label:(0,a.t)("Include"),value:"all"}]},"./app/utils/performance/histogram/index.tsx":(e,t,s)=>{s.d(t,{V:()=>d,Z:()=>p});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),r=s("../node_modules/react-router/es/index.js"),o=s("./app/utils/queryString.tsx"),i=s("./app/utils/performance/histogram/constants.tsx");class l extends n.Component{constructor(){super(...arguments),(0,a.Z)(this,"handleResetView",(()=>{const{location:e,zoomKeys:t}=this.props;r.browserHistory.push({pathname:e.pathname,query:d(e,t)})})),(0,a.Z)(this,"handleFilterChange",(e=>{const{location:t,zoomKeys:s}=this.props;r.browserHistory.push({pathname:t.pathname,query:{...d(t,s),dataFilter:e}})}))}isZoomed(){const{location:e,zoomKeys:t}=this.props;return t.map((t=>e.query[t])).some((e=>void 0!==e))}getActiveFilter(){const{location:e}=this.props,t=e.query.dataFilter?(0,o.ro)(e.query.dataFilter):i.d[0].value;return i.d.find((e=>e.value===t))||i.d[0]}render(){const e={isZoomed:this.isZoomed(),handleResetView:this.handleResetView,activeFilter:this.getActiveFilter(),handleFilterChange:this.handleFilterChange,filterOptions:i.d};return this.props.children(e)}}function d(e,t){const s={...e.query,cursor:void 0};return delete s.dataFilter,t.forEach((e=>delete s[e])),s}l.displayName="Histogram";const p=l},"./app/utils/performance/suspectSpans/suspectSpansQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>p});var a=s("../node_modules/lodash/omit.js"),n=s.n(a),r=s("./app/utils.tsx"),o=s("./app/utils/discover/genericDiscoverQuery.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){const{perSuspect:t,spanOps:s,spanGroups:a,minExclusiveTime:n,maxExclusiveTime:o}=e,i={perSuspect:t,spanOp:s,spanGroup:a,min_exclusive_time:n,max_exclusive_time:o};(0,r.ri)(i.perSuspect)||delete i.perSuspect,(0,r.ri)(i.spanOp)||delete i.spanOp,(0,r.ri)(i.spanGroup)||delete i.spanGroup;const l=e.eventView.getEventsAPIPayload(e.location);return{...i,...l}}function d(e){return(0,i.tZ)(o.ZP,{route:"events-spans-performance",getRequestPayload:l,...n()(e,"children"),children:t=>{let{tableData:s,...a}=t;return e.children({suspectSpans:s,...a})}})}d.displayName="SuspectSpansQuery";const p=d},"./app/utils/routeAnalytics/useRouteAnalyticsEventNames.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var a=s("../node_modules/react/index.js"),n=s("./app/views/routeAnalyticsContextProvider.tsx");function r(e,t){const{setEventNames:s,previousUrl:r}=(0,a.useContext)(n.o);(0,a.useEffect)((()=>{s(e,t)}),[s,e,t,r])}},"./app/utils/withTags.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/react/index.js"),r=s("./app/stores/tagStore.tsx"),o=s("./app/utils/getDisplayName.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends n.Component{constructor(){super(...arguments),(0,a.Z)(this,"state",{tags:r.Z.getState()}),(0,a.Z)(this,"unsubscribe",r.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...s}=this.props;return(0,i.tZ)(e,{tags:t??this.state.tags,...s})}}return t.displayName="WithTags",(0,a.Z)(t,"displayName",`withTags(${(0,o.Z)(e)})`),t}},"./app/views/performance/transactionSummary/transactionSpans/spanDetails/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>rt});var a=s("./app/components/acl/feature.tsx"),n=s("./app/components/layouts/thirds.tsx"),r=s("./app/components/noProjectMessage.tsx"),o=s("./app/components/organizations/pageFilters/container.tsx"),i=s("./app/components/sentryDocumentTitle.tsx"),l=s("./app/locale.tsx"),d=s("./app/utils.tsx"),p=s("./app/utils/queryString.tsx"),c=s("./app/utils/useOrganization.tsx"),u=s("./app/utils/useProjects.tsx"),m=s("./app/views/performance/utils.tsx"),h=s("./app/views/performance/transactionSummary/pageLayout.tsx"),g=s("./app/views/performance/transactionSummary/transactionSpans/utils.tsx"),x=s("../node_modules/react/index.js"),v=s("../node_modules/@sentry/core/esm/exports.js"),y=s("./app/components/idBadge/index.tsx"),Z=s("./app/utils/discover/discoverQuery.tsx"),f=s("../node_modules/lodash/omit.js"),b=s.n(f),S=s("./app/utils/discover/genericDiscoverQuery.tsx"),j=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function w(e){const{spanOp:t,spanGroup:s,minExclusiveTime:a,maxExclusiveTime:n}=e,r=(0,d.ri)(t)&&(0,d.ri)(s)?`${t}:${s}`:void 0;return{...(0,d.ri)(r)?{span:r,min_exclusive_time:a,max_exclusive_time:n}:{},...b()(e.eventView.getEventsAPIPayload(e.location),["field"])}}function D(e){return(0,j.tZ)(S.ZP,{route:"events-spans",getRequestPayload:w,...b()(e,"children"),children:t=>{let{tableData:s,...a}=t;return e.children({examples:s??null,...a})}})}D.displayName="SuspectSpansQuery";const _=D;var T=s("./app/utils/performance/suspectSpans/suspectSpansQuery.tsx"),C=s("./app/utils/routeAnalytics/useRouteAnalyticsEventNames.tsx"),k=s("./app/utils/routeAnalytics/useRouteAnalyticsParams.tsx"),P=s("./app/views/performance/breadcrumb.tsx"),E=s("./app/views/performance/transactionSummary/tabs.tsx"),z=s("./app/views/performance/transactionSummary/transactionSpans/types.tsx"),A=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react-router/es/index.js")),q=s("./app/components/charts/optionSelector.tsx"),N=s("./app/components/charts/styles.tsx"),R=s("./app/components/count.tsx"),I=s("./app/components/panels/index.tsx"),L=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),M=s("./app/utils/useLocation.tsx"),O=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),B=s("./app/components/charts/barChart.tsx"),F=s("./app/components/charts/barChartZoom.tsx"),V=s("./app/components/charts/errorPanel.tsx"),X=s("./app/components/charts/transitionChart.tsx"),$=s("./app/components/charts/transparentLoadingMask.tsx"),H=s("./app/components/performance/waterfall/utils.tsx"),G=s("./app/components/placeholder.tsx"),W=s("./app/components/questionTooltip.tsx"),Q=s("./app/icons/index.tsx"),U=s("./app/utils/discover/charts.tsx"),J=s("./app/utils/discover/fields.tsx"),Y=s("./app/utils/getDynamicText.tsx");function K(e){const{span:t,numBuckets:s,min:a,max:n,precision:r,dataFilter:o,eventView:i,location:l}=e;return{span:`${t.op}:${t.group}`,numBuckets:s,min:a,max:n,precision:r,dataFilter:o,...b()(i.getEventsAPIPayload(l),["sort","per_page","cursor"])}}function ee(e){return(0,j.tZ)(S.ZP,{route:"events-spans-histogram",getRequestPayload:K,...b()(e,"children"),children:t=>{let{tableData:s,...a}=t;return e.children({histogram:s,...a})}})}ee.displayName="SpanHistogramQuery";const te=ee;var se=s("./app/utils/performance/histogram/utils.tsx"),ae=s("./app/views/performance/transactionSummary/transactionSpans/spanDetails/utils.tsx");function ne(e){const{organization:t,eventView:s,spanSlug:a}=e,n=(0,M.T)(),r=(0,p.ro)(n.query[ae.wL.MIN]),o=(0,p.ro)(n.query[ae.wL.MAX]);return(0,j.BX)(x.Fragment,{children:[(0,j.BX)(N.ws,{children:[(0,l.t)("Self Time Distribution"),(0,j.tZ)(W.Z,{size:"sm",position:"top",title:(0,l.t)("Distribution buckets counts of the same self time duration for the selected span op and group.")})]}),(0,j.tZ)(te,{location:n,orgSlug:t.slug,eventView:s,numBuckets:50,precision:0,span:a,dataFilter:"exclude_outliers",min:r,max:o,children:e=>{let{histogram:t,isLoading:s,error:r}=e;return r?(0,j.tZ)(V.Z,{"data-test-id":"histogram-error-panel",children:(0,j.tZ)(Q.FC,{color:"gray300",size:"lg"})}):(0,j.BX)(X.Z,{loading:s,reloading:s,children:[(0,j.tZ)($.Z,{visible:s}),(0,j.tZ)(F.Z,{minZoomWidth:1,location:n,paramStart:ae.wL.MIN,paramEnd:ae.wL.MAX,xAxisIndex:[0],buckets:t?(0,se._W)(t):[],children:e=>(0,j.tZ)(re,{zoomProps:{...e},isLoading:s,isErrored:!!r,chartData:t,spanSlug:a})})]})}})]})}function re(e){const t=(0,O.u)(),{chartData:s,zoomProps:a,spanSlug:n}=e;if(!s)return(0,j.tZ)(G.Z,{height:"200px"});const r={grid:{left:"10px",right:"10px",top:"40px",bottom:"0px"},colors:()=>(0,H.hd)(n.op),seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",valueFormatter:(e,t)=>(0,U.CX)(e,(0,J.Px)(t))},yAxis:{type:"value",axisLabel:{color:t.chartLabel,formatter:e=>(0,U.gu)(e,"number")}},xAxis:{type:"category",truncate:!0,axisTick:{alignWithLabel:!0}},height:200},o={seriesName:(0,l.t)("Count"),data:(0,se.GT)(s,{type:"duration"})};return(0,j.tZ)(x.Fragment,{children:(0,Y.Z)({value:(0,j.tZ)(B.v,{...a,...r,series:[o],stacked:!0}),fixed:(0,j.tZ)(G.Z,{height:"200px"})})})}ne.displayName="ExclusiveTimeHistogram",re.displayName="Chart";var oe,ie=s("./app/components/charts/chartZoom.tsx"),le=s("./app/components/charts/eventsRequest.tsx"),de=s("./app/components/charts/lineChart.tsx"),pe=s("./app/components/charts/utils.tsx"),ce=s("./app/components/organizations/pageFilters/parse.tsx"),ue=s("./app/utils/dates.tsx"),me=s("./app/utils/useApi.tsx"),he=s("./app/utils/useRouter.tsx");function ge(e){const t=(0,M.T)(),s=(0,he.Z)(),{organization:a,eventView:n,spanSlug:r,withoutZerofill:o}=e,i=(0,me.Z)(),d=(0,O.u)(),p=n.statsPeriod,c=n.start?(0,ue.hC)(n.start):null,u=n.end?(0,ue.hC)(n.end):null,{utc:m}=(0,ce.fK)(t.query),h={start:c,end:u,period:p},v=["percentileArray(spans_exclusive_time, 0.50)","percentileArray(spans_exclusive_time, 0.75)","percentileArray(spans_exclusive_time, 0.95)","percentileArray(spans_exclusive_time, 0.99)"],y=e=>{const{selected:s}=e,a=Object.keys(s).filter((e=>!s[e])),n={...t,query:{...t.query,unselectedSeries:a}};A.browserHistory.push(n)};return(0,j.BX)(x.Fragment,{children:[(0,j.BX)(N.ws,{children:[(0,l.t)("Self Time Breakdown"),(0,j.tZ)(W.Z,{size:"sm",position:"top",title:(0,l.t)("Self Time Breakdown reflects the span self time by percentile over time.")})]}),(0,j.tZ)(ie.Z,{router:s,period:p,start:c,end:u,utc:"true"===m,children:e=>(0,j.tZ)(le.Z,{api:i,organization:a,project:n.project,environment:n.environment,start:c,end:u,period:p,interval:(0,pe.ZS)(h,"high"),showLoading:!1,query:n.query,includePrevious:!1,yAxis:v,partial:!0,withoutZerofill:o,queryExtras:{span:`${r.op}:${r.group}`},generatePathname:e=>`/organizations/${e.slug}/events-spans-stats/`,children:s=>{let{results:a,errored:n,loading:r,reloading:o,timeframe:i}=s;if(n)return(0,j.tZ)(V.Z,{children:(0,j.tZ)(Q.FC,{color:"gray300",size:"lg"})});const l={grid:{left:"10px",right:"10px",top:"40px",bottom:"0px"},colors:d.charts.getColorPalette(v.length-2),seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",valueFormatter:(e,t)=>(0,U.CX)(e,"duration")},xAxis:i?{min:i.start,max:i.end}:void 0,yAxis:{axisLabel:{color:d.chartLabel,formatter:e=>(0,U.gu)(e,"duration")}}},p={right:10,top:5,selected:(0,pe.RI)(t)},c=a?.map((e=>({...e,seriesName:(0,g.mV)(e.seriesName)})));return(0,j.BX)(X.Z,{loading:r,reloading:o,children:[(0,j.tZ)($.Z,{visible:o}),(0,Y.Z)({value:(0,j.tZ)(de.w,{...e,...l,legend:p,onLegendSelectChanged:y,series:c??[]}),fixed:(0,j.tZ)(G.Z,{height:"200px"})})]})}})})]})}function xe(e){const t=(0,M.T)(),s=(0,p.ro)(t.query.display,oe.TIMESERIES);return(0,j.BX)(I.s_,{children:[(0,j.tZ)(N.BO,{children:(0,j.tZ)(a.Z,{features:["performance-span-histogram-view"],children:t=>{let{hasFeature:a}=t;return a?s===oe.TIMESERIES?(0,j.tZ)(ge,{...e,withoutZerofill:!1}):(0,j.tZ)(ne,{...e}):(0,j.tZ)(ge,{...e,withoutZerofill:!1})}})}),(0,j.tZ)(a.Z,{features:["performance-span-histogram-view"],children:(0,j.BX)(N.xx,{children:[(0,j.BX)(N.m2,{children:[(0,j.tZ)(N.OT,{children:(0,l.t)("Total Events")}),(0,j.tZ)(N.uN,{"data-test-id":"total-value",children:(0,d.ri)(e.totalCount)?(0,j.tZ)(R.Z,{value:e.totalCount}):"—"})]}),(0,j.tZ)(N.m2,{"data-test-id":"display-toggle",children:(0,j.tZ)(q.Z,{title:(0,l.t)("Display"),selected:s,options:[{value:oe.TIMESERIES,label:(0,l.t)("Self Time Breakdown")},{value:oe.HISTOGRAM,label:(0,l.t)("Self Time Distribution")}],onChange:function(s){(0,L.Z)("performance_views.span_summary.change_chart",{organization:e.organization,change_to_display:s}),A.browserHistory.push({pathname:t.pathname,query:{...t.query,display:s}})}})})]})})]})}ge.displayName="ExclusiveTimeTimeSeries",function(e){e.TIMESERIES="timeseries",e.HISTOGRAM="histogram"}(oe||(oe={})),xe.displayName="Chart";const ve=xe;var ye=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),Ze=s("./app/components/button.tsx"),fe=s("./app/components/datePageFilter.tsx"),be=s("./app/components/environmentPageFilter.tsx"),Se=s("./app/components/events/searchBar.tsx"),je=s("./app/components/organizations/pageFilterBar.tsx"),we=s("./app/styles/space.tsx"),De=s("./app/utils/performance/histogram/index.tsx");function _e(e){let{organization:t,eventView:s,location:a}=e;const n=(0,p.ro)(a.query.query,"");return(0,j.BX)(Te,{children:[(0,j.BX)(je.Z,{condensed:!0,children:[(0,j.tZ)(be.Z,{}),(0,j.tZ)(fe.Z,{alignDropdown:"left",relativeOptions:g.CS,maxPickableDays:g.bc})]}),(0,j.tZ)(Se.Z,{placeholder:(0,l.t)("Filter Transactions"),organization:t,projectIds:s.project,query:n,fields:s.fields,onSearch:e=>{A.browserHistory.push({pathname:a.pathname,query:{...a.query,cursor:void 0,query:String(e).trim()||void 0}})}}),(0,j.tZ)(Ze.zx,{onClick:()=>{A.browserHistory.push({pathname:a.pathname,query:(0,De.V)(a,Object.values(ae.wL))})},disabled:!Object.values(ae.wL).some((e=>a.query[e])),children:(0,l.t)("Reset View")})]})}_e.displayName="SpanDetailsControls";const Te=(0,ye.Z)("div",{target:"e1f3ccvz0"})("display:grid;gap:",(0,we.Z)(2),";margin-bottom:",(0,we.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:auto 1fr auto;}");var Ce=s("./app/components/performanceDuration.tsx"),ke=s("./app/utils/formatters.tsx");function Pe(e){const{spanSlug:t,suspectSpan:s,totalCount:a}=e,{description:n,frequency:r,avgOccurrences:o,p50ExclusiveTime:i,p75ExclusiveTime:p,p95ExclusiveTime:c,p99ExclusiveTime:u,sumExclusiveTime:m}=s??{};return(0,j.BX)(Ee,{children:[(0,j.BX)(ze,{"data-test-id":"header-operation-name",children:[(0,j.tZ)(Ae,{children:(0,l.t)("Span Operation")}),(0,j.tZ)(qe,{children:(0,j.tZ)(Ie,{children:n??Me})}),(0,j.tZ)(Ne,{"data-test-id":"operation-name",children:t.op})]}),(0,j.BX)(ze,{"data-test-id":"header-percentiles",children:[(0,j.tZ)(Ae,{children:(0,l.t)("Self Time Percentiles")}),(0,j.BX)(Re,{children:[(0,j.BX)("div",{"data-test-id":"section-p50",children:[(0,j.tZ)(qe,{children:(0,d.ri)(i)?(0,j.tZ)(Ce.Z,{abbreviation:!0,milliseconds:i}):"—"}),(0,j.tZ)(Ne,{children:(0,l.t)("p50")})]}),(0,j.BX)("div",{"data-test-id":"section-p75",children:[(0,j.tZ)(qe,{children:(0,d.ri)(p)?(0,j.tZ)(Ce.Z,{abbreviation:!0,milliseconds:p}):"—"}),(0,j.tZ)(Ne,{children:(0,l.t)("p75")})]}),(0,j.BX)("div",{"data-test-id":"section-p95",children:[(0,j.tZ)(qe,{children:(0,d.ri)(c)?(0,j.tZ)(Ce.Z,{abbreviation:!0,milliseconds:c}):"—"}),(0,j.tZ)(Ne,{children:(0,l.t)("p95")})]}),(0,j.BX)("div",{"data-test-id":"section-p99",children:[(0,j.tZ)(qe,{children:(0,d.ri)(u)?(0,j.tZ)(Ce.Z,{abbreviation:!0,milliseconds:u}):"—"}),(0,j.tZ)(Ne,{children:(0,l.t)("p99")})]})]})]}),(0,j.BX)(ze,{"data-test-id":"header-frequency",children:[(0,j.tZ)(Ae,{children:(0,l.t)("Frequency")}),(0,j.tZ)(qe,{children:(0,d.ri)(r)&&(0,d.ri)(a)?(0,ke.rl)(Math.min(r,a)/a):"—"}),(0,j.tZ)(Ne,{children:(0,d.ri)(o)?(0,l._N)("[times] times per event",{times:o.toFixed(2)}):"—"})]}),(0,j.BX)(ze,{"data-test-id":"header-total-exclusive-time",children:[(0,j.tZ)(Ae,{children:(0,l.t)("Total Self Time")}),(0,j.tZ)(qe,{children:(0,d.ri)(m)?(0,j.tZ)(Ce.Z,{abbreviation:!0,milliseconds:m}):"—"}),(0,j.tZ)(Ne,{children:(0,d.ri)(r)?(0,l._N)("[events] events",{events:(0,j.tZ)(R.Z,{value:r})}):"—"})]})]})}Pe.displayName="SpanDetailsHeader";const Ee=(0,ye.Z)("div",{target:"e14vyzsa7"})("display:grid;grid-template-columns:1fr;gap:",(0,we.Z)(4),";margin-bottom:",(0,we.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints.medium),"){grid-template-columns:1fr repeat(3, max-content);}"),ze=(0,ye.Z)("div",{target:"e14vyzsa6"})((e=>e.theme.overflowEllipsis),";height:78px;"),Ae=(0,ye.Z)(N.OT,{target:"e14vyzsa5"})({name:"ti75j2",styles:"margin:0"}),qe=(0,ye.Z)("div",{target:"e14vyzsa4"})("font-size:",(e=>e.theme.fontSizeExtraLarge),";padding:",(0,we.Z)(.5)," 0;max-height:32px;"),Ne=(0,ye.Z)("div",{target:"e14vyzsa3"})("color:",(e=>e.theme.subText),";font-size:",(e=>e.theme.fontSizeMedium),";"),Re=(0,ye.Z)("div",{target:"e14vyzsa2"})("display:grid;grid-template-columns:repeat(4, max-content);gap:",(0,we.Z)(3),";"),Ie=(0,ye.Z)("div",{target:"e14vyzsa1"})((e=>e.theme.overflowEllipsis),";"),Le=(0,ye.Z)("span",{target:"e14vyzsa0"})("color:",(e=>e.theme.gray300),";"),Me=(0,j.tZ)(Le,{children:(0,l.t)("(unnamed span)")});var Oe=s("./app/components/gridEditable/index.tsx"),Be=s("./app/components/gridEditable/sortLink.tsx"),Fe=s("./app/components/links/link.tsx"),Ve=s("./app/components/pagination.tsx"),Xe=s("./app/components/performance/waterfall/rowBar.tsx"),$e=s("./app/components/tooltip.tsx"),He=s("./app/utils/discover/fieldRenderers.tsx"),Ge=s("./app/views/performance/transactionSummary/utils.tsx");function We(e){const{location:t,organization:s,project:a,examples:n,suspectSpan:r,transactionName:o,isLoading:i,pageLinks:l}=e;if(!(0,d.ri)(n))return null;const p=n.filter((e=>e.spans.length>0)).map((e=>({id:e.id,project:a?.slug,timestamp:1e3*e.finishTimestamp,transactionDuration:1e3*(e.finishTimestamp-e.startTimestamp),spanDuration:e.nonOverlappingExclusiveTime,occurrences:e.spans.length,cumulativeDuration:e.spans.reduce(((e,t)=>e+t.exclusiveTime),0),spans:e.spans})));return(0,j.BX)(x.Fragment,{children:[(0,j.tZ)(Oe.ZP,{isLoading:i,data:p,columnOrder:Ye,columnSortBy:[],grid:{renderHeadCell:Qe,renderBodyCell:Ue(t,s,o,r)},location:t}),(0,j.tZ)(Ve.Z,{pageLinks:l??null})]})}function Qe(e,t){const s=(0,J.qG)(e.key,Je[e.key]);return(0,j.tZ)(Be.Z,{title:e.name,align:s,direction:void 0,canSort:!1,generateSortLink:()=>{}})}function Ue(e,t,s,a){return(n,r)=>{if("spanDuration"===n.key&&r.transactionDuration)return(0,j.tZ)(tt,{spanOp:a?.op??"",spanDuration:r.spanDuration,transactionDuration:r.transactionDuration});let o=(0,He.Js)(n.key,Je)(r,{location:e,organization:t});if("id"===n.key){const a=r.spans.length?r.spans.reduce(((e,t)=>e.exclusiveTime>=t.exclusiveTime?e:t)):null,n=(0,Ge.vd)(s)(t,r,e.query,a.id);o=(0,j.tZ)(Fe.Z,{to:n,children:o})}return o}}We.displayName="SpanTable",Qe.displayName="renderHeadCell";const Je={id:"string",timestamp:"date",spanDuration:"duration",occurrences:"integer",cumulativeDuration:"duration"},Ye=[{key:"id",name:(0,l.t)("Event ID"),width:Oe.z7},{key:"timestamp",name:(0,l.t)("Timestamp"),width:Oe.z7},{key:"spanDuration",name:(0,l.t)("Span Duration"),width:Oe.z7},{key:"occurrences",name:(0,l.t)("Count"),width:Oe.z7},{key:"cumulativeDuration",name:(0,l.t)("Cumulative Duration"),width:Oe.z7}],Ke=(0,ye.Z)("div",{target:"e1y3mgni1"})("position:relative;display:flex;top:",(0,we.Z)(.5),";background-color:",(e=>e.theme.gray100),";"),et=(0,ye.Z)(Xe.e,{target:"e1y3mgni0"})({name:"1ics03r",styles:"position:relative;width:100%;top:0"});function tt(e){const{spanOp:t,spanDuration:s,transactionDuration:a}=e,n=s/a,r=n<.7?"right":"inset";return(0,j.tZ)(Ke,{children:(0,j.tZ)("div",{style:{width:(0,H.yI)(n)},children:(0,j.tZ)($e.ZP,{title:(0,l._N)("[percentage] of the transaction",{percentage:(0,ke.rl)(n)}),containerDisplayMode:"block",children:(0,j.tZ)(et,{style:{backgroundColor:(0,H.hd)(t)},children:(0,j.tZ)(Xe.R,{durationDisplay:r,showDetail:!1,children:(0,j.tZ)(Ce.Z,{abbreviation:!0,milliseconds:s})})})})})})}function st(e){const{location:t,organization:s,eventView:a,project:r,transactionName:o,spanSlug:i}=e,l=(0,p.ro)(t.query[ae.wL.MIN]),d=(0,p.ro)(t.query[ae.wL.MAX]);return(0,C.Z)("performance_views.span_summary.view","Performance Views: Span Summary page viewed"),(0,k.Z)({project_platforms:r?(0,m.p9)(t,[r]):""}),(0,j.BX)(x.Fragment,{children:[(0,j.tZ)(n.h4,{children:(0,j.BX)(n.oB,{children:[(0,j.tZ)(P.Z,{organization:s,location:t,transaction:{project:r?.id??"",name:o},tab:E.Z.Spans,spanSlug:i}),(0,j.BX)(n.Dx,{children:[r&&(0,j.tZ)(y.Z,{project:r,avatarSize:28,hideName:!0,avatarProps:{hasTooltip:!0,tooltip:r.slug}}),o]})]})}),(0,j.tZ)(n.uT,{children:(0,j.tZ)(n.or,{fullWidth:!0,children:(0,j.tZ)(Z.Z,{eventView:(0,g.zW)(a),orgSlug:s.slug,location:t,referrer:"api.performance.transaction-spans",cursor:"0:0:1",noPagination:!0,children:e=>{let{tableData:n}=e;const p=n?.data?.[0]?.["count()"]??null;if(p){(0,v.YA)("spans.totalCount",p);const e=[1,5,10,20,50,100,200,300,400,500,600,700,800,900,1e3].find((e=>p<=e));(0,v.YA)("spans.totalCount.grouped",`<=${e}`)}return(0,j.tZ)(T.Z,{location:t,orgSlug:s.slug,eventView:nt(a),perSuspect:0,spanOps:[i.op],spanGroups:[i.group],cursor:"0:0:1",minExclusiveTime:l,maxExclusiveTime:d,children:e=>(0,j.tZ)(_,{location:t,orgSlug:s.slug,eventView:a,spanOp:i.op,spanGroup:i.group,limit:10,minExclusiveTime:l,maxExclusiveTime:d,children:n=>(0,j.tZ)(at,{location:t,organization:s,project:r,eventView:a,spanSlug:i,transactionName:o,totalCount:p,suspectSpansResults:e,spanExamplesResults:n})})})}})})})]})}function at(e){const{location:t,organization:s,project:n,eventView:r,spanSlug:o,transactionName:i,totalCount:l,suspectSpansResults:d,spanExamplesResults:p}=e,c=d.suspectSpans?.[0],u=p.examples?.[0]?.examples,m=c?.frequency;return(0,j.BX)(x.Fragment,{children:[(0,j.tZ)(a.Z,{features:["performance-span-histogram-view"],children:(0,j.tZ)(_e,{organization:s,location:t,eventView:r})}),(0,j.tZ)(Pe,{spanSlug:o,totalCount:l,suspectSpan:c}),(0,j.tZ)(ve,{totalCount:m,organization:s,eventView:r,spanSlug:o}),(0,j.tZ)(We,{location:t,organization:s,project:n,suspectSpan:c,transactionName:i,isLoading:p.isLoading,examples:u??[],pageLinks:p.pageLinks})]})}function nt(e){return(e=e.withSorts([{field:z.g.AVG_OCCURRENCE,kind:"desc"}])).fields=[{field:"count()"},{field:"count_unique(id)"},{field:"equation|count() / count_unique(id)"},{field:"sumArray(spans_exclusive_time)"},{field:"percentileArray(spans_exclusive_time, 0.50)"},{field:"percentileArray(spans_exclusive_time, 0.75)"},{field:"percentileArray(spans_exclusive_time, 0.95)"},{field:"percentileArray(spans_exclusive_time, 0.99)"}],e}function rt(e){const{location:t,params:s}=e,l=(0,m.JY)(t),x=(0,g.W6)(s.spanSlug),v=(0,c.Z)(),{projects:y}=(0,u.Z)(),Z=(0,p.ro)(t.query.project);if(!(0,d.ri)(Z)||!(0,d.ri)(l)||!(0,d.ri)(x))return(0,h.C1)(v,t),null;const f=y.find((e=>e.id===Z)),b=(0,g.xz)({location:t,transactionName:l});return(0,j.tZ)(i.Z,{title:ot(l),orgSlug:v.slug,projectSlug:f?.slug,children:(0,j.tZ)(a.Z,{features:["performance-view"],organization:v,renderDisabled:h.Ox,children:(0,j.tZ)(o.Z,{shouldForceProject:(0,d.ri)(f),forceProject:f,specificProjectSlugs:(0,d.ri)(f)?[f.slug]:[],children:(0,j.tZ)(n.T3,{children:(0,j.tZ)(r.Z,{organization:v,children:(0,j.tZ)(st,{location:t,organization:v,eventView:b,project:f,transactionName:l,spanSlug:x})})})})})})}function ot(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,l.t)("Performance")].join(" - "):[(0,l.t)("Summary"),(0,l.t)("Performance")].join(" - ")}tt.displayName="SpanDurationBar",st.displayName="SpanDetailsContentWrapper",at.displayName="SpanDetailsContent",rt.displayName="SpanDetails"},"./app/views/performance/transactionSummary/transactionSpans/spanDetails/utils.tsx":(e,t,s)=>{function a(e){let{orgSlug:t,transaction:s,query:a,spanSlug:n,projectID:r}=e;const o=function(e){let{orgSlug:t,spanSlug:s}=e;return`/organizations/${t}/performance/summary/spans/${encodeURIComponent(s.op)}:${s.group}/`}({orgSlug:t,spanSlug:n});return{pathname:o,query:{transaction:s,project:r,environment:a.environment,statsPeriod:a.statsPeriod,start:a.start,end:a.end,query:a.query}}}let n;s.d(t,{BP:()=>a,wL:()=>n}),function(e){e.MIN="min",e.MAX="max"}(n||(n={}))}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionSpans_spanDetails_index_tsx.cedbe6e33353be8dce314aef315127ed.js.map