"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_profiling_content_tsx"],{"./app/components/charts/areaChart.tsx":(e,t,s)=>{s.d(t,{T:()=>i});var o=s("./app/components/charts/series/lineSeries.tsx"),r=s("./app/components/charts/baseChart.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{series:t,stacked:s,colors:i,...a}=e;return(0,n.tZ)(r.Z,{...a,"data-test-id":"area-chart",colors:i,series:t.map(((e,t)=>{let{seriesName:r,data:n,...a}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.Z)({...e})}({stack:s?"area":void 0,name:r,data:n.map((e=>{let{name:t,value:s}=e;return[t,s]})),lineStyle:{color:i?.[t],opacity:1,width:.4},areaStyle:{color:i?.[t],opacity:1},animation:!1,animationThreshold:1,animationDuration:0,...a})}))})}i.displayName="AreaChart"},"./app/components/charts/chartZoom.tsx":(e,t,s)=>{s.d(t,{Z:()=>f});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),n=s("../node_modules/moment/moment.js"),i=s.n(n),a=s("../node_modules/query-string/index.js"),l=s("./app/actionCreators/pageFilters.tsx"),d=s("./app/components/charts/components/dataZoomInside.tsx");s("../node_modules/echarts/lib/component/dataZoomSlider.js");const p={realtime:!1,showDetail:!1,left:0,right:6,bottom:8};function c(e){return e&&Array.isArray(e)?e:[{...p,...e}]}var m=s("./app/components/charts/components/toolBox.tsx"),u=s("./app/utils/callIfFunction.tsx"),h=s("./app/utils/dates.tsx");const x=e=>e?i().utc(e).format(i().HTML5_FMT.DATETIME_LOCAL_SECONDS):null;class g extends r.Component{constructor(e){var t;super(e),t=this,(0,o.Z)(this,"history",void 0),(0,o.Z)(this,"currentPeriod",void 0),(0,o.Z)(this,"zooming",null),(0,o.Z)(this,"saveCurrentPeriod",(e=>{this.currentPeriod={period:e.period,start:x(e.start),end:x(e.end)}})),(0,o.Z)(this,"setPeriod",(function(e){let{period:s,start:o,end:r}=e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{router:i,onZoom:d,usePageDate:p}=t.props,c=x(o),m=x(r);n&&t.history.push(t.currentPeriod),d?.({period:s,start:c,end:m}),t.zooming=()=>{if(p&&i){const e={...i.location.query,pageStart:o?(0,h.v5)(o):void 0,pageEnd:r?(0,h.v5)(r):void 0,pageStatsPeriod:s??void 0};a.stringify(e)!==a.stringify(i.location.query)&&i.push({pathname:i.location.pathname,query:e})}else(0,l.dR)({period:s,start:c?(0,h.hC)(c):c,end:m?(0,h.hC)(m):m},i);t.saveCurrentPeriod({period:s,start:o,end:r})}})),(0,o.Z)(this,"handleChartReady",(e=>{this.props.onChartReady?.(e)})),(0,o.Z)(this,"handleZoomRestore",((e,t)=>{this.history.length&&(this.setPeriod(this.history[0]),this.history=[],this.props.onRestore?.(e,t))})),(0,o.Z)(this,"handleDataZoom",((e,t)=>{const s=t.getModel(),{startValue:o,endValue:r}=s._payload.batch[0];if(null===o&&null===r){const e=this.history.pop();if(!e)return;this.setPeriod(e)}else{const e=i().utc(o),t=i().utc(r);this.setPeriod({period:null,start:e,end:t},!0)}this.props.onDataZoom?.(e,t)})),(0,o.Z)(this,"handleChartFinished",((e,t)=>{"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const s=t._componentsViews?.find((e=>e._features&&e._features.dataZoom));s&&!s._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0}),(0,u.g)(this.props.onFinished)})),this.history=[],this.saveCurrentPeriod(e)}componentDidUpdate(){this.props.disabled||this.saveCurrentPeriod(this.props)}render(){const{utc:e,start:t,end:s,disabled:o,children:r,xAxisIndex:n,router:i,onZoom:a,onRestore:l,onChartReady:p,onDataZoom:u,onFinished:x,showSlider:g,chartZoomOptions:f,...y}=this.props,Z=e??void 0,v=t?(0,h.hC)(t):void 0,b=s?(0,h.hC)(s):void 0;return r(o?{utc:Z,start:v,end:b,...y}:{isGroupedByDate:!0,onChartReady:this.handleChartReady,utc:Z,start:v,end:b,dataZoom:g?[...c({xAxisIndex:n,...f}),...(0,d.Z)({xAxisIndex:n,...f})]:(0,d.Z)({xAxisIndex:n,...f}),showTimeInTooltip:!0,toolBox:(0,m.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom,onFinished:this.handleChartFinished,onRestore:this.handleZoomRestore,...y})}}g.displayName="ChartZoom";const f=g},"./app/components/charts/components/dataZoomInside.tsx":(e,t,s)=>{s.d(t,{Z:()=>r}),s("../node_modules/echarts/lib/component/dataZoomInside.js");const o={type:"inside",zoomOnMouseWheel:!1,zoomLock:!0,throttle:50};function r(e){return e&&Array.isArray(e)?e:[{...o,...e}]}},"./app/components/charts/components/toolBox.tsx":(e,t,s)=>{function o(){let{dataZoom:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e?{dataZoom:{yAxisIndex:"none",title:{zoom:"zoom",back:"undo"},...e}}:{},...t}}function r(e,t){return{right:0,top:0,itemSize:16,z:-1,feature:o(t),...e}}s.d(t,{Z:()=>r})},"./app/components/onboardingPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>c});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("./app/components/panels/index.tsx"),n=s("./app/styles/space.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{image:t,children:s,...o}=e;return(0,i.tZ)(r.s_,{...o,children:(0,i.BX)(l,{children:[t?(0,i.tZ)(p,{children:t}):null,(0,i.tZ)(d,{centered:!t,children:s})]})})}a.displayName="OnboardingPanel";const l=(0,o.Z)("div",{target:"euclof22"})("padding:",(0,n.Z)(3),";position:relative;@media (min-width: ",(e=>e.theme.breakpoints.small),"){display:flex;align-items:center;flex-direction:row;justify-content:center;flex-wrap:wrap;min-height:300px;max-width:1000px;margin:0 auto;}@media (min-width: ",(e=>e.theme.breakpoints.medium),"){min-height:350px;}"),d=(0,o.Z)("div",{target:"euclof21"})("z-index:1;",(e=>e.centered?"text-align: center;":"")," ",(e=>e.centered?"max-width: 600px;":""),"@media (min-width: ",(e=>e.theme.breakpoints.small),"){flex:2;}"),p=(0,o.Z)(d,{target:"euclof20"})("position:relative;min-height:100px;max-width:300px;margin:",(0,n.Z)(2)," auto;@media (min-width: ",(e=>e.theme.breakpoints.small),"){flex:1;margin:",(0,n.Z)(3),";max-width:auto;}"),c=a},"./app/utils/discover/charts.tsx":(e,t,s)=>{s.d(t,{CX:()=>i,Xp:()=>c,gu:()=>l,x1:()=>d});var o=s("./app/locale.tsx"),r=s("./app/utils.tsx"),n=s("./app/utils/formatters.tsx");function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number";return(0,r.ri)(e)?a(e,t):"—"}function a(e,t){if(!(0,r.ri)(e))return"—";switch(t){case"integer":case"number":return e.toLocaleString();case"percentage":return(0,n.rl)(e,2);case"duration":return(0,n.g9)(e/1e3,2,!0);case"size":return(0,r.F)(e);default:return e.toString()}}function l(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;return d(e,t,s,o)}function d(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;switch(t){case"integer":case"number":return s?(0,n.Du)(e):e.toLocaleString();case"percentage":return(0,n.rl)(e,0);case"duration":return p(e,o);case"size":return(0,r.F)(e,0);default:return e.toString()}}function p(e,t){if(t??=m(e),0===e)return"0";switch(t){case n.ps:{const t=(e/n.ps).toFixed(0);return(0,o.t)("%swk",t)}case n.x4:{const t=(e/n.x4).toFixed(0);return(0,o.t)("%sd",t)}case n.kr:{const t=(e/n.kr).toFixed(0);return(0,o.t)("%shr",t)}case n.EB:{const t=(e/n.EB).toFixed(0);return(0,o.t)("%smin",t)}case n.sh:{const t=(e/n.sh).toFixed(0);return(0,o.t)("%ss",t)}default:const t=e.toFixed(0);return(0,o.t)("%sms",t)}}function c(e,t){let s=0;const o=function(e,t){let s;if(e[0]?.data){let o,r=e[0];e.forEach(((s,n)=>{let{seriesName:i,data:a}=s;!1!==t?.selected?.[i]&&a.length&&(r=e[n],o??=e[n])})),o?.data&&(s={max:Math.max(...o.data.map((e=>{let{value:t}=e;return t})).filter((e=>!!e))),min:Math.min(...r.data.map((e=>{let{value:t}=e;return t})).filter((e=>!!e)))})}return s}(e,t);if(o){const e=(o.max+o.min)/2;s=m((o.max-o.min)/5),(e/s).toFixed(0).length>6&&(s=m(e))}return s}function m(e){return e>=n.ps?n.ps:e>=n.x4?n.x4:e>=n.kr?n.kr:e>=n.EB?n.EB:e>=n.sh?n.sh:1}},"./app/views/profiling/content.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>ne});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),n=s("../node_modules/react-router/es/index.js"),i=s("./app/components/alert.tsx"),a=s("./app/components/button.tsx"),l=s("./app/components/buttonBar.tsx"),d=s("./app/components/datePageFilter.tsx"),p=s("./app/components/environmentPageFilter.tsx"),c=s("./app/components/layouts/thirds.tsx"),m=s("./app/components/noProjectMessage.tsx"),u=s("./app/components/organizations/pageFilterBar.tsx"),h=s("./app/components/organizations/pageFilters/container.tsx"),x=s("./app/components/pageHeadingQuestionTooltip.tsx"),g=s("./app/components/pagination.tsx"),f=s("./app/components/profiling/profileEventsTable.tsx"),y=s("./app/components/projectPageFilter.tsx"),Z=s("./app/components/sentryDocumentTitle.tsx"),v=s("./app/components/sidebar/types.tsx"),b=s("./app/components/smartSearchBar/index.tsx"),w=s("./app/constants/index.tsx"),P=s("./app/constants/pageFilters.tsx"),j=s("./app/locale.tsx"),_=s("./app/stores/sidebarPanelStore.tsx"),k=s("./app/styles/space.tsx"),C=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),z=s("./app/utils/profiling/hooks/useProfileEvents.tsx"),A=s("./app/utils/profiling/hooks/useProfileFilters.tsx"),F=s("./app/utils/queryString.tsx"),S=s("./app/utils/useOrganization.tsx"),q=s("./app/utils/usePageFilters.tsx"),B=s("./app/utils/useProjects.tsx"),I=(s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js")),D=s("./app/components/charts/areaChart.tsx"),T=s("./app/components/charts/chartZoom.tsx"),X=s("./app/components/charts/styles.tsx"),E=s("./app/components/panels/index.tsx"),L=s("./app/utils/discover/charts.tsx"),R=s("./app/utils/discover/fields.tsx"),M=s("../node_modules/@tanstack/react-query/build/umd/index.production.js"),N=s("./app/components/organizations/pageFilters/parse.tsx"),O=s("./app/utils/useApi.tsx");function G(e,t){const s={axis:e,values:[]},o={dataset:"profiles",end:t.end,start:t.start},r=[];for(let e=0;e<t.data.length;e++){const[o,n]=t.data[e];s.values.push(n[0].count),r.push(o)}return{series:s,meta:o,timestamps:r}}var U=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const H=["count()","p99()","p95()","p75()"];function Q(e){let{query:t,router:s,selection:o}=e;const n=(0,I.u)(),i=function(e){let{yAxes:t,interval:s,query:o,referrer:r}=e;const n=(0,O.Z)(),i=(0,S.Z)(),{selection:a}=(0,q.Z)(),l=`/organizations/${i.slug}/events-stats/`,d={query:{dataset:"profiles",referrer:r,project:a.projects,environment:a.environments,...(0,N.fK)(a.datetime),yAxis:t,interval:s,query:o}},p=[l,d];return(0,M.useQuery)({queryKey:p,queryFn:()=>n.requestPromise(l,{method:"GET",includeAllArgs:!0,query:d.query}).then((e=>function(e,t){if(0===e.length)return[{data:[],meta:{dataset:"profiles",end:0,start:0},timestamps:[]},t[1],t[2]];if(1===e.length){const{series:s,meta:o,timestamps:r}=G(e[0],t[0]);return[{data:[s],meta:o,timestamps:r},t[1],t[2]]}const s=[];let o={dataset:"profiles",end:-1,start:-1},r=[],n=!0;for(const i of e){const e=G(i,t[0][i]);if(n)o=e.meta,r=e.timestamps;else{if(o.start!==e.meta.start||o.end!==e.meta.end)throw new Error("Mismatching start/end times");if(r.length!==e.timestamps.length||r.some(((t,s)=>t!==e.timestamps[s])))throw new Error("Mismatching timestamps")}s.push(e.series),n=!1}return[{data:s,meta:o,timestamps:r},t[1],t[2]]}(t,e))),refetchOnWindowFocus:!1,retry:!1})}({query:t,referrer:"api.profiling.landing-chart",yAxes:H}),a=(0,r.useMemo)((()=>{if("success"!==i.status)return[];const e=i.data[0].timestamps.map((e=>1e3*e)),t=i.data[0].data.filter((e=>H.indexOf(e.axis)>-1)).map((t=>{if(e.length!==t.values.length)throw new Error("Invalid stats response");return"count()"===t.axis?{data:t.values.map(((t,s)=>({name:e[s],value:t??0}))),seriesName:t.axis,xAxisIndex:0,yAxisIndex:0}:{data:t.values.map(((t,s)=>({name:e[s],value:(t??0)/1e6}))),seriesName:t.axis,xAxisIndex:1,yAxisIndex:1}}));return t.sort(((e,t)=>H.indexOf(e.seriesName)-H.indexOf(t.seriesName))),t}),[i]);return(0,U.tZ)(T.Z,{router:s,...o?.datetime,children:e=>(0,U.BX)(V,{children:[(0,U.BX)(W,{children:[(0,U.tZ)(K,{children:(0,j.t)("Profiles by Count")}),(0,U.tZ)(K,{children:(0,j.t)("Profiles by Percentiles")})]}),(0,U.tZ)(D.T,{height:300,series:a,grid:[{top:"32px",left:"24px",right:"52%",bottom:"16px"},{top:"32px",left:"52%",right:"24px",bottom:"16px"}],legend:{right:16,top:12,data:H.slice()},axisPointer:{link:[{xAxisIndex:[0,1]}]},xAxes:[{gridIndex:0,type:"time"},{gridIndex:1,type:"time"}],yAxes:[{gridIndex:0,scale:!0,axisLabel:{color:n.chartLabel,formatter:e=>(0,L.gu)(e,"integer")}},{gridIndex:1,scale:!0,axisLabel:{color:n.chartLabel,formatter:e=>(0,L.gu)(e,"duration")}}],tooltip:{valueFormatter:(e,t)=>(0,L.CX)(e,(0,R.Px)(t))},isGroupedByDate:!0,showTimeInTooltip:!0,...e})]})})}Q.displayName="ProfileCharts";const V=(0,o.Z)(E.s_,{target:"e1xfi5vp2"})("padding-top:",(0,k.Z)(2),";"),W=(0,o.Z)("div",{target:"e1xfi5vp1"})({name:"ai16bo",styles:"width:100%;display:flex;flex-direction:row"}),K=(0,o.Z)(X.Gh,{target:"e1xfi5vp0"})("flex-grow:1;margin-left:",(0,k.Z)(2),";");var J=s("./images/spot/performance-empty-state.svg"),$=s("./app/components/onboardingPanel.tsx");function Y(e){return(0,U.BX)($.Z,{image:(0,U.tZ)(ee,{src:J}),children:[(0,U.tZ)("h3",{children:(0,j.t)("Function level insights")}),(0,U.tZ)("p",{children:(0,j.t)("Discover slow-to-execute or resource intensive functions within your application")}),(0,U.tZ)(te,{gap:1,children:e.children})]})}Y.displayName="ProfilingOnboardingPanel";const ee=(0,o.Z)("img",{target:"eb17yy31"})("@media (min-width: ",(e=>e.theme.breakpoints.small),"){user-select:none;position:absolute;top:0;bottom:0;width:220px;margin-top:auto;margin-bottom:auto;transform:translateX(-50%);left:50%;}@media (min-width: ",(e=>e.theme.breakpoints.large),"){transform:translateX(-30%);width:380px;min-width:380px;}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){transform:translateX(-30%);width:420px;min-width:420px;}"),te=(0,o.Z)(l.ZP,{target:"eb17yy30"})({name:"vpj881",styles:"grid-template-columns:repeat(auto-fit, minmax(130px, max-content))"});function se(e){let{location:t,router:s}=e;const o=(0,S.Z)(),{selection:k}=(0,q.Z)(),I=(0,F.ro)(t.query.cursor),D=(0,F.ro)(t.query.query,""),T=(0,z.kq)((0,F.ro)(t.query.sort),oe,{key:"p99()",order:"desc"}),X=(0,A.J)({query:"",selection:k}),{projects:E}=(0,B.Z)(),L=(0,z.GP)({cursor:I,fields:oe,query:D,sort:T,referrer:"api.profiling.landing-table"}),R="error"===L.status?(0,z.Z)(L.error):null;(0,r.useEffect)((()=>{(0,C.Z)("profiling_views.landing",{organization:o})}),[o]);const M=(0,r.useCallback)((e=>{n.browserHistory.push({...t,query:{...t.query,cursor:void 0,query:e||void 0}})}),[t]),N=(0,r.useCallback)((()=>{(0,C.Z)("profiling_views.onboarding",{organization:o}),_.Z.activatePanel(v.z.ProfilingOnboarding)}),[o]),O=(0,r.useMemo)((()=>{if(0===k.projects.length||k.projects[0]===P.mP)return E.every((e=>!e.hasProfiles));const e=new Set(E.filter((e=>e.hasProfiles)).map((e=>e.id)));return k.projects.every((t=>!e.has(String(t))))}),[k.projects,E]);return(0,U.tZ)(Z.Z,{title:(0,j.t)("Profiling"),orgSlug:o.slug,children:(0,U.tZ)(h.Z,{children:(0,U.tZ)(m.Z,{organization:o,children:(0,U.BX)(c.T3,{children:[(0,U.BX)(c.h4,{children:[(0,U.tZ)(c.oB,{children:(0,U.BX)(c.Dx,{children:[(0,j.t)("Profiling"),(0,U.tZ)(x.u,{docsUrl:"https://docs.sentry.io/product/profiling/",title:(0,j.t)("A view of how your application performs in a variety of environments, based off of the performance profiles collected from real user devices in production.")})]})}),(0,U.tZ)(c.kP,{children:(0,U.BX)(l.ZP,{gap:1,children:[(0,U.tZ)(a.zx,{size:"sm",onClick:N,children:(0,j.t)("Set Up Profiling")}),(0,U.tZ)(a.zx,{size:"sm",priority:"primary",href:"https://discord.gg/zrMjKA4Vnz",external:!0,onClick:()=>{(0,C.Z)("profiling_views.visit_discord_channel",{organization:o})},children:(0,j.t)("Join Discord")})]})})]}),(0,U.tZ)(c.uT,{children:(0,U.BX)(c.or,{fullWidth:!0,children:[R&&(0,U.tZ)(i.bZ,{type:"error",showIcon:!0,children:R}),(0,U.BX)(re,{children:[(0,U.BX)(u.Z,{condensed:!0,children:[(0,U.tZ)(y.Z,{}),(0,U.tZ)(p.Z,{}),(0,U.tZ)(d.Z,{alignDropdown:"left"})]}),(0,U.tZ)(b.Z,{organization:o,hasRecentSearches:!0,searchSource:"profile_landing",supportedTags:X,query:D,onSearch:M,maxQueryLength:w.dI})]}),O?(0,U.BX)(Y,{children:[(0,U.tZ)(a.zx,{href:"https://docs.sentry.io/product/profiling/",external:!0,children:(0,j.t)("Read Docs")}),(0,U.tZ)(a.zx,{onClick:N,priority:"primary",children:(0,j.t)("Set Up Profiling")})]}):(0,U.BX)(r.Fragment,{children:[(0,U.tZ)(Q,{router:s,query:D,selection:k}),(0,U.tZ)(f.Q,{columns:oe.slice(),data:"success"===L.status?L.data[0]:null,error:"error"===L.status?(0,j.t)("Unable to load profiles"):null,isLoading:"loading"===L.status,sort:T,sortableColumns:new Set(oe)}),(0,U.tZ)(g.Z,{pageLinks:"success"===L.status?L.data?.[2]?.getResponseHeader("Link")??null:null})]})]})})]})})})})}se.displayName="ProfilingContent";const oe=["transaction","project.id","last_seen()","p75()","p95()","p99()","count()"],re=(0,o.Z)("div",{target:"emzmz060"})("display:grid;gap:",(0,k.Z)(2),";grid-template-columns:min-content auto;margin-bottom:",(0,k.Z)(2),";"),ne=se},"./images/spot/performance-empty-state.svg":(e,t,s)=>{e.exports=s.p+"assets/performance-empty-state.8da0e336a4e99ef87edb.svg"}}]);
//# sourceMappingURL=../sourcemaps/app_views_profiling_content_tsx.4944bb5385be62eb03a093345158f264.js.map