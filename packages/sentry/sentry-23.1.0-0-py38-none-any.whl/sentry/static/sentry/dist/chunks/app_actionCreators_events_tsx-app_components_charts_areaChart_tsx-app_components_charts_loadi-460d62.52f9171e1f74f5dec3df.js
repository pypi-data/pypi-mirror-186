"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_actionCreators_events_tsx-app_components_charts_areaChart_tsx-app_components_charts_loadi-460d62"],{"./app/actionCreators/events.tsx":(e,t,n)=>{n.d(t,{JE:()=>u,eV:()=>d,lI:()=>l});var s=n("../node_modules/lodash/pick.js"),i=n.n(s),r=n("./app/components/charts/utils.tsx"),a=n("./app/utils/getPeriod.tsx"),o=n("./app/utils/performance/constants.tsx");const l=(e,t)=>{let{organization:n,project:s,environment:i,team:o,period:l,start:d,end:u,interval:p,comparisonDelta:c,includePrevious:h,query:m,yAxis:f,field:g,topEvents:v,orderby:b,partial:y,withoutZerofill:k,referrer:x,queryBatching:Z,generatePathname:S,queryExtras:w,excludeOther:T,includeAllArgs:C}=t;const O=S?.(n)??`/organizations/${n.slug}/events-stats/`,E=(0,r.Sw)(h,l),j={includeAllArgs:C,query:{...Object.fromEntries(Object.entries({interval:p,comparisonDelta:c,project:s,environment:i,team:o,query:m,yAxis:f,field:g,topEvents:v,orderby:b,partial:y?"1":void 0,withoutZerofill:k?"1":void 0,referrer:x||"api.organization-event-stats",excludeOther:T?"1":void 0}).filter((e=>{let[,t]=e;return void 0!==t}))),...(0,a.X)({period:l,start:d,end:u},{shouldDoublePeriod:E}),...w}};return Z?.batchRequest?Z.batchRequest(e,O,j):e.requestPromise(O,j)};function d(e,t,n){const s={...i()(n,Object.values(o.s)),query:n.query};return e.requestPromise(`/organizations/${t}/events-facets/`,{query:s})}function u(e,t,n){const s={...i()(n,Object.values(o.s)),query:n.query};return e.requestPromise(`/organizations/${t}/events-meta/`,{query:s}).then((e=>e.count))}},"./app/components/charts/areaChart.tsx":(e,t,n)=>{n.d(t,{T:()=>a});var s=n("./app/components/charts/series/lineSeries.tsx"),i=n("./app/components/charts/baseChart.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{series:t,stacked:n,colors:a,...o}=e;return(0,r.tZ)(i.Z,{...o,"data-test-id":"area-chart",colors:a,series:t.map(((e,t)=>{let{seriesName:i,data:r,...o}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.Z)({...e})}({stack:n?"area":void 0,name:i,data:r.map((e=>{let{name:t,value:n}=e;return[t,n]})),lineStyle:{color:a?.[t],opacity:1,width:.4},areaStyle:{color:a?.[t],opacity:1},animation:!1,animationThreshold:1,animationDuration:0,...o})}))})}a.displayName="AreaChart"},"./app/components/charts/loadingPanel.tsx":(e,t,n)=>{n.d(t,{Z:()=>o});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=n("./app/components/loadingMask.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,s.Z)((e=>{let{height:t,...n}=e;return(0,r.tZ)("div",{...n,children:(0,r.tZ)(i.Z,{})})}),{target:"e16jayu70"})("flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height),";position:relative;border-color:transparent;margin-bottom:0;");a.defaultProps={height:"200px"};const o=a},"./app/components/events/searchBar.tsx":(e,t,n)=>{n.d(t,{Z:()=>M}),n("../node_modules/core-js/modules/es.error.cause.js"),n("../node_modules/core-js/modules/es.array.includes.js");var s=n("../node_modules/react/index.js"),i=n("../node_modules/@sentry/core/esm/exports.js"),r=n("../node_modules/lodash/assign.js"),a=n.n(r),o=n("../node_modules/lodash/flatten.js"),l=n.n(o),d=n("../node_modules/lodash/memoize.js"),u=n.n(d),p=n("../node_modules/lodash/omit.js"),c=n.n(p),h=n("./app/actionCreators/tags.tsx"),m=n("./app/components/smartSearchBar/index.tsx"),f=n("./app/constants/index.tsx"),g=n("./app/types/index.tsx"),v=n("./app/utils.tsx"),b=n("./app/utils/discover/fields.tsx"),y=n("./app/utils/fields/index.ts"),k=n("./app/utils/measurements/measurements.tsx"),x=n("./app/utils/useApi.tsx"),Z=n("./app/utils/withTags.tsx"),S=n("./app/views/dashboardsV2/utils.tsx"),w=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const T=new RegExp(`^${f.c$}|\\${f.ir}`,"g"),C=new Set(Object.keys(b.wZ)),O=Object.keys(b.wZ).reduce(((e,t)=>(e[t]={...b.wZ[t],kind:y.IV.FIELD},e)),{}),E=c()(O,b.J8),j=b.$4.reduce(((e,t)=>(e[t]={name:t,kind:y.IV.METRICS},e)),{}),F=Object.keys(b.jg).reduce(((e,t)=>(e[t]={...b.jg[t],kind:y.IV.FIELD},e)),{});function L(e){const{maxSearchItems:t,organization:n,tags:r,omitTags:o,fields:d,projectIds:p,includeSessionTagsValues:f,maxMenuHeight:Z,customMeasurements:L}=e,M=(0,x.Z)(),N=(0,s.useRef)(!1),_=(0,s.useMemo)((()=>(e=>e?.length?e.reduce(((e,t)=>(C.has(t.field)||(0,b.GO)(t.field)||(0,S.nk)(t.field)||(e[t.field]={key:t.field,name:t.field,kind:y.IV.FUNCTION}),e)),{}):[])(d)),[d]),I=(0,s.useMemo)((()=>Object.keys(r).reduce(((e,t)=>(e[t]={...r[t],kind:y.IV.TAG},e)),{})),[r]);(0,s.useEffect)((()=>{q.cache.clear?.()}),[p]);const q=u()(((e,t,s)=>{const i=p?.map(String);return(0,b.h1)(e.key)||(0,b.Xr)(e.key)?Promise.resolve([]):(0,h.Fo)({api:M,orgSlug:n.slug,tagKey:e.key,search:t,projectIds:i,endpointParams:s,includeTransactions:!0,includeSessions:f}).then((e=>l()(e.filter((e=>{let{name:t}=e;return(0,v.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:n}=e;return`${n}-${t}`})),V=e=>{let t;!N.current&&Object.keys(r).length>0&&(t=i.Yr({name:"SearchBar.getTagList"}),N.current=!0);const s=((e,t)=>{const n=Object.keys(e).reduce(((t,n)=>(t[n]={...e[n],kind:y.IV.MEASUREMENT},t)),{});return t?Object.keys(t).reduce(((e,n)=>(e[n]={...t[n],kind:y.IV.MEASUREMENT},e)),n):n})(e,L),l=n.features.includes("performance-view")?Object.assign({},s,_,j,O):Object.assign({},E);a()(l,I,O,F),l.has={key:y.Sh.HAS,name:"Has property",values:Object.keys(l).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),predefined:!0,kind:y.IV.FIELD};const d=o&&o.length>0?c()(l,o):l;if(t){const e=Object.keys(d).length;t.setTag("tags.totalCount",e);const n=[1,5,10,20,50,100,200,300,400,500,600,700,800,900,1e3,1e4].find((t=>e<=t));t.setTag("tags.totalCount.grouped",`<=${n}`),t.finish()}return d};return(0,w.tZ)(k.Z,{children:n=>{let{measurements:s}=n;return(0,w.tZ)(m.Z,{hasRecentSearches:!0,savedSearchType:g.L4.EVENT,onGetTagValues:q,supportedTags:V(s),prepareQuery:e=>e.replace(T,""),maxSearchItems:t,excludedTags:[y.Sh.ENVIRONMENT,y.Sh.TOTAL_COUNT],maxMenuHeight:Z??300,customPerformanceMetrics:L,...e})}})}L.displayName="SearchBar";const M=(0,Z.Z)(L)},"./app/components/loadingMask.tsx":(e,t,n)=>{n.d(t,{Z:()=>s});const s=(0,n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e9w1nku0"})("background-color:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";position:absolute;top:0;bottom:0;left:0;right:0;")},"./app/utils/getPeriod.tsx":(e,t,n)=>{n.d(t,{X:()=>o}),n("../node_modules/core-js/modules/es.error.cause.js");var s=n("../node_modules/moment/moment.js"),i=n.n(s),r=n("./app/constants/index.tsx"),a=n("./app/utils/dates.tsx");function o(e){let{period:t,start:n,end:s}=e,{shouldDoublePeriod:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t||n||s||(t=r.GY),t){if(!o)return{statsPeriod:t};const[,e,n]=t.match(/([0-9]+)([mhdw])/);return{statsPeriod:`${2*parseInt(e,10)}${n}`}}if(!n||!s)throw new Error("start and end required");const l=(0,a.v5)(n),d=(0,a.v5)(s);if(o){const e=i()(s).diff(i()(n)),t=i()(n).subtract(e);return{start:(0,a.v5)(t),end:d}}return{start:l,end:d}}},"./app/utils/withTags.tsx":(e,t,n)=>{n.d(t,{Z:()=>l});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=n("../node_modules/react/index.js"),r=n("./app/stores/tagStore.tsx"),a=n("./app/utils/getDisplayName.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends i.Component{constructor(){super(...arguments),(0,s.Z)(this,"state",{tags:r.Z.getState()}),(0,s.Z)(this,"unsubscribe",r.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...n}=this.props;return(0,o.tZ)(e,{tags:t??this.state.tags,...n})}}return t.displayName="WithTags",(0,s.Z)(t,"displayName",`withTags(${(0,a.Z)(e)})`),t}},"./app/views/eventsV2/table/arithmeticInput.tsx":(e,t,n)=>{n.d(t,{Z:()=>h});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/react/index.js")),a=n("../node_modules/lodash/isEqual.js"),o=n.n(a),l=n("./app/components/input.tsx"),d=n("./app/locale.tsx"),u=n("./app/styles/space.tsx"),p=n("./app/utils/discover/fields.tsx"),c=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class h extends r.PureComponent{constructor(){super(...arguments),(0,s.Z)(this,"state",{query:this.props.value,partialTerm:null,rawOptions:this.props.options,dropdownVisible:!1,dropdownOptionGroups:b(this.props.options,null,this.props.hideFieldOptions),activeSelection:-1}),(0,s.Z)(this,"input",(0,r.createRef)()),(0,s.Z)(this,"blur",(()=>{this.input.current?.blur()})),(0,s.Z)(this,"focus",(e=>{this.input.current?.focus(),this.input.current?.setSelectionRange(e,e)})),(0,s.Z)(this,"handleChange",(e=>{const t=e.target.value.replace("\n","");this.setState({query:t},this.updateAutocompleteOptions)})),(0,s.Z)(this,"handleClick",(()=>{this.updateAutocompleteOptions()})),(0,s.Z)(this,"handleFocus",(()=>{this.setState({dropdownVisible:!0})})),(0,s.Z)(this,"handleBlur",(()=>{this.props.onUpdate(this.state.query),this.setState({dropdownVisible:!1})})),(0,s.Z)(this,"handleKeyDown",(e=>{const{key:t}=e,{options:n,hideFieldOptions:s}=this.props,{activeSelection:i,partialTerm:r}=this.state,a=i>=0;if("ArrowDown"===t||"ArrowUp"===t){e.preventDefault();const o=b(n,r,s),l=o.map((e=>e.options)).flat();if(0===l.length)return;let d;return d=a?"ArrowUp"===t?(i-1+l.length)%l.length:(i+1)%l.length:"ArrowUp"===t?l.length-1:0,l[d].active=!0,void this.setState({activeSelection:d,dropdownOptionGroups:o})}if(!a||"Tab"!==t&&"Enter"!==t)"Enter"!==t||this.blur();else{e.preventDefault();const t=this.getSelection(i);t&&this.handleSelect(t)}})),(0,s.Z)(this,"handleKeyUp",(e=>{if("Escape"!==e.key)return;e.preventDefault();const{activeSelection:t}=this.state;t>=0||this.blur()})),(0,s.Z)(this,"handleSelect",(e=>{const{prefix:t,suffix:n}=this.splitQuery();this.setState({query:`${t}${e.value} ${n}`,activeSelection:-1},(()=>{this.focus(t.length+e.value.length+1),this.updateAutocompleteOptions()}))}))}static getDerivedStateFromProps(e,t){return o()(t.rawOptions,e.options)?{...t}:{...t,rawOptions:e.options,dropdownOptionGroups:b(e.options,t.partialTerm,e.hideFieldOptions),activeSelection:-1}}getCursorPosition(){return this.input.current?.selectionStart??-1}splitQuery(){const{query:e}=this.state,t=this.getCursorPosition(),n=[...e.substring(0,t).matchAll(/\s|^/g)],s=n[n.length-1],i=""===s[0]?0:(s.index||0)+1,r=e.slice(t).search(/\s|$/),a=t+(-1===r?0:r);return{startOfTerm:i,endOfTerm:a,prefix:e.substring(0,i),term:e.substring(i,a),suffix:e.substring(a)}}getSelection(e){const{dropdownOptionGroups:t}=this.state;for(const n of t){if(!(e>=n.options.length))return n.options[e];e-=n.options.length}return null}updateAutocompleteOptions(){const{options:e,hideFieldOptions:t}=this.props,{term:n}=this.splitQuery(),s=n||null;this.setState({dropdownOptionGroups:b(e,s,t),partialTerm:s})}render(){const{onUpdate:e,options:t,...n}=this.props,{dropdownVisible:s,dropdownOptionGroups:i}=this.state;return(0,c.BX)(m,{isOpen:s,children:[(0,c.tZ)(l.Z,{...n,ref:this.input,autoComplete:"off",className:"form-control",value:this.state.query,onClick:this.handleClick,onChange:this.handleChange,onBlur:this.handleBlur,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown,spellCheck:!1}),(0,c.tZ)(f,{isOpen:s,optionGroups:i,handleSelect:this.handleSelect})]})}}h.displayName="ArithmeticInput",(0,s.Z)(h,"defaultProps",{options:[]});const m=(0,i.Z)("div",{target:"e15df9hu7"})("background:",(e=>e.theme.background),";position:relative;border-radius:",(e=>e.isOpen?`${e.theme.borderRadius} ${e.theme.borderRadius} 0 0`:e.theme.borderRadius),";.show-sidebar &{background:",(e=>e.theme.backgroundSecondary),";}");function f(e){let{isOpen:t,optionGroups:n,handleSelect:s}=e;return(0,c.tZ)(y,{isOpen:t,children:t&&(0,c.tZ)(k,{children:n.map((e=>{const{title:t,options:n}=e;return(0,c.BX)(r.Fragment,{children:[(0,c.tZ)(x,{children:(0,c.tZ)(Z,{children:t})}),n.map((e=>(0,c.tZ)(S,{className:e.active?"active":void 0,onClick:()=>s(e),onMouseDown:e=>e.preventDefault(),ref:t=>e.active&&t?.scrollIntoView?.({block:"nearest"}),"aria-label":e.value,children:(0,c.tZ)(w,{children:e.value})},e.value))),0===n.length&&(0,c.tZ)(T,{children:(0,d.t)("No items found")})]},t)}))})})}function g(e,t){const n=new Set;return{title:"Fields",options:e.filter((e=>{let{kind:t}=e;return"equation"!==t})).filter(p.el).map((e=>({kind:"field",active:!1,value:(0,p.sN)(e)}))).filter((e=>{let{value:t}=e;return!n.has(t)&&(n.add(t),!0)})).filter((e=>{let{value:n}=e;return!t||n.includes(t)}))}}function v(e){return{title:"Operators",options:["+","-","*","/","(",")"].filter((t=>!e||t.includes(e))).map((e=>({kind:"operator",active:!1,value:e})))}}function b(e,t,n){return n?[v(t)]:[g(e,t),v(t)]}f.displayName="TermDropdown";const y=(0,i.Z)("div",{target:"e15df9hu6"})("display:",(e=>e.isOpen?"block":"none"),";position:absolute;top:100%;left:-1px;right:-1px;z-index:",(e=>e.theme.zIndex.dropdown),";background:",(e=>e.theme.backgroundElevated),";box-shadow:",(e=>e.theme.dropShadowHeavy),";border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";margin-top:",(0,u.Z)(1),";max-height:300px;overflow-y:auto;"),k=(0,i.Z)("ul",{target:"e15df9hu5"})({name:"nfj5ll",styles:"padding-left:0;list-style:none;margin-bottom:0"}),x=(0,i.Z)("li",{target:"e15df9hu4"})("&:not(:last-child){border-bottom:1px solid ",(e=>e.theme.innerBorder),";}"),Z=(0,i.Z)("header",{target:"e15df9hu3"})("display:flex;align-items:center;background-color:",(e=>e.theme.backgroundSecondary),";color:",(e=>e.theme.gray300),";font-weight:normal;font-size:",(e=>e.theme.fontSizeMedium),";margin:0;padding:",(0,u.Z)(1)," ",(0,u.Z)(2),";&>svg{margin-right:",(0,u.Z)(1),";}"),S=(0,i.Z)(x,{target:"e15df9hu2"})("scroll-margin:40px 0;font-size:",(e=>e.theme.fontSizeLarge),";padding:",(0,u.Z)(1)," ",(0,u.Z)(2),";cursor:pointer;&:hover,&.active{background:",(e=>e.theme.hover),";}"),w=(0,i.Z)("div",{target:"e15df9hu1"})("color:",(e=>e.theme.textColor),";font-weight:normal;font-size:",(e=>e.theme.fontSizeMedium),";margin:0;line-height:",(e=>e.theme.text.lineHeightHeading),";",(e=>e.theme.overflowEllipsis),";"),T=(0,i.Z)("div",{target:"e15df9hu0"})("display:flex;padding:",(0,u.Z)(1)," ",(0,u.Z)(2),";font-size:",(e=>e.theme.fontSizeLarge),";color:",(e=>e.theme.gray300),";&:not(:last-child){border-bottom:1px solid ",(e=>e.theme.innerBorder),";}")},"./app/views/eventsV2/table/queryField.tsx":(e,t,n)=>{n.d(t,{q:()=>Z});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(n("../node_modules/core-js/modules/es.error.cause.js"),n("../node_modules/core-js/modules/es.array.push.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/react/index.js")),a=n("../node_modules/react-select/dist/index-4bd03571.esm.js"),o=n("../node_modules/lodash/cloneDeep.js"),l=n.n(o),d=n("./app/components/forms/controls/selectControl.tsx"),u=n("./app/components/input.tsx"),p=n("./app/components/tag.tsx"),c=n("./app/components/tooltip.tsx"),h=n("./app/icons/index.tsx"),m=n("./app/locale.tsx"),f=n("./app/styles/animations.tsx"),g=n("./app/styles/space.tsx"),v=n("./app/utils/discover/fields.tsx"),b=n("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx"),y=n("./app/views/eventsV2/table/arithmeticInput.tsx"),k=n("./app/views/eventsV2/table/types.tsx"),x=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class Z extends r.Component{constructor(){super(...arguments),(0,s.Z)(this,"FieldSelectComponents",{SingleValue:e=>{let{data:t,...n}=e;return(0,x.BX)(a.c.SingleValue,{data:t,...n,children:[(0,x.tZ)("span",{"data-test-id":"label",children:t.label}),t.value&&this.renderTag(t.value.kind,t.label)]})}}),(0,s.Z)(this,"FieldSelectStyles",{singleValue:e=>({...e,display:"flex",justifyContent:"space-between",alignItems:"center"})}),(0,s.Z)(this,"handleFieldChange",(e=>{if(!e)return;const{value:t}=e,n=this.props.fieldValue;let s=l()(this.props.fieldValue);switch(t.kind){case k.L.TAG:case k.L.MEASUREMENT:case k.L.CUSTOM_MEASUREMENT:case k.L.BREAKDOWN:case k.L.FIELD:s={kind:"field",field:t.meta.name};break;case k.L.NUMERIC_METRICS:s={kind:"calculatedField",field:t.meta.name};break;case k.L.FUNCTION:s="function"===n.kind?{kind:"function",function:[t.meta.name,n.function[1],n.function[2],n.function[3]]}:{kind:"function",function:[t.meta.name,"",void 0,void 0]};break;case k.L.EQUATION:s={kind:"equation",field:t.meta.name,alias:t.meta.name};break;default:throw new Error("Invalid field type found in column picker")}t.kind===k.L.FUNCTION&&(t.meta.parameters.forEach(((e,t)=>{if("function"===s.kind)if("column"===e.kind){const n=this.getFieldOrTagOrMeasurementValue(s.function[t+1]);null===n?s.function[t+1]=e.defaultValue||"":n.kind!==k.L.FIELD&&n.kind!==k.L.TAG&&n.kind!==k.L.MEASUREMENT&&n.kind!==k.L.CUSTOM_MEASUREMENT&&n.kind!==k.L.METRICS&&n.kind!==k.L.BREAKDOWN||!S(e.columnTypes,n)?(s.function[t+1]=e.defaultValue||"",s.function[t+2]=void 0,s.function[t+3]=void 0):s.function[t+1]=n.meta.name}else s.function[t+1]=e.defaultValue||""})),"function"===s.kind&&(0===t.meta.parameters.length?s.function=[s.function[0],"",void 0,void 0]:1===t.meta.parameters.length?(s.function[2]=void 0,s.function[3]=void 0):2===t.meta.parameters.length&&(s.function[3]=void 0))),this.triggerChange(s)})),(0,s.Z)(this,"handleEquationChange",(e=>{const t=l()(this.props.fieldValue);t.kind===k.L.EQUATION&&(t.field=e),this.triggerChange(t)})),(0,s.Z)(this,"handleFieldParameterChange",(e=>{let{value:t}=e;const n=l()(this.props.fieldValue);"function"===n.kind&&(n.function[1]=t.meta.name),this.triggerChange(n)})),(0,s.Z)(this,"handleDropdownParameterChange",(e=>t=>{const n=l()(this.props.fieldValue);"function"===n.kind&&(n.function[e]=t.value),this.triggerChange(n)})),(0,s.Z)(this,"handleScalarParameterChange",(e=>t=>{const n=l()(this.props.fieldValue);"function"===n.kind&&(n.function[e]=t),this.triggerChange(n)}))}triggerChange(e){this.props.onChange(e)}getFieldOrTagOrMeasurementValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const{fieldOptions:n}=this.props;if(void 0===e)return null;const s=`field:${e}`;if(n[s])return n[s].value;const i=`measurement:${e}`;if(n[i])return n[i].value;const r=`span_op_breakdown:${e}`;if(n[r])return n[r].value;const a=`equation:${e}`;if(n[a])return n[a].value;const o=0===e.indexOf("tags[")?`tag:${e.replace(/tags\[(.*?)\]/,"$1")}`:`tag:${e}`;return n[o]?n[o].value:e.length>0?e.startsWith("measurements.")?{kind:k.L.CUSTOM_MEASUREMENT,meta:{name:e,dataType:"number",functions:t}}:{kind:k.L.TAG,meta:{name:e,dataType:"string",unknown:!0}}:null}getFieldData(){let e=null;const{fieldValue:t}=this.props;let{fieldOptions:n}=this.props;if("function"===t?.kind){const s=`function:${t.function[0]}`;void 0!==n[s]&&(e=n[s].value)}"field"!==t?.kind&&"calculatedField"!==t?.kind||(e=this.getFieldOrTagOrMeasurementValue(t.field),n=this.appendFieldIfUnknown(n,e));let s=[];return e&&e.kind===k.L.FUNCTION&&e.meta.parameters.length>0&&t?.kind===k.L.FUNCTION&&(s=e.meta.parameters.map(((e,s)=>{if("column"===e.kind){const s=this.getFieldOrTagOrMeasurementValue(t.function[1],[t.function[0]]);return n=this.appendFieldIfUnknown(n,s),{kind:"column",value:s,required:e.required,options:Object.values(n).filter((t=>{let{value:n}=t;return(n.kind===k.L.FIELD||n.kind===k.L.TAG||n.kind===k.L.MEASUREMENT||n.kind===k.L.CUSTOM_MEASUREMENT||n.kind===k.L.METRICS||n.kind===k.L.BREAKDOWN)&&S(e.columnTypes,n)}))}}return"dropdown"===e.kind?{kind:"dropdown",options:e.options,dataType:e.dataType,required:e.required,value:"function"===t.kind&&t.function[s+1]||e.defaultValue||""}:{kind:"value",value:"function"===t.kind&&t.function[s+1]||e.defaultValue||"",dataType:e.dataType,required:e.required,placeholder:e.placeholder}}))),{field:e,fieldOptions:n,parameterDescriptions:s}}appendFieldIfUnknown(e,t){return t?(t&&t.kind===k.L.TAG&&t.meta.unknown?(e=Object.assign({},e))[t.meta.name]={label:t.meta.name,value:t}:t&&t.kind===k.L.CUSTOM_MEASUREMENT&&((e=Object.assign({},e))[`measurement:${t.meta.name}`]={label:t.meta.name,value:t}),e):e}renderParameterInputs(e){const{disabled:t,inFieldLabels:n,filterAggregateParameters:s,hideParameterSelector:i,skipParameterPlaceholder:r,fieldValue:a}=this.props,o=e.map(((e,r)=>{if("column"===e.kind&&e.options.length>0){if(i)return null;const r=s?e.options.filter((e=>s(e,a))):e.options;return r.forEach((e=>{e.trailingItems=this.renderTag(e.value.kind,String(e.label))})),(0,x.tZ)(d.Z,{name:"parameter",menuPlacement:"auto",placeholder:(0,m.t)("Select value"),options:r,value:e.value,required:e.required,onChange:this.handleFieldParameterChange,inFieldLabel:n?(0,m.t)("Parameter: "):void 0,disabled:t,styles:n?void 0:this.FieldSelectStyles,components:this.FieldSelectComponents},"select")}if("value"===e.kind){const n={required:e.required,value:e.value,onUpdate:this.handleScalarParameterChange(r+1),placeholder:e.placeholder,disabled:t};switch(e.dataType){case"number":return(0,x.tZ)(T,{name:"refinement",type:"text",inputMode:"numeric",pattern:"[0-9]*(\\.[0-9]*)?",...n},"parameter:number");case"integer":return(0,x.tZ)(T,{name:"refinement",type:"text",inputMode:"numeric",pattern:"[0-9]*",...n},"parameter:integer");default:return(0,x.tZ)(T,{name:"refinement",type:"text",...n},"parameter:text")}}if("dropdown"===e.kind)return(0,x.tZ)(d.Z,{name:"dropdown",menuPlacement:"auto",placeholder:(0,m.t)("Select value"),options:e.options,value:e.value,required:e.required,onChange:this.handleDropdownParameterChange(r+1),inFieldLabel:n?(0,m.t)("Parameter: "):void 0,disabled:t},"dropdown");throw new Error(`Unknown parameter type encountered for ${this.props.fieldValue}`)}));if(r)return o;const{gridColumns:l}=this.props,u=(l??o.length+1)-o.length-1;if(void 0!==l&&u>0)for(let e=0;e<u;e++)o.push((0,x.tZ)(O,{"data-test-id":"blankSpace"},e));return o}renderTag(e,t){const{shouldRenderTag:n}=this.props;if(!1===n)return null;let s,i;switch(e){case k.L.FUNCTION:s="f(x)",i="success";break;case k.L.CUSTOM_MEASUREMENT:case k.L.MEASUREMENT:case k.L.BREAKDOWN:s="field",i="highlight";break;case k.L.TAG:s=e,i="warning";break;case k.L.NUMERIC_METRICS:s="f(x)",i="success";break;case k.L.FIELD:case k.L.METRICS:s=v.NF.includes(t)?"deprecated":"field",i="highlight";break;default:s=e}return(0,x.tZ)(p.Z,{type:i,children:s})}render(){const{className:e,takeFocus:t,filterPrimaryOptions:n,fieldValue:s,inFieldLabels:i,disabled:r,error:a,hidePrimarySelector:o,gridColumns:l,otherColumns:u,placeholder:p,noFieldsMessage:c,skipParameterPlaceholder:f}=this.props,{field:g,fieldOptions:Z,parameterDescriptions:S}=this.getFieldData(),T=n?Object.values(Z).filter(n):Object.values(Z);T.forEach((e=>{e.trailingItems=this.renderTag(e.value.kind,String(e.label))}));const C={name:"field",options:Object.values(T),placeholder:p??(0,m.t)("(Required)"),value:g,onChange:this.handleFieldChange,inFieldLabel:i?(0,m.t)("Function: "):void 0,disabled:r,noOptionsMessage:()=>c,menuPlacement:"auto"};t&&null===g&&(C.autoFocus=!0);const O=this.renderParameterInputs(S);if(s?.kind===k.L.EQUATION)return(0,x.BX)(w,{className:e,gridColumns:1,tripleLayout:!1,error:void 0!==a,"data-test-id":"queryField",children:[(0,x.tZ)(y.Z,{name:"arithmetic",type:"text",required:!0,value:s.field,onUpdate:this.handleEquationChange,options:u,placeholder:(0,m.t)("Equation")},"parameter:text"),a?(0,x.tZ)(E,{title:a,children:(0,x.tZ)(h.FC,{color:"errorText","data-test-id":"arithmeticErrorWarning"})}):null]});const j=O.length>2?2:l||O.length+1;let F;if(f)if("function"!==s.kind)F=1;else{const e=v.lx[s.function[0]]??b.Am[s.function[0]];F=e.parameters.length>0?3===j&&1===e.parameters.length?2:j:1}return(0,x.BX)(w,{className:e,gridColumns:F??j,tripleLayout:3===l&&O.length>2,"data-test-id":"queryField",children:[!o&&(0,x.tZ)(d.Z,{...C,styles:i?void 0:this.FieldSelectStyles,components:this.FieldSelectComponents}),O]})}}function S(e,t){return"function"==typeof e?e({name:t.meta.name,dataType:t.meta.dataType}):e.includes(t.meta.dataType)}Z.displayName="QueryField";const w=(0,i.Z)("div",{target:"ep1lt9a3"})("display:grid;",(e=>e.tripleLayout?"grid-template-columns: 1fr 2fr;":`grid-template-columns: repeat(${e.gridColumns}, 1fr) ${e.error?"auto":""};`)," gap:",(0,g.Z)(1),";align-items:center;flex-grow:1;");class T extends r.Component{constructor(e){super(e),(0,s.Z)(this,"state",{value:this.props.value}),(0,s.Z)(this,"input",void 0),(0,s.Z)(this,"handleBlur",(()=>{this.props.required&&""===this.state.value?this.setState({value:this.props.value}):this.isValid?this.props.onUpdate(this.state.value):this.setState({value:this.props.value})})),(0,s.Z)(this,"handleChange",(e=>{this.isValid&&this.setState({value:e.target.value})})),this.input=(0,r.createRef)()}get isValid(){return!this.input.current||this.input.current.validity.valid}render(){const{onUpdate:e,...t}=this.props;return(0,x.tZ)(C,{...t,ref:this.input,className:"form-control",value:this.state.value,onChange:this.handleChange,onBlur:this.handleBlur})}}T.displayName="BufferedInput";const C=(0,i.Z)(u.Z,{target:"ep1lt9a2"})({name:"jixqcp",styles:"min-width:50px"}),O=(0,i.Z)("div",{target:"ep1lt9a1"})("height:",(e=>e.theme.form.md.height),"px;min-width:50px;background:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";display:flex;align-items:center;justify-content:center;&:after{font-size:",(e=>e.theme.fontSizeMedium),";content:'",(0,m.t)("No parameter"),"';color:",(e=>e.theme.subText),";}"),E=(0,i.Z)(c.ZP,{target:"ep1lt9a0"})("color:",(e=>e.theme.errorText),";animation:",(()=>(0,f.dC)(1.15))," 1s ease infinite;display:flex;")}}]);
//# sourceMappingURL=../sourcemaps/app_actionCreators_events_tsx-app_components_charts_areaChart_tsx-app_components_charts_loadi-460d62.83314e8c2f674dc1d9ed0afa5bd05c5d.js.map