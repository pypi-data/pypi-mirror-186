(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_project_projectOwnership_ownerInput_tsx"],{"./app/actionCreators/projects.tsx":(e,t,s)=>{"use strict";s.d(t,{$L:()=>w,$P:()=>f,M9:()=>b,Nh:()=>h,Oe:()=>j,TA:()=>v,Vx:()=>p,bL:()=>y,iC:()=>S,mf:()=>_,pK:()=>x,rR:()=>Z,xV:()=>C}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/lodash/chunk.js"),o=s.n(r),a=s("../node_modules/lodash/debounce.js"),n=s.n(a),i=s("./app/actionCreators/indicator.tsx"),l=s("./app/locale.tsx"),d=s("./app/stores/latestContextStore.tsx"),c=s("./app/stores/projectsStatsStore.tsx"),u=s("./app/stores/projectsStore.tsx");function p(e,t){c.Z.onUpdate(t.projectId,t.data);const s=`/projects/${t.orgId}/${t.projectId}/`;return e.requestPromise(s,{method:"PUT",data:t.data}).then((e=>(u.Z.onUpdateSuccess(e),e)),(e=>{throw c.Z.onUpdateError(e,t.projectId),e}))}function h(e,t){const s=`/organizations/${t.orgId}/stats/`;e.request(s,{query:t.query,success:e=>u.Z.onStatsLoadSuccess(e)})}const m=new Set,g=n()(((e,t,s)=>{const r=c.Z.getAll(),a=Object.values(r).map((e=>{let{id:t}=e;return t})),n=Array.from(t).filter((e=>!a.includes(e)));if(!n.length)return void m.clear();const d=o()(n,10).map((t=>((e,t,s,r)=>{const o=`/organizations/${s}/projects/`,a={statsPeriod:"24h",query:t.map((e=>`id:${e}`)).join(" "),...r};return e.requestPromise(o,{query:a})})(e,t,s.orgId,s.query)));Promise.all(d).then((e=>{c.Z.onStatsLoadSuccess(e.reduce(((e,t)=>e.concat(t)),[]))})).catch((()=>{(0,i.Iw)((0,l.t)("Unable to fetch all project stats"))})),m.clear()}),50);function f(e,t,s){m.add(t),g(e,m,s)}function x(e){d.Z.onSetActiveProject(e)}function Z(e,t,s){const r=`/projects/${t}/${s.slug}/`;return e.requestPromise(r,{method:"DELETE"}).then((()=>{(0,i.S9)((0,l._N)("[project] was successfully removed",{project:s.slug}))}),(e=>{throw(0,i.Iw)((0,l._N)("Error removing [project]",{project:s.slug})),e}))}function y(e,t,s,r){const o=`/projects/${t}/${s.slug}/transfer/`;return e.requestPromise(o,{method:"POST",data:{email:r}}).then((()=>{(0,i.S9)((0,l._N)("A request was sent to move [project] to a different organization",{project:s.slug}))}),(e=>{let t="";throw e.status>=400&&e.status<500&&e.responseJSON&&(t=e.responseJSON?.detail),t?(0,i.Iw)((0,l._N)("Error transferring [project]. [message]",{project:s.slug,message:t})):(0,i.Iw)((0,l._N)("Error transferring [project]",{project:s.slug})),e}))}function j(e,t,s,r){const o=`/projects/${t}/${s}/teams/${r.slug}/`;return(0,i.E3)(),e.requestPromise(o,{method:"POST"}).then((e=>{(0,i.S9)((0,l._N)("[team] has been added to the [project] project",{team:`#${r.slug}`,project:s})),u.Z.onAddTeam(r,s),u.Z.onUpdateSuccess(e)}),(e=>{throw(0,i.Iw)((0,l._N)("Unable to add [team] to the [project] project",{team:`#${r.slug}`,project:s})),e}))}function b(e,t,s,r){const o=`/projects/${t}/${s}/teams/${r}/`;return(0,i.E3)(),e.requestPromise(o,{method:"DELETE"}).then((e=>{(0,i.S9)((0,l._N)("[team] has been removed from the [project] project",{team:`#${r}`,project:s})),u.Z.onRemoveTeam(r,s),u.Z.onUpdateSuccess(e)}),(e=>{throw(0,i.Iw)((0,l._N)("Unable to remove [team] from the [project] project",{team:`#${r}`,project:s})),e}))}function v(e,t){u.Z.onChangeSlug(e,t)}function w(e,t,s,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};return e.requestPromise(`/teams/${t}/${s}/projects/`,{method:"POST",data:{name:r,platform:o,default_rules:a.defaultRules}})}function S(e,t,s,r){return e.requestPromise(`/projects/${t}/${s}/docs/${r}/`)}function C(e,t){return e.requestPromise(`/organizations/${t}/projects-count/`)}async function _(e,t,s){return(await e.requestPromise(`/organizations/${t}/releases/stats/`,{method:"GET",query:{statsPeriod:"90d",project:s,per_page:1}})).length>0}},"./app/actionCreators/teams.tsx":(e,t,s)=>{"use strict";s.d(t,{Cm:()=>u,PX:()=>i,s:()=>c,tT:()=>p,um:()=>d,z_:()=>l});var r=s("./app/actionCreators/indicator.tsx"),o=s("./app/locale.tsx"),a=s("./app/stores/teamStore.tsx");const n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var s=arguments.length,r=new Array(s>2?s-2:0),o=2;o<s;o++)r[o-2]=arguments[o];return e[t]?.(...r)};async function i(e,t){const s=await e.requestPromise(`/organizations/${t.orgId}/user-teams/`);a.Z.loadUserTeams(s)}function l(e,t){a.Z.onUpdateSuccess(e,t)}function d(e,t,s){const r=`/organizations/${t.orgId}/members/${t.memberId??"me"}/teams/${t.teamId}/`;return e.request(r,{method:"POST",success:e=>{a.Z.onUpdateSuccess(t.teamId,e),n(s,"success",e)},error:e=>{n(s,"error",e)}})}function c(e,t,s){const r=`/organizations/${t.orgId}/members/${t.memberId||"me"}/teams/${t.teamId}/`;return e.request(r,{method:"DELETE",success:e=>{a.Z.onUpdateSuccess(t.teamId,e),n(s,"success",e)},error:e=>{n(s,"error",e)}})}function u(e,t,s){return e.requestPromise(`/organizations/${s.orgId}/teams/`,{method:"POST",data:t}).then((e=>(a.Z.onCreateSuccess(e),(0,r.S9)((0,o._N)("[team] has been added to the [organization] organization",{team:`#${e.slug}`,organization:s.orgId})),e)),(e=>{throw(0,r.Iw)((0,o._N)("Unable to create [team] in the [organization] organization",{team:`#${t.slug}`,organization:s.orgId})),e}))}function p(e,t){return e.requestPromise(`/teams/${t.orgId}/${t.teamId}/`,{method:"DELETE"}).then((e=>(a.Z.onRemoveSuccess(t.teamId),(0,r.S9)((0,o._N)("[team] has been removed from the [organization] organization",{team:`#${t.teamId}`,organization:t.orgId})),e)),(e=>{throw(0,r.Iw)((0,o._N)("Unable to remove [team] from the [organization] organization",{team:`#${t.teamId}`,organization:t.orgId})),e}))}},"./app/components/avatar/actorAvatar.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>c}),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/@sentry/core/esm/exports.js"),o=s("./app/components/avatar/teamAvatar.tsx"),a=s("./app/components/avatar/userAvatar.tsx"),n=s("./app/components/loadingIndicator.tsx"),i=s("./app/stores/memberListStore.tsx"),l=s("./app/utils/teams.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c=function(e){let{size:t=24,hasTooltip:s=!0,actor:c,...u}=e;const p={size:t,hasTooltip:s,...u};if("user"===c.type){const e=c.id?i.Z.getById(c.id)??c:c;return(0,d.tZ)(a.Z,{user:e,...p})}return"team"===c.type?(0,d.tZ)(l.Z,{ids:[c.id],children:e=>{let{initiallyLoaded:t,teams:s}=e;return t?(0,d.tZ)(o.Z,{team:s[0],...p}):(0,d.tZ)(n.Z,{mini:!0})}}):(r.$e((e=>{e.setExtra("actor",c),r.Tb(new Error("Unknown avatar type"))})),null)}},"./app/components/tag.tsx":(e,t,s)=>{"use strict";s.d(t,{A:()=>y,Z:()=>w});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),a=s("./app/components/button.tsx"),n=s("./app/components/links/externalLink.tsx"),i=s("./app/components/links/link.tsx"),l=s("./app/components/tooltip.tsx"),d=s("./app/icons/index.tsx"),c=s("./app/locale.tsx"),u=s("./app/styles/space.tsx"),p=s("./app/utils.tsx"),h=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),m=s("./app/utils/theme.tsx"),g=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const f="20px";function x(e){let{type:t="default",icon:s,tooltipText:r,to:a,onClick:u,href:f,onDismiss:x,children:w,textMaxWidth:S=150,...C}=e;const _={size:"xs",color:m.ZP.tag[t].iconColor},I=(0,g.tZ)(l.ZP,{title:r,containerDisplayMode:"inline-flex",children:(0,g.BX)(y,{type:t,children:[(0,o.isValidElement)(s)?(0,g.tZ)(j,{children:(0,o.cloneElement)(s,{..._})}):((0,p.ri)(f)||(0,p.ri)(a))&&void 0===s?(0,g.tZ)(j,{children:(0,g.tZ)(d.V$,{..._})}):null,(0,g.tZ)(b,{type:t,maxWidth:S,children:w}),(0,p.ri)(x)&&(0,g.tZ)(v,{onClick:function(e){e.preventDefault(),x?.()},size:"zero",priority:"link","aria-label":(0,c.t)("Dismiss"),children:(0,g.tZ)(d.bM,{isCircled:!0,..._})})]})});return(0,g.tZ)(Z,{...C,onClick:()=>{(0,h.Z)("tag.clicked",{is_clickable:(0,p.ri)(u)||(0,p.ri)(a)||(0,p.ri)(f),organization:null})},children:(0,p.ri)(f)?(0,g.tZ)(n.Z,{href:f,children:I}):(0,p.ri)(a)&&(0,p.ri)(u)?(0,g.tZ)(i.Z,{to:a,onClick:u,children:I}):(0,p.ri)(a)?(0,g.tZ)(i.Z,{to:a,children:I}):I})}x.displayName="Tag";const Z=(0,r.Z)("span",{target:"ecaysl4"})("font-size:",(e=>e.theme.fontSizeSmall),";"),y=(0,r.Z)("div",{target:"ecaysl3"})("display:inline-flex;align-items:center;height:",f,";border-radius:",f,";background-color:",(e=>e.theme.tag[e.type].background),";border:solid 1px ",(e=>e.theme.tag[e.type].border),";padding:0 ",(0,u.Z)(1),";"),j=(0,r.Z)("span",{target:"ecaysl2"})("margin-right:",(0,u.Z)(.5),";display:inline-flex;"),b=(0,r.Z)("span",{target:"ecaysl1"})("color:",(e=>["black","white"].includes(e.type)?e.theme.tag[e.type].iconColor:e.theme.textColor),";max-width:",(e=>e.maxWidth),"px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;line-height:",f,";"),v=(0,r.Z)(a.zx,{target:"ecaysl0"})("margin-left:",(0,u.Z)(.5),";border:none;"),w=x},"./app/components/textOverflow.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,r.Z)((e=>{let{children:t,className:s,ellipsisDirection:r,isParagraph:a,"data-test-id":n}=e;const i=a?"p":"div";return"left"===r?(0,o.tZ)(i,{className:s,"data-test-id":n,children:(0,o.tZ)("bdi",{children:t})}):(0,o.tZ)(i,{className:s,"data-test-id":n,children:t})}),{target:"e1lyrgnz0"})((e=>e.theme.overflowEllipsis)," ",(e=>"left"===e.ellipsisDirection&&"\n      direction: rtl;\n      text-align: left;\n    "),";width:auto;line-height:1.2;");a.defaultProps={ellipsisDirection:"right",isParagraph:!1};const n=a},"./app/stores/memberListStore.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});const r={loaded:!1,state:[],init(){this.state=[],this.loaded=!1},loadInitialData(e){this.state=e,this.loaded=!0,this.trigger(this.state,"initial")},isLoaded(){return this.loaded},getById(e){if(this.state){e=""+e;for(let t=0;t<this.state.length;t++)if(this.state[t].id===e)return this.state[t]}},getAll(){return this.state},getState(){return this.state}},o=(0,s("../node_modules/reflux/src/index.js").createStore)(r)},"./app/stores/projectsStatsStore.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});const r={itemsBySlug:{},init(){this.reset()},getInitialState(){return this.itemsBySlug},reset(){this.itemsBySlug={},this.updatingItems=new Map},onStatsLoadSuccess(e){e.forEach((e=>{this.itemsBySlug[e.slug]=e})),this.trigger(this.itemsBySlug)},onUpdate(e,t){const s=this.getBySlug(e);if(this.updatingItems.set(e,s),!s)return;const r={...s,...t};this.itemsBySlug={...this.itemsBySlug,[s.slug]:r},this.trigger(this.itemsBySlug)},onUpdateSuccess(e){this.updatingItems.delete(e.slug)},onUpdateError(e,t){const s=this.updatingItems.get(t);s&&(this.updatingItems.delete(t),this.itemsBySlug={...this.itemsBySlug,[s.slug]:{...s}},this.trigger(this.itemsBySlug))},getAll(){return this.itemsBySlug},getBySlug(e){return this.itemsBySlug[e]}},o=(0,s("../node_modules/reflux/src/index.js").createStore)(r)},"./app/utils/isActiveSuperuser.tsx":(e,t,s)=>{"use strict";s.d(t,{M:()=>i});var r=s("../node_modules/js-cookie/dist/js.cookie.mjs"),o=s("./app/stores/configStore.tsx");const a=window.superUserCookieName??"su",n=window.superUserCookieDomain;function i(){const{isSuperuser:e}=o.Z.get("user")||{};if(e){const e=o.Z.get("superUserCookieName")||a,t=o.Z.get("superUserCookieDomain")||n;if(r.Z.set(e,"set-in-isActiveSuperuser",{domain:t}),void 0===r.Z.get(e))return!0}return!1}},"./app/utils/teams.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s("../node_modules/react/index.js"),o=s("./app/utils/useTeams.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function n(e){let{children:t,...s}=e;const n=(0,o.Z)(s);return(0,a.tZ)(r.Fragment,{children:t(n)})}n.displayName="Teams";const i=n},"./app/utils/useApi.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s("../node_modules/react/index.js"),o=s("./app/api.tsx");const a=function(){let{persistInFlight:e,api:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=(0,r.useRef)();void 0===s.current&&void 0===t&&(s.current=new o.KU);const a=t??s.current,n=(0,r.useCallback)((()=>{e||a.clear()}),[a,e]);return(0,r.useEffect)((()=>n),[n]),a}},"./app/utils/useProjects.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>p}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/react/index.js"),o=s("../node_modules/lodash/uniqBy.js"),a=s.n(o),n=s("./app/stores/organizationStore.tsx"),i=s("./app/stores/projectsStore.tsx"),l=s("./app/stores/useLegacyStore.tsx"),d=s("./app/utils/parseLinkHeader.tsx"),c=s("./app/utils/useApi.tsx");async function u(e,t){let{slugs:s,search:r,limit:o,lastSearch:a,cursor:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={collapse:["latestDeploys"]};void 0!==s&&s.length>0&&(i.query=s.map((e=>`slug:${e}`)).join(" ")),r&&(i.query=`${i.query??""}${r}`.trim());const l=!a&&!r||a===r;l&&n&&(i.cursor=n),void 0!==o&&(i.per_page=o);let c=!1,u=null;const[p,,h]=await e.requestPromise(`/organizations/${t}/projects/`,{includeAllArgs:!0,query:i}),m=h?.getResponseHeader("Link");if(m){const e=(0,d.Z)(m);c=e?.next?.results||e?.previous?.results,u=e?.next?.cursor}return{results:p,hasMore:c,nextCursor:u}}const p=function(){let{limit:e,slugs:t,orgId:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=(0,c.Z)(),{organization:d}=(0,l.X)(n.Z),p=(0,l.X)(i.Z),h=s??d?.slug,m=new Set(p.projects.map((e=>e.slug))),g=t?.filter((e=>!m.has(e)))??[],f=g.length>0,[x,Z]=(0,r.useState)({initiallyLoaded:!p.loading&&!f,fetching:f,hasMore:null,lastSearch:null,nextCursor:null,fetchError:null}),y=(0,r.useRef)(null);async function j(){if(void 0!==h){Z({...x,fetching:!0});try{const{results:t,hasMore:s,nextCursor:r}=await u(o,h,{slugs:g,limit:e}),n=a()([...p.projects,...t],(e=>{let{slug:t}=e;return t}));i.Z.loadInitialData(n),Z({...x,hasMore:s,fetching:!1,initiallyLoaded:!0,nextCursor:r})}catch(e){console.error(e),Z({...x,fetching:!1,initiallyLoaded:!p.loading,fetchError:e})}}else console.error("Cannot use useProjects({slugs}) without an organization in context")}async function b(t){const{lastSearch:s}=x,r=x.nextCursor;if(""!==t)if(void 0!==h){Z({...x,fetching:!0});try{o.clear();const{results:n,hasMore:l,nextCursor:d}=await u(o,h,{search:t,limit:e,lastSearch:s,cursor:r}),c=a()([...p.projects,...n],(e=>{let{slug:t}=e;return t}));c.length>p.projects.length&&i.Z.loadInitialData(c),Z({...x,hasMore:l,fetching:!1,lastSearch:t,nextCursor:d})}catch(e){console.error(e),Z({...x,fetching:!1,fetchError:e})}}else console.error("Cannot use useProjects.onSearch without an organization in context")}void 0!==t&&(null===y.current&&(y.current=new Set(t)),(t.length!==y.current.size||t.some((e=>!y.current?.has(e))))&&(y.current=new Set(t))),(0,r.useEffect)((()=>{f&&j()}),[y.current]),(0,r.useEffect)((()=>{const e=!p.loading;x.initiallyLoaded!==e&&(f||Z({...x,initiallyLoaded:e}))}),[p.loading]);const{initiallyLoaded:v,fetching:w,fetchError:S,hasMore:C}=x,_=t?p.projects.filter((e=>t.includes(e.slug))):p.projects,I=g.map((e=>({slug:e}))),$={projects:_,placeholders:I,fetching:w||p.loading,initiallyLoaded:v,fetchError:S,hasMore:C,onSearch:b};return $}},"./app/utils/useTeams.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>m}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/react/index.js"),o=s("../node_modules/lodash/uniqBy.js"),a=s.n(o),n=s("./app/actionCreators/teams.tsx"),i=s("./app/stores/organizationStore.tsx"),l=s("./app/stores/teamStore.tsx"),d=s("./app/stores/useLegacyStore.tsx"),c=s("./app/utils/isActiveSuperuser.tsx"),u=s("./app/utils/parseLinkHeader.tsx"),p=s("./app/utils/useApi.tsx");async function h(e,t){let{slugs:s,ids:r,search:o,limit:a,lastSearch:n,cursor:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const l={};void 0!==s&&s.length>0&&(l.query=s.map((e=>`slug:${e}`)).join(" ")),void 0!==r&&r.length>0&&(l.query=r.map((e=>`id:${e}`)).join(" ")),o&&(l.query=`${l.query??""} ${o}`.trim());const d=n===o||!n&&!o;d&&i&&(l.cursor=i),void 0!==a&&(l.per_page=a);let c=!1,p=null;const[h,,m]=await e.requestPromise(`/organizations/${t}/teams/`,{includeAllArgs:!0,query:l}),g=m?.getResponseHeader("Link");if(g){const e=(0,u.Z)(g);c=e?.next?.results,p=e?.next?.cursor}return{results:h,hasMore:c,nextCursor:p}}const m=function(){let{limit:e,slugs:t,ids:s,provideUserTeams:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const u=(0,p.Z)(),{organization:m}=(0,d.X)(i.Z),g=(0,d.X)(l.Z),f=m?.slug,x=new Set(g.teams.map((e=>e.slug))),Z=t?.filter((e=>!x.has(e)))??[],y=new Set(g.teams.map((e=>e.id))),j=s?.filter((e=>!y.has(e)))??[],b=Z.length>0,v=j.length>0,w=o&&!g.loadedUserTeams,S=!b&&!w&&!v,[C,_]=(0,r.useState)({initiallyLoaded:S,fetching:!1,hasMore:g.hasMore,lastSearch:null,nextCursor:g.cursor,fetchError:null}),I=(0,r.useRef)(null);if(void 0!==t||void 0!==s){const e=(t||s)??[];null===I.current&&(I.current=new Set(e)),(e.length!==I.current.size||e.some((e=>!I.current?.has(e))))&&(I.current=new Set(e))}async function $(){if(void 0!==f){_({...C,fetching:!0});try{await(0,n.PX)(u,{orgId:f}),_({...C,fetching:!1,initiallyLoaded:!0})}catch(e){console.error(e),_({...C,fetching:!1,initiallyLoaded:!0,fetchError:e})}}}async function z(){if(void 0!==f){_({...C,fetching:!0});try{const{results:t,hasMore:s,nextCursor:r}=await h(u,f,{slugs:Z,ids:j,limit:e}),o=a()([...t,...g.teams],(e=>{let{id:t}=e;return t}));l.Z.loadInitialData(o),_({...C,hasMore:s,fetching:!1,initiallyLoaded:!0,nextCursor:r})}catch(e){console.error(e),_({...C,fetching:!1,initiallyLoaded:!0,fetchError:e})}}}function P(e){return""!==e?k(e):(C.hasMore===g.hasMore&&C.nextCursor===g.cursor||_({...C,lastSearch:e,hasMore:g.hasMore,nextCursor:g.cursor}),Promise.resolve())}async function k(t){const{lastSearch:s}=C,r=t?C.nextCursor:g.cursor;if(void 0!==f){_({...C,fetching:!0});try{u.clear();const{results:o,hasMore:n,nextCursor:i}=await h(u,f,{search:t,limit:e,lastSearch:s,cursor:r}),d=a()([...g.teams,...o],(e=>{let{slug:t}=e;return t}));t?d.length>g.teams.length&&l.Z.loadInitialData(d):l.Z.loadInitialData(d,n,i),_({...C,hasMore:n&&g.hasMore,fetching:!1,lastSearch:t??null,nextCursor:i})}catch(e){console.error(e),_({...C,fetching:!1,fetchError:e})}}else console.error("Cannot fetch teams without an organization in context")}(0,r.useEffect)((()=>{b||v?z():w&&$()}),[I.current,o]);const q=(0,c.M)(),U=(0,r.useMemo)((()=>t?g.teams.filter((e=>t.includes(e.slug))):s?g.teams.filter((e=>s.includes(e.id))):o&&!q?g.teams.filter((e=>e.isMember)):g.teams),[g.teams,s,t,o,q]),M={teams:U,fetching:C.fetching||g.loading,initiallyLoaded:C.initiallyLoaded,fetchError:C.fetchError,hasMore:C.hasMore??g.hasMore,onSearch:P,loadMore:k};return M}},"./app/utils/withApi.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var r=s("./app/utils/getDisplayName.tsx"),o=s("./app/utils/useApi.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=s=>{let{api:r,...n}=s;const i=(0,o.Z)({api:r,...t});return(0,a.tZ)(e,{...n,api:i})};return s.displayName=`withApi(${(0,r.Z)(e)})`,s}},"./app/utils/withProjects.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var r=s("./app/utils/getDisplayName.tsx"),o=s("./app/utils/useProjects.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const n=function(e){const t=t=>{const{projects:s,initiallyLoaded:r}=(0,o.Z)(),n=!r;return(0,a.tZ)(e,{...t,projects:s,loadingProjects:n})};return t.displayName=`withProjects(${(0,r.Z)(e)})`,t}},"./app/views/settings/project/projectOwnership/ownerInput.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>re});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=s("../node_modules/react/index.js"),n=s("./app/actionCreators/indicator.tsx"),i=s("./app/api.tsx"),l=s("./app/components/button.tsx"),d=s("./app/components/forms/controls/textarea.tsx"),c=s("./app/locale.tsx"),u=s("./app/stores/memberListStore.tsx"),p=s("./app/stores/projectsStore.tsx"),h=s("./app/utils.tsx"),m=s("./app/components/forms/controls/selectControl.tsx"),g=s("./app/components/input.tsx"),f=s("./app/components/tag.tsx"),x=s("./app/components/textOverflow.tsx"),Z=s("./app/icons/index.tsx"),y=s("./app/styles/space.tsx"),j=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react-dom/profiling.js")),b=s("../node_modules/lodash/debounce.js"),v=s.n(b),w=s("../node_modules/lodash/isEqual.js"),S=s.n(w),C=s("./app/actionCreators/projects.tsx"),_=s("./app/components/avatar/actorAvatar.tsx"),I=s("./app/components/idBadge/index.tsx"),$=s("./app/components/tooltip.tsx"),z=s("./app/stores/teamStore.tsx"),P=s("./app/utils/withApi.tsx"),k=s("./app/utils/withProjects.tsx"),q=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function U(e){let{data:t,removeProps:s}=e;return(0,q.tZ)(O,{onClick:s.onClick,children:(0,q.tZ)(_.Z,{actor:t.actor,size:28})})}U.displayName="ValueComponent";const M=e=>`${e.email&&e.email.toLowerCase()} ${e.name&&e.name.toLowerCase()}`;var T={name:"18ji2p4",styles:"width:300px"};class A extends a.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{loading:!1,inputValue:""}),(0,r.Z)(this,"selectRef",(0,a.createRef)()),(0,r.Z)(this,"renderUserBadge",(e=>(0,q.tZ)(I.Z,{avatarSize:24,user:e,hideEmail:!0,useLink:!1}))),(0,r.Z)(this,"createMentionableUser",(e=>({value:(0,h.Zh)(e.id),label:this.renderUserBadge(e),searchKey:M(e),actor:{type:"user",id:e.id,name:e.name}}))),(0,r.Z)(this,"createUnmentionableUser",(e=>{let{user:t}=e;return{...this.createMentionableUser(t),disabled:!0,label:(0,q.tZ)(L,{children:(0,q.tZ)($.ZP,{position:"left",title:(0,c.t)("%s is not a member of project",t.name||t.email),children:this.renderUserBadge(t)})})}})),(0,r.Z)(this,"createMentionableTeam",(e=>({value:(0,h.dZ)(e.id),label:(0,q.tZ)(I.Z,{team:e}),searchKey:`#${e.slug}`,actor:{type:"team",id:e.id,name:e.slug}}))),(0,r.Z)(this,"createUnmentionableTeam",(e=>{const{organization:t}=this.props,s=t.access.includes("project:write");return{...this.createMentionableTeam(e),disabled:!0,label:(0,q.BX)(E,{children:[(0,q.tZ)(L,{children:(0,q.tZ)($.ZP,{position:"left",title:(0,c.t)("%s is not a member of project",`#${e.slug}`),children:(0,q.tZ)(I.Z,{team:e})})}),(0,q.tZ)($.ZP,{title:s?(0,c.t)("Add %s to project",`#${e.slug}`):(0,c.t)("You do not have permission to add team to project."),children:(0,q.tZ)(B,{size:"zero",borderless:!0,disabled:!s,onClick:this.handleAddTeamToProject.bind(this,e),icon:(0,q.tZ)(Z.N_,{isCircled:!0}),"aria-label":(0,c.t)("Add %s to project",`#${e.slug}`)})})]})}})),(0,r.Z)(this,"handleChange",(e=>{this.props.onChange(e)})),(0,r.Z)(this,"handleInputChange",(e=>{this.setState({inputValue:e}),this.props.onInputChange&&this.props.onInputChange(e)})),(0,r.Z)(this,"queryMembers",v()(((e,t)=>{const{api:s,organization:r}=this.props;return s?s.requestPromise(`/organizations/${r.slug}/members/`,{query:{query:e}}).then((e=>t(null,e)),(e=>t(e))):null}),250)),(0,r.Z)(this,"handleLoadOptions",(()=>{const e=this.getMentionableUsers(),t=this.getMentionableTeams(),s=this.getTeamsNotInProject(t),r=e.map((e=>{let{actor:t}=e;return t.id}));return new Promise(((e,t)=>{this.queryMembers(this.state.inputValue,((s,r)=>{s?t(s):e(r)}))})).then((e=>e?e.filter((e=>{let{user:t}=e;return t&&-1===r.indexOf(t.id)})).map(this.createUnmentionableUser):[])).then((r=>[...e,...t,...s,...r]))}))}componentDidUpdate(e){S()(this.props.projects,e.projects)||this.closeSelectMenu()}getMentionableUsers(){return u.Z.getAll().map(this.createMentionableUser)}getMentionableTeams(){const{project:e}=this.props,t=p.Z.getBySlug(e.slug);return t?t.teams.map(this.createMentionableTeam):[]}getTeamsNotInProject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=z.Z.getAll()||[],s=e.map((e=>{let{actor:t}=e;return t.id}));return t.filter((e=>-1===s.indexOf(e.id))).map(this.createUnmentionableTeam)}closeSelectMenu(){if(this.selectRef.current){const e=(0,j.findDOMNode)(this.selectRef.current)?.querySelector(".Select-input input");e&&e.blur()}}async handleAddTeamToProject(e){const{api:t,organization:s,project:r,value:o}=this.props,a=[...o];this.props.onChange([...this.props.value,this.createMentionableTeam(e)]);try{await(0,C.Oe)(t,s.slug,r.slug,e)}catch(e){this.props.onChange(a),this.closeSelectMenu()}}render(){return(0,q.tZ)(m.Z,{multiple:!0,name:"owners",filterOption:(e,t)=>e.data.searchKey.indexOf(t)>-1,ref:this.selectRef,loadOptions:this.handleLoadOptions,defaultOptions:!0,async:!0,clearable:!0,disabled:this.props.disabled,cache:!1,"aria-label":(0,c.t)("Rule owner"),placeholder:(0,c.t)("Owners"),components:{MultiValue:U},onInputChange:this.handleInputChange,onChange:this.handleChange,value:this.props.value,css:T})}}A.displayName="SelectOwners";const N=(0,P.Z)((0,k.Z)(A)),E=(0,o.Z)("div",{target:"e19ageij3"})({name:"1eoy87d",styles:"display:flex;justify-content:space-between"}),L=(0,o.Z)("div",{target:"e19ageij2"})({name:"16ooxei",styles:"opacity:0.5;overflow:hidden"}),B=(0,o.Z)(l.zx,{target:"e19ageij1"})({name:"ozd7xs",styles:"flex-shrink:0"}),O=(0,o.Z)("a",{target:"e19ageij0"})("margin-right:",(0,y.Z)(.5),";"),R={text:"",tagName:"",type:"path",owners:[],isValid:!1};function D(e){switch(e){case"path":return"src/example/*";case"module":return"com.module.name.example";case"url":return"https://example.com/settings/*";case"tag":return"tag-value";default:return""}}class V extends a.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",R),(0,r.Z)(this,"checkIsValid",(()=>{this.setState((e=>({isValid:!!e.text&&e.owners&&!!e.owners.length})))})),(0,r.Z)(this,"handleTypeChange",(e=>{this.setState({type:e.value}),this.checkIsValid()})),(0,r.Z)(this,"handleTagNameChangeValue",(e=>{this.setState({tagName:e.target.value},this.checkIsValid)})),(0,r.Z)(this,"handleChangeValue",(e=>{this.setState({text:e.target.value}),this.checkIsValid()})),(0,r.Z)(this,"handleChangeOwners",(e=>{this.setState({owners:e}),this.checkIsValid()})),(0,r.Z)(this,"handleAddRule",(()=>{const{type:e,text:t,tagName:s,owners:r,isValid:o}=this.state;if(!o)return void(0,n.Iw)("A rule needs a type, a value, and one or more issue owners.");const a=r.map((e=>"team"===e.actor.type?`#${e.actor.name}`:u.Z.getById(e.actor.id)?.email)).join(" "),i=`${"tag"===e?`tags.${s}`:e}:${t.match(/\s/)?`"${t}"`:t} ${a}`;this.props.onAddRule(i),this.setState(R)})),(0,r.Z)(this,"handleSelectCandidate",((e,t)=>{this.setState({text:e,type:t}),this.checkIsValid()}))}render(){const{urls:e,paths:t,disabled:s,project:r,organization:o}=this.props,{type:n,text:i,tagName:d,owners:u,isValid:p}=this.state,h=t||e;return(0,q.BX)(a.Fragment,{children:[h&&(0,q.BX)(X,{children:[t.map((e=>(0,q.BX)(K,{role:"button","aria-label":(0,c.t)("Path rule candidate"),onClick:()=>this.handleSelectCandidate(e,"path"),children:[(0,q.tZ)(Z.N_,{color:"border",isCircled:!0}),(0,q.tZ)(x.Z,{children:e}),(0,q.tZ)(f.Z,{children:(0,c.t)("Path")})]},e))),e.map((e=>(0,q.BX)(K,{role:"button","aria-label":(0,c.t)("URL rule candidate"),onClick:()=>this.handleSelectCandidate(e,"url"),children:[(0,q.tZ)(Z.N_,{color:"border",isCircled:!0}),(0,q.tZ)(x.Z,{children:e}),(0,q.tZ)(f.Z,{children:(0,c.t)("URL")})]},e)))]}),(0,q.BX)(W,{children:[(0,q.tZ)(J,{"aria-label":(0,c.t)("Rule type"),name:"select-type",value:n,onChange:this.handleTypeChange,options:[{value:"path",label:(0,c.t)("Path")},{value:"module",label:(0,c.t)("Module")},{value:"tag",label:(0,c.t)("Tag")},{value:"url",label:(0,c.t)("URL")}],clearable:!1,disabled:s}),"tag"===n&&(0,q.tZ)(H,{value:d,onChange:this.handleTagNameChangeValue,disabled:s,placeholder:"tag-name"}),(0,q.tZ)(g.Z,{value:i,onChange:this.handleChangeValue,disabled:s,placeholder:D(n),"aria-label":(0,c.t)("Rule pattern")}),(0,q.tZ)(Z.g6,{color:"border",direction:"right"}),(0,q.tZ)(N,{organization:o,project:r,value:u,onChange:this.handleChangeOwners,disabled:s}),(0,q.tZ)(l.zx,{priority:"primary",disabled:!p,onClick:this.handleAddRule,icon:(0,q.tZ)(Z.N_,{isCircled:!0}),"aria-label":(0,c.t)("Add rule")})]})]})}}V.displayName="RuleBuilder";const X=(0,o.Z)("div",{target:"e1is8ybq4"})({name:"pr10xp",styles:"margin-bottom:10px"}),K=(0,o.Z)("div",{target:"e1is8ybq3"})("font-family:",(e=>e.theme.text.familyMono),";border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";background-color:",(e=>e.theme.background),";padding:",(0,y.Z)(.25)," ",(0,y.Z)(.5),";margin-bottom:",(0,y.Z)(.5),";cursor:pointer;overflow:hidden;display:flex;gap:",(0,y.Z)(.5),";align-items:center;"),W=(0,o.Z)("div",{target:"e1is8ybq2"})("display:flex;gap:",(0,y.Z)(1),";align-items:center;margin-bottom:",(0,y.Z)(2),";"),J=(0,o.Z)(m.Z,{target:"e1is8ybq1"})({name:"1jmh35g",styles:"width:140px;flex-shrink:0"}),H=(0,o.Z)(g.Z,{target:"e1is8ybq0"})({name:"833hqy",styles:"width:200px"}),F=V;class Y extends a.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{hasChanges:!1,text:null,error:null}),(0,r.Z)(this,"handleUpdateOwnership",(()=>{const{organization:e,project:t,onSave:s}=this.props,{text:r}=this.state;this.setState({error:null});const o=(new i.KU).requestPromise(`/projects/${e.slug}/${t.slug}/ownership/`,{method:"PUT",data:{raw:r||""}});return o.then((()=>{(0,n.S9)((0,c.t)("Updated issue ownership rules")),this.setState({hasChanges:!1,text:r},(()=>s&&s(r)))})).catch((e=>{this.setState({error:e.responseJSON}),403===e.status?(0,n.Iw)((0,c.t)("You don't have permission to modify issue ownership rules for this project")):400===e.status&&e.responseJSON.raw&&e.responseJSON.raw[0].startsWith("Invalid rule owners:")?(0,n.Iw)((0,c.t)("Unable to save issue ownership rule changes: %s",e.responseJSON.raw[0])):(0,n.Iw)((0,c.t)("Unable to save issue ownership rule changes"))})),o})),(0,r.Z)(this,"handleChange",(e=>{this.setState({hasChanges:!0,text:e.target.value})})),(0,r.Z)(this,"handleAddRule",(e=>{const{initialText:t}=this.props;this.setState((s=>{let{text:r}=s;return{text:(r||t)+"\n"+e}}),this.handleUpdateOwnership)}))}parseError(e){const t=e?.raw?.[0];return t?t.startsWith("Invalid rule owners:")?(0,q.tZ)(se,{children:t}):(0,q.tZ)(Q,{line:parseInt(t.match(/line (\d*),/)?.[1]??"",10)-1}):null}mentionableUsers(){return u.Z.getAll().map((e=>({id:e.id,display:e.email,email:e.email})))}mentionableTeams(){const{project:e}=this.props,t=p.Z.getBySlug(e.slug);return t?t.teams.map((e=>({id:e.id,display:`#${e.slug}`,email:e.id}))):[]}render(){const{project:e,organization:t,disabled:s,urls:r,paths:o,initialText:n}=this.props,{hasChanges:i,text:d,error:u}=this.state;return(0,q.BX)(a.Fragment,{children:[(0,q.tZ)(F,{urls:r,paths:o,organization:t,project:e,onAddRule:this.handleAddRule.bind(this),disabled:s}),(0,q.BX)("div",{style:{position:"relative"},onKeyDown:e=>{e.metaKey&&"Enter"===e.key&&this.handleUpdateOwnership()},children:[(0,q.tZ)(te,{"aria-label":(0,c.t)("Ownership Rules"),placeholder:"#example usage\npath:src/example/pipeline/* person@sentry.io #infra\nmodule:com.module.name.example #sdks\nurl:http://example.com/settings/* #product\ntags.sku_class:enterprise #enterprise",autosize:!0,monospace:!0,onChange:this.handleChange,disabled:s,value:(0,h.ri)(d)?d:n,spellCheck:"false",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"}),(0,q.BX)(G,{children:[(0,q.tZ)("div",{children:this.parseError(u)}),(0,q.tZ)(ee,{children:(0,q.tZ)(l.zx,{size:"sm",priority:"primary",onClick:this.handleUpdateOwnership,disabled:s||!i,children:(0,c.t)("Save Changes")})})]})]})]})}}Y.displayName="OwnerInput",(0,r.Z)(Y,"defaultProps",{urls:[],paths:[],disabled:!1});const G=(0,o.Z)("div",{target:"eqgg5e94"})({name:"bcffy2",styles:"display:flex;align-items:center;justify-content:space-between"}),Q=(0,o.Z)("div",{target:"eqgg5e93"})("position:absolute;top:",(e=>{let{line:t}=e;return 4+24*t+1}),"px;width:100%;height:",24,"px;background-color:",(e=>e.theme.error),";opacity:0.1;pointer-events:none;"),ee=(0,o.Z)("div",{target:"eqgg5e92"})({name:"1cw129c",styles:"text-align:end;padding-top:10px"}),te=(0,o.Z)(d.Z,{target:"eqgg5e91"})("min-height:140px;overflow:auto;outline:0;width:100%;resize:none;margin:0;word-break:break-all;white-space:pre-wrap;padding-top:",4,"px;line-height:",24,"px;"),se=(0,o.Z)("div",{target:"eqgg5e90"})("color:",(e=>e.theme.error),";font-weight:bold;margin-top:12px;"),re=Y},"../node_modules/lodash/_arrayIncludes.js":(e,t,s)=>{var r=s("../node_modules/lodash/_baseIndexOf.js");e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},"../node_modules/lodash/_arrayIncludesWith.js":e=>{e.exports=function(e,t,s){for(var r=-1,o=null==e?0:e.length;++r<o;)if(s(t,e[r]))return!0;return!1}},"../node_modules/lodash/_baseUniq.js":(e,t,s)=>{var r=s("../node_modules/lodash/_SetCache.js"),o=s("../node_modules/lodash/_arrayIncludes.js"),a=s("../node_modules/lodash/_arrayIncludesWith.js"),n=s("../node_modules/lodash/_cacheHas.js"),i=s("../node_modules/lodash/_createSet.js"),l=s("../node_modules/lodash/_setToArray.js");e.exports=function(e,t,s){var d=-1,c=o,u=e.length,p=!0,h=[],m=h;if(s)p=!1,c=a;else if(u>=200){var g=t?null:i(e);if(g)return l(g);p=!1,c=n,m=new r}else m=t?[]:h;e:for(;++d<u;){var f=e[d],x=t?t(f):f;if(f=s||0!==f?f:0,p&&x==x){for(var Z=m.length;Z--;)if(m[Z]===x)continue e;t&&m.push(x),h.push(f)}else c(m,x,s)||(m!==h&&m.push(x),h.push(f))}return h}},"../node_modules/lodash/_createSet.js":(e,t,s)=>{var r=s("../node_modules/lodash/_Set.js"),o=s("../node_modules/lodash/noop.js"),a=s("../node_modules/lodash/_setToArray.js"),n=r&&1/a(new r([,-0]))[1]==1/0?function(e){return new r(e)}:o;e.exports=n},"../node_modules/lodash/chunk.js":(e,t,s)=>{var r=s("../node_modules/lodash/_baseSlice.js"),o=s("../node_modules/lodash/_isIterateeCall.js"),a=s("../node_modules/lodash/toInteger.js"),n=Math.ceil,i=Math.max;e.exports=function(e,t,s){t=(s?o(e,t,s):void 0===t)?1:i(a(t),0);var l=null==e?0:e.length;if(!l||t<1)return[];for(var d=0,c=0,u=Array(n(l/t));d<l;)u[c++]=r(e,d,d+=t);return u}},"../node_modules/lodash/noop.js":e=>{e.exports=function(){}},"../node_modules/lodash/uniqBy.js":(e,t,s)=>{var r=s("../node_modules/lodash/_baseIteratee.js"),o=s("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t){return e&&e.length?o(e,r(t,2)):[]}}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_projectOwnership_ownerInput_tsx.c29f8853121c1166cd4fb8b47a14adb7.js.map