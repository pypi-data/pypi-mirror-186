"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_project_projectSettingsLayout_tsx"],{"./app/components/projects/appStoreConnectContext.tsx":(e,t,s)=>{s.d(t,{Z:()=>p,z:()=>c});var o=s("../node_modules/react/index.js"),r=s("./app/utils/appStoreValidationErrorMessage.tsx"),n=s("./app/utils/useApi.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,o.createContext)(void 0),c=e=>{let{children:t,project:s,organization:c}=e;const p=(0,n.Z)(),[l,d]=(0,o.useState)(),[u,m]=(0,o.useState)(void 0),h=(0,o.useMemo)((()=>(l?.symbolSources?JSON.parse(l.symbolSources):[]).reduce(((e,t)=>{let{type:s,id:o,...r}=t;return"appstoreconnect"===s.toLowerCase()&&(e[o]={type:s,...r}),e}),{})),[l?.symbolSources]);function g(e,t){if("valid"!==t?.status)return(0,r.e)(t,e)}return(0,o.useEffect)((()=>{if(!s||l)return;if(s.symbolSources)return void d(s);let e=!1;return p.requestPromise(`/projects/${c.slug}/${s.slug}/`).then((t=>{e||d(t)})).catch((()=>{})),()=>{e=!0}}),[s,c,p]),(0,o.useEffect)((()=>{if(!l)return;if(!Object.keys(h).length)return;let e=!1;return p.requestPromise(`/projects/${c.slug}/${l.slug}/appstoreconnect/status/`).then((t=>{e||m(t)})).catch((()=>{})),()=>{e=!0}}),[l,c,h,p]),(0,i.tZ)(a.Provider,{value:u&&s?Object.keys(u).reduce(((e,t)=>{const o=u[t];return{...e,[t]:{...o,updateAlertMessage:g({name:h[t].name,link:`/settings/${c.slug}/projects/${s.slug}/debug-symbols/?customRepository=${t}`},o.credentials)}}}),{}):void 0,children:t})};c.displayName="Provider";const p=a},"./app/components/projects/missingProjectMembership.tsx":(e,t,s)=>{s.d(t,{Z:()=>v});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),i=s("./app/actionCreators/indicator.tsx"),a=s("./app/actionCreators/teams.tsx"),c=s("./app/components/button.tsx"),p=s("./app/components/emptyMessage.tsx"),l=s("./app/components/forms/controls/selectControl.tsx"),d=s("./app/components/panels/index.tsx"),u=s("./app/icons/index.tsx"),m=s("./app/locale.tsx"),h=s("./app/stores/teamStore.tsx"),g=s("./app/styles/space.tsx"),j=s("./app/utils/withApi.tsx"),y=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class x extends n.Component{constructor(){super(...arguments),(0,o.Z)(this,"state",{loading:!1,error:!1,project:this.props.project,team:""}),(0,o.Z)(this,"getPendingTeamOption",(e=>({value:e,label:(0,y.tZ)(S,{children:`#${e}`})})))}joinTeam(e){this.setState({loading:!0}),(0,a.um)(this.props.api,{orgId:this.props.organization.slug,teamId:e},{success:()=>{this.setState({loading:!1,error:!1}),(0,i.S9)((0,m.t)("Request to join team sent."))},error:()=>{this.setState({loading:!1,error:!0}),(0,i.Iw)((0,m.t)("There was an error while trying to request access."))}})}renderJoinTeam(e,t){const s=h.Z.getBySlug(e);return s?this.state.loading?t.has("open-membership")?(0,y.tZ)(c.zx,{busy:!0,children:(0,m.t)("Join Team")}):(0,y.tZ)(c.zx,{busy:!0,children:(0,m.t)("Request Access")}):s?.isPending?(0,y.tZ)(c.zx,{disabled:!0,children:(0,m.t)("Request Pending")}):t.has("open-membership")?(0,y.tZ)(c.zx,{priority:"primary",onClick:this.joinTeam.bind(this,e),children:(0,m.t)("Join Team")}):(0,y.tZ)(c.zx,{priority:"primary",onClick:this.joinTeam.bind(this,e),children:(0,m.t)("Request Access")}):null}getTeamsForAccess(){const e=[],t=[];return(this.state.project?.teams??[]).forEach((s=>{let{slug:o}=s;const r=h.Z.getBySlug(o);r&&(r.isPending?t.push(r.slug):e.push(r.slug))})),[e,t]}render(){const{organization:e}=this.props,t=this.state.team,s=this.state.project?.teams??[],o=new Set(e.features),r=[{label:(0,m.t)("Request Access"),options:this.getTeamsForAccess()[0].map((e=>({value:e,label:`#${e}`})))},{label:(0,m.t)("Pending Requests"),options:this.getTeamsForAccess()[1].map((e=>this.getPendingTeamOption(e)))}];return(0,y.tZ)(Z,{children:s.length?(0,y.tZ)(p.Z,{icon:(0,y.tZ)(u.Gy,{size:"xl"}),title:(0,m.t)("You're not a member of this project."),description:(0,m.t)("You'll need to join a team with access before you can view this data."),action:(0,y.BX)(b,{children:[(0,y.tZ)(f,{name:"select",placeholder:(0,m.t)("Select a Team"),options:r,onChange:e=>{const t=e?e.value:null;this.setState({team:t})}}),t?this.renderJoinTeam(t,o):(0,y.tZ)(c.zx,{disabled:!0,children:(0,m.t)("Select a Team")})]})}):(0,y.tZ)(p.Z,{icon:(0,y.tZ)(u.Gy,{size:"xl"}),children:(0,m.t)("No teams have access to this project yet. Ask an admin to add your team to this project.")})})}}x.displayName="MissingProjectMembership";const Z=(0,r.Z)(d.s_,{target:"e18d2ymg3"})("margin:",(0,g.Z)(2)," 0;"),b=(0,r.Z)("div",{target:"e18d2ymg2"})("display:grid;grid-auto-flow:column;gap:",(0,g.Z)(2),";text-align:left;"),f=(0,r.Z)(l.Z,{target:"e18d2ymg1"})({name:"xu0q36",styles:"width:250px"}),S=(0,r.Z)("div",{target:"e18d2ymg0"})({name:"v6ye5b",styles:"display:flex;opacity:0.5;overflow:hidden"}),v=(0,j.Z)(x)},"./app/utils/appStoreValidationErrorMessage.tsx":(e,t,s)=>{s.d(t,{O:()=>a,e:()=>c}),s("../node_modules/core-js/modules/es.error.cause.js");var o=s("../node_modules/@sentry/core/esm/exports.js"),r=s("./app/components/links/link.tsx"),n=s("./app/locale.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,n.t)("An unexpected error occurred while configuring the App Store Connect integration");function c(e,t){switch(e.code){case"app-connect-authentication-error":return t?(0,n._N)("App Store Connect credentials are invalid or missing. [linkToCustomRepository]",{linkToCustomRepository:(0,i.tZ)(r.Z,{to:t.link,children:(0,n._N)("Make sure the credentials of the '[customRepositoryName]' repository are correct and exist.",{customRepositoryName:t.name})})}):(0,n.t)("The supplied App Store Connect credentials are invalid or missing.");case"app-connect-forbidden-error":return(0,n.t)("The supplied API key does not have sufficient permissions.");case"app-connect-multiple-sources-error":return(0,n.t)("Only one App Store Connect application is allowed in this project.");default:return o.Tb(new Error("Unknown app store connect error.")),a}}},"./app/views/settings/project/projectSettingsLayout.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>A});var o,r=s("../node_modules/react/index.js"),n=s("./app/components/projects/appStoreConnectContext.tsx"),i=s("./app/utils/routeAnalytics/useRouteAnalyticsParams.tsx"),a=s("./app/utils/withOrganization.tsx"),c=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),p=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),l=s("../node_modules/react-document-title/index.js"),d=s.n(l),u=s("./app/actionCreators/members.tsx"),m=s("./app/actionCreators/projects.tsx"),h=s("./app/components/loadingError.tsx"),g=s("./app/components/loadingIndicator.tsx"),j=s("./app/components/projects/missingProjectMembership.tsx"),y=s("./app/locale.tsx"),x=s("./app/sentryTypes.tsx"),Z=s("./app/stores/memberListStore.tsx"),b=s("./app/stores/projectsStore.tsx"),f=s("./app/styles/space.tsx"),S=s("./app/utils/withApi.tsx"),v=s("./app/utils/withProjects.tsx"),T=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");!function(e){e.MISSING_MEMBERSHIP="MISSING_MEMBERSHIP",e.PROJECT_NOT_FOUND="PROJECT_NOT_FOUND",e.UNKNOWN="UNKNOWN"}(o||(o={}));class w extends r.Component{constructor(){super(...arguments),(0,c.Z)(this,"state",this.getInitialState()),(0,c.Z)(this,"docTitleRef",(0,r.createRef)()),(0,c.Z)(this,"unsubscribeProjects",b.Z.listen((e=>this.onProjectChange(e)),void 0)),(0,c.Z)(this,"unsubscribeMembers",Z.Z.listen((e=>this.setState({memberList:e})),void 0))}getInitialState(){return{loading:!0,error:!1,errorType:null,memberList:[],project:null}}getChildContext(){return{project:this.state.project}}componentDidMount(){const{loadingProjects:e}=this.props;e||this.fetchData()}componentWillReceiveProps(e){e.projectId!==this.props.projectId&&(e.skipReload||this.remountComponent())}componentDidUpdate(e,t){if(e.projectId!==this.props.projectId&&this.fetchData(),e.projects.length!==this.props.projects.length&&this.fetchData(),t.project!==this.state.project){const e=this.docTitleRef.current;if(!e)return;e.forceUpdate()}}componentWillUnmount(){this.unsubscribeMembers(),this.unsubscribeProjects()}remountComponent(){this.setState(this.getInitialState())}getTitle(){return this.state.project?.slug??"Sentry"}onProjectChange(e){this.state.project&&e.has(this.state.project.id)&&this.setState({project:{...b.Z.getById(this.state.project.id)}})}identifyProject(){const{projects:e,projectId:t}=this.props,s=t;return e.find((e=>{let{slug:t}=e;return t===s}))||null}async fetchData(){const{orgId:e,projectId:t,skipReload:s}=this.props,r=this.identifyProject(),n=r&&r.hasAccess;if(this.setState((e=>({loading:!s||e.loading,project:r}))),r&&n){(0,m.pK)(null);const s=this.props.api.requestPromise(`/projects/${e}/${t}/`);try{const e=await s;this.setState({loading:!1,project:e,error:!1,errorType:null}),(0,m.pK)(e)}catch(e){this.setState({loading:!1,error:!1,errorType:o.UNKNOWN})}(0,u.MA)(this.props.api,e,[r.id])}else if(!r||r.isMember)try{await this.props.api.requestPromise(`/projects/${e}/${t}/`)}catch(e){this.setState({loading:!1,error:!0,errorType:o.PROJECT_NOT_FOUND})}else this.setState({loading:!1,error:!0,errorType:o.MISSING_MEMBERSHIP})}renderBody(){const{children:e,organization:t}=this.props,{error:s,errorType:r,loading:n,project:i}=this.state;if(n)return(0,T.tZ)("div",{className:"loading-full-layout",children:(0,T.tZ)(g.Z,{})});if(!s&&i)return"function"==typeof e?e({project:i}):e;switch(r){case o.PROJECT_NOT_FOUND:return(0,T.tZ)("div",{className:"container",children:(0,T.tZ)("div",{className:"alert alert-block",style:{margin:"30px 0 10px"},children:(0,y.t)("The project you were looking for was not found.")})});case o.MISSING_MEMBERSHIP:return(0,T.tZ)(N,{children:(0,T.tZ)(j.Z,{organization:t,project:i})});default:return(0,T.tZ)(h.Z,{onRetry:this.remountComponent})}}render(){return(0,T.tZ)(d(),{ref:this.docTitleRef,title:this.getTitle(),children:this.renderBody()})}}w.displayName="ProjectContext",(0,c.Z)(w,"childContextTypes",{project:x.Z.Project});const P=(0,S.Z)((0,a.Z)((0,v.Z)(w))),N=(0,p.Z)("div",{target:"e11jq8dm0"})("width:100%;margin:",(0,f.Z)(2)," ",(0,f.Z)(4),";");var C=s("./app/views/settings/components/settingsLayout.tsx"),_=s("./app/utils/withProject.tsx"),I=s("./app/views/settings/components/settingsNavigation.tsx"),R=s("./app/views/settings/project/navigationConfiguration.tsx");const M=e=>{let{organization:t,project:s}=e;const o=(0,r.useContext)(n.Z),i=!!o&&Object.keys(o).some((e=>"invalid"===o[e].credentials.status));return(0,T.tZ)(I.Z,{navigationObjects:(0,R.Z)({project:s,organization:t,debugFilesNeedsReview:i}),access:new Set(t.access),features:new Set(t.features),organization:t,project:s})};M.displayName="ProjectSettingsNavigation";const z=(0,_.Z)(M);function O(e){let{params:t,routes:s,project:o,organization:a,children:c,...p}=e;return(0,i.Z)({project_id:o.id,project_platform:o.platform}),(0,T.tZ)(n.z,{project:o,organization:a,children:(0,T.tZ)(C.Z,{params:t,routes:s,...p,renderNavigation:()=>(0,T.tZ)(z,{organization:a}),children:c&&(0,r.isValidElement)(c)?(0,r.cloneElement)(c,{organization:a,project:o}):c})})}function k(e){let{organization:t,params:s,...o}=e;return(0,T.tZ)(P,{orgId:t.slug,projectId:s.projectId,children:e=>{let{project:r}=e;return(0,T.tZ)(O,{params:s,project:r,organization:t,...o})}})}O.displayName="InnerProjectSettingsLayout",k.displayName="ProjectSettingsLayout";const A=(0,a.Z)(k)}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_projectSettingsLayout_tsx.d335acfc09fe71e7305e9eacad2f3826.js.map