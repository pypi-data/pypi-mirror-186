"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_profiling_profileSummary_content_tsx"],{"./app/views/profiling/profileSummary/content.tsx":(e,t,o)=>{o.d(t,{J:()=>$,H:()=>I});var r=o("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(o("../node_modules/core-js/modules/es.array.push.js"),o("../node_modules/core-js/modules/es.array.includes.js"),o("../node_modules/react/index.js")),n=o("../node_modules/react-router/es/index.js"),a=o("./app/components/compactSelect.tsx"),i=o("./app/components/layouts/thirds.tsx"),l=o("./app/components/pagination.tsx"),u=(o("../node_modules/core-js/modules/es.array.unshift.js"),o("./app/components/count.tsx")),c=o("./app/components/gridEditable/index.tsx"),p=o("./app/components/performanceDuration.tsx"),d=o("./app/locale.tsx"),m=o("./app/styles/space.tsx"),f=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function g(e){let{items:t}=e;const[o,r]=(0,s.useState)(!1),n=t[0];return(0,f.BX)(h,{expanded:o,children:[n&&(0,f.tZ)(y,{item:n}),t.length>1&&o&&t.slice(1,t.length).map((e=>(0,f.tZ)(y,{item:e},e.value))),t.length>1?(0,f.tZ)(x,{children:(0,f.tZ)("button",{onClick:()=>r(!o),children:o?(0,d.t)("[collapse]"):(0,d.t)("[+%s more]",t.length-1)})}):null]})}function y(e){let{item:t}=e;return(0,f.tZ)(k,{children:(0,f.tZ)(n.Link,{to:t.target,children:t.value})})}g.displayName="ArrayLinks",y.displayName="LinkedItem";const h=(0,r.Z)("div",{target:"e153a8kj2"})("display:flex;flex-direction:",(e=>e.expanded?"column":"row"),";"),k=(0,r.Z)("span",{target:"e153a8kj1"})("flex-shrink:1;display:block;",(e=>e.theme.overflowEllipsis),";width:unset;"),x=(0,r.Z)("div",{target:"e153a8kj0"})("white-space:nowrap;& button{background:none;border:0;outline:none;padding:0;cursor:pointer;color:",(e=>e.theme.linkColor),";margin-left:",(0,m.Z)(.5),";}");var v=o("./app/utils/discover/styles.tsx"),Z=o("./app/utils/events.tsx"),b=o("./app/utils/profiling/routes.tsx"),w=o("./app/utils/profiling/tableRenderer.tsx"),j=o("./app/utils/useLocation.tsx"),q=o("./app/utils/useOrganization.tsx");function S(e){const t=(0,j.T)(),o=(0,q.Z)(),r=(0,s.useMemo)((()=>{let t=e.sort,o="asc";return e.sort.startsWith("-")&&(t=e.sort.substring(1),o="desc"),P.has(t)||(t="p99"),{key:t,order:o}}),[e.sort]),n=(0,s.useMemo)((()=>e.functions.map((t=>{const{worst:r,examples:s,...n}=t,a=s.filter((e=>e!==r));return a.unshift(r),{...n,examples:a.map((r=>{const s=r.replaceAll("-","");return{value:(0,Z.XQ)(s),target:(0,b.TH)({orgSlug:o.slug,projectSlug:e.project.slug,profileId:s,query:{frameName:t.name,framePackage:t.package}})}}))}}))),[o.slug,e.project.slug,e.functions]),a=(0,s.useCallback)((e=>{if(!P.has(e))return()=>{};const o=r.key!==e?"desc":"desc"===r.order?"asc":"desc";return()=>({...t,query:{...t.query,functionsSort:`${"desc"===o?"-":""}${e}`}})}),[t,r]);return(0,f.tZ)(c.ZP,{isLoading:e.isLoading,error:e.error,data:n,columnOrder:_.map((e=>H[e])),columnSortBy:[],grid:{renderHeadCell:(0,w.w)({currentSort:r,rightAlignedColumns:C,sortableColumns:P,generateSortLink:a}),renderBodyCell:T},location:t})}S.displayName="FunctionsTable";const C=new Set(["p75","p99","count"]),P=C;function T(e,t,o,r){return(0,f.tZ)(L,{column:e,dataRow:t,rowIndex:o,columnIndex:r})}T.displayName="renderFunctionsTableCell";const z=(0,r.Z)("span",{target:"e3z67dv0"})("color:",(e=>e.theme.gray300),";");function L(e){let{column:t,dataRow:o}=e;const r=o[t.key];switch(t.key){case"count":return(0,f.tZ)(v.Hw,{children:(0,f.tZ)(u.Z,{value:r})});case"p75":case"p99":return(0,f.tZ)(v.Hw,{children:(0,f.tZ)(p.Z,{nanoseconds:r,abbreviation:!0})});case"examples":return(0,f.tZ)(g,{items:r});case"name":case"package":const e=r||(0,f.tZ)(z,{children:(0,d.t)("Unknown")});return(0,f.tZ)(v.W2,{children:e});default:return(0,f.tZ)(v.W2,{children:r})}}const _=["name","package","count","p75","p99","examples"],H={name:{key:"name",name:(0,d.t)("Name"),width:c.z7},package:{key:"package",name:(0,d.t)("Package"),width:c.z7},path:{key:"path",name:(0,d.t)("Path"),width:c.z7},p75:{key:"p75",name:(0,d.t)("P75 Total Duration"),width:c.z7},p99:{key:"p99",name:(0,d.t)("P99 Total Duration"),width:c.z7},count:{key:"count",name:(0,d.t)("Total Occurrences"),width:c.z7},examples:{key:"examples",name:(0,d.t)("Example Profiles"),width:c.z7}};var A=o("./app/components/profiling/profileEventsTable.tsx"),E=o("./app/data/platformCategories.tsx"),F=o("../node_modules/@sentry/core/esm/exports.js"),M=o("./app/components/organizations/pageFilters/parse.tsx"),N=o("./app/utils/tokenizeSearch.tsx"),B=o("./app/utils/useApi.tsx");var R=o("./app/utils/profiling/hooks/useProfileEvents.tsx"),X=o("./app/utils/queryString.tsx");function $(e){const t=(0,s.useMemo)((()=>I(e.project.platform)),[e.project]),o=(0,s.useMemo)((()=>(0,X.ro)(e.location.query.cursor)),[e.location.query.cursor]),r=(0,s.useMemo)((()=>(0,X.ro)(e.location.query.functionsCursor)),[e.location.query.functionsCursor]),l=(0,s.useMemo)((()=>(0,X.ro)(e.location.query.functionsSort,"-p99")),[e.location.query.functionsSort]),u=(0,R.kq)((0,X.ro)(e.location.query.sort),t,{key:"timestamp",order:"desc"}),c=(0,R.GP)({cursor:o,fields:t,query:e.query,sort:u,limit:5,referrer:"api.profiling.profile-summary-table"}),[p,m]=(0,s.useState)("application"),g=function(e){let{functionType:t,project:o,query:r,transaction:n,sort:a,cursor:i,selection:l}=e;const u=(0,B.Z)(),c=(0,q.Z)(),[p,m]=(0,s.useState)({type:"initial"});return(0,s.useEffect)((()=>{if(void 0!==l)return m({type:"loading"}),function(e,t,o){let{cursor:r,functionType:s,projectSlug:n,query:a,selection:i,sort:l,transaction:u}=o;const c=new N.MY(a);return c.setFilterValues("transaction_name",[u]),e.requestPromise(`/projects/${t.slug}/${n}/profiling/functions/`,{method:"GET",includeAllArgs:!0,query:{cursor:r,environment:i.environments,...(0,M.fK)(i.datetime),query:c.formatString(),sort:l,is_application:"application"===s?"1":"system"===s?"0":void 0}})}(u,c,{functionType:t,projectSlug:o.slug,query:r,selection:l,sort:a,transaction:n,cursor:i}).then((e=>{let[t,,o]=e;m({type:"resolved",data:{functions:t.functions??[],pageLinks:o?.getResponseHeader("Link")??null}})})).catch((e=>{m({type:"errored",error:(0,d.t)("Error: Unable to load functions")}),F.Tb(e)})),()=>u.clear()}),[u,i,t,c,o.slug,r,l,a,n]),p}({cursor:r,project:e.project,query:"",selection:e.selection,transaction:e.transaction,sort:l,functionType:p}),y=(0,s.useCallback)(((e,t,o)=>{n.browserHistory.push({pathname:t,query:{...o,functionsCursor:e}})}),[]),h=(0,s.useCallback)((t=>{n.browserHistory.push({...e.location,query:{...e.location.query,cursor:void 0,sort:t}})}),[e.location]);return(0,f.BX)(i.or,{fullWidth:!0,children:[(0,f.BX)(U,{children:[(0,f.tZ)(a.Z,{triggerProps:{prefix:(0,d.t)("Filter"),size:"xs"},value:"asc"===u.order?u.key:`-${u.key}`,options:O,onChange:e=>h(e.value)}),(0,f.tZ)(G,{pageLinks:"success"===c.status?c.data?.[2]?.getResponseHeader("Link")??null:null,size:"xs"})]}),(0,f.tZ)(A.Q,{columns:t,data:"success"===c.status?c.data[0]:null,error:"error"===c.status?(0,d.t)("Unable to load profiles"):null,isLoading:"loading"===c.status,sort:u}),(0,f.BX)(U,{children:[(0,f.tZ)(a.Z,{triggerProps:{prefix:(0,d.t)("Suspect Functions"),size:"xs"},value:p,options:[{label:(0,d.t)("All"),value:"all"},{label:(0,d.t)("Application"),value:"application"},{label:(0,d.t)("System"),value:"system"}],onChange:e=>{let{value:t}=e;return m(t)}}),(0,f.tZ)(G,{pageLinks:"resolved"===g.type?g.data.pageLinks:null,onCursor:y,size:"xs"})]}),(0,f.tZ)(S,{error:"errored"===g.type?g.error:null,isLoading:"initial"===g.type||"loading"===g.type,functions:"resolved"===g.type?g.data.functions:[],project:e.project,sort:l})]})}function I(e){return E.ai.includes(e)?W:D}$.displayName="ProfileSummaryContent";const W=["id","timestamp","release","device.model","device.classification","device.arch","profile.duration"],D=["id","timestamp","release","device.arch","profile.duration"],O=[{label:(0,d.t)("Recent Profiles"),value:"-timestamp"},{label:(0,d.t)("Slowest Profiles"),value:"-profile.duration"},{label:(0,d.t)("Fastest Profiles"),value:"profile.duration"}],U=(0,r.Z)("div",{target:"etsf1iv1"})("display:flex;justify-content:space-between;margin-bottom:",(0,m.Z)(1),";"),G=(0,r.Z)(l.Z,{target:"etsf1iv0"})("margin:0 0 0 ",(0,m.Z)(1),";")}}]);
//# sourceMappingURL=../sourcemaps/app_views_profiling_profileSummary_content_tsx.854419a020bb34a6fb2875e936d2033d.js.map