"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationMembers_organizationMemberDetail_tsx"],{"./app/utils/isMemberDisabledFromLimit.tsx":(e,t,i)=>{function s(e){return e?.flags["member-limit:restricted"]??!1}i.d(t,{Z:()=>s})},"./app/views/settings/organizationMembers/organizationMemberDetail.tsx":(e,t,i)=>{i.r(t),i.d(t,{default:()=>V});var s=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(i("../node_modules/core-js/modules/es.array.includes.js"),i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/core-js/modules/es.regexp.flags.js"),i("../node_modules/react/index.js")),a=i("../node_modules/react-router/es/index.js"),o=i("../node_modules/@sentry/core/esm/exports.js"),d=i("./app/actionCreators/account.tsx"),l=i("./app/actionCreators/indicator.tsx"),m=i("./app/actionCreators/members.tsx"),c=i("./app/components/button.tsx"),h=i("./app/components/confirm.tsx"),p=i("./app/components/dateTime.tsx"),u=i("./app/components/errors/notFound.tsx"),g=i("./app/components/forms/fieldGroup/index.tsx"),b=i("./app/components/hookOrDefault.tsx"),Z=i("./app/components/links/externalLink.tsx"),f=i("./app/components/panels/index.tsx"),v=i("./app/components/textCopyInput.tsx"),x=i("./app/components/tooltip.tsx"),w=i("./app/locale.tsx"),y=i("./app/stores/configStore.tsx"),S=i("./app/styles/space.tsx"),z=i("./app/utils/isMemberDisabledFromLimit.tsx"),R=i("./app/utils/recreateRoute.tsx"),k=i("./app/utils/teams.tsx"),j=i("./app/utils/withDomainRequired.tsx"),B=i("./app/utils/withOrganization.tsx"),C=i("./app/views/asyncView.tsx"),I=i("./app/views/settings/components/settingsPageHeader.tsx"),_=i("./app/views/settings/components/teamSelect.tsx"),T=i("./app/components/radio.tsx"),X=i("./app/views/settings/components/text/textBlock.tsx"),D=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const M=(0,n.Z)("label",{target:"e1vdkxph0"})({name:"ddvan8",styles:"display:flex;flex:1;align-items:center;margin-bottom:0"});class N extends r.Component{render(){const{disabled:e,enforceRetired:t,enforceAllowed:i,isCurrentUser:s,roleList:n,enforceIdpRoleRestricted:r,roleSelected:a,setSelected:o}=this.props;return(0,D.BX)(f.s_,{children:[(0,D.tZ)(f.V9,{children:(0,D.tZ)("div",{children:(0,w.t)("Organization Role")})}),r&&(0,D.tZ)(f.aU,{children:(0,w._N)("[person] organization-level role is managed through your organization's identity provider.",{person:s?"Your":"This member's"})}),(0,D.tZ)(f.N,{children:n.map((s=>{const{desc:n,name:d,id:l,allowed:m,isRetired:c}=s,h=e||t&&c||i&&!m||r;return(0,D.tZ)(f.Lv,{onClick:()=>!h&&o(l),css:h?{color:"grey",cursor:"default"}:{},children:(0,D.BX)(M,{children:[(0,D.tZ)(T.Z,{id:l,value:d,checked:l===a,readOnly:!0}),(0,D.BX)("div",{style:{flex:1,padding:"0 16px"},children:[d,(0,D.tZ)(X.Z,{noMargin:!0,children:(0,D.tZ)("div",{className:"help-block",children:n})})]})]})},l)}))})]})}}N.displayName="OrganizationRoleSelect";const A=N,L=(0,w.t)("Cannot be reset since user is in more than one organization"),P=(0,w.t)("Not enrolled in two-factor authentication"),F=(0,w.t)("You do not have permission to perform this action"),O=(0,w.t)("Cannot be reset since two-factor is required for this organization"),E=(0,b.Z)({hookName:"component:disabled-member-tooltip",defaultComponent:e=>{let{children:t}=e;return(0,D.tZ)(r.Fragment,{children:t})}});class q extends C.Z{constructor(){super(...arguments),(0,s.Z)(this,"handleSave",(async()=>{const{organization:e,params:t}=this.props;(0,l.E3)((0,w.t)("Saving...")),this.setState({busy:!0});try{await(0,m.hS)(this.api,{orgId:e.slug,memberId:t.memberId,data:this.state.member}),(0,l.S9)((0,w.t)("Saved")),this.redirectToMemberPage()}catch(e){const t=e&&e.responseJSON&&e.responseJSON.detail||(0,w.t)("Could not save...");(0,l.Iw)(t)}this.setState({busy:!1})})),(0,s.Z)(this,"handleInvite",(async e=>{const{organization:t,params:i}=this.props;(0,l.E3)((0,w.t)("Sending invite...")),this.setState({busy:!0});try{const s=await(0,m.R_)(this.api,{orgId:t.slug,memberId:i.memberId,regenerate:e});(0,l.S9)((0,w.t)("Sent invite!")),e&&this.setState((e=>({member:{...e.member,...s}})))}catch(e){(0,l.Iw)((0,w.t)("Could not send invite"))}this.setState({busy:!1})})),(0,s.Z)(this,"handleAddTeam",(e=>{const{member:t}=this.state;if(!t)return;const i=t.teams;i.includes(e.slug)||(t.teams=[...i,e.slug]),this.setState({member:t})})),(0,s.Z)(this,"handleRemoveTeam",(e=>{const{member:t}=this.state;this.setState({member:{...t,teams:t.teams.filter((t=>t!==e))}})})),(0,s.Z)(this,"handle2faReset",(async()=>{const{organization:e,router:t}=this.props,{user:i}=this.state.member,s=i.authenticators.map((e=>(0,d.Hb)(this.api,i.id,e.id)));try{await Promise.all(s),t.push((0,j.D)(`/settings/${e.slug}/members/`)),(0,l.S9)((0,w.t)("All authenticators have been removed"))}catch(e){(0,l.Iw)((0,w.t)("Error removing authenticators")),o.Tb(e)}})),(0,s.Z)(this,"showResetButton",(()=>{const{organization:e}=this.props,{member:t}=this.state,{user:i}=t;return!(!i||!i.authenticators||e.require2FA)&&(i.authenticators.length>=1&&i.canReset2fa)})),(0,s.Z)(this,"getTooltip",(()=>{const{organization:e}=this.props,{member:t}=this.state,{user:i}=t;return i?i.authenticators?i.authenticators.length?i.canReset2fa?e.require2FA?O:"":L:P:F:""}))}getDefaultState(){return{...super.getDefaultState(),roleList:[],selectedRole:"",member:null}}getEndpoints(){const{organization:e,params:t}=this.props;return[["member",`/organizations/${e.slug}/members/${t.memberId}/`]]}redirectToMemberPage(){const{location:e,params:t,routes:i}=this.props,s=(0,R.Z)("members/",{location:e,routes:i,params:t,stepBack:-2});a.browserHistory.push(s)}get memberDeactivated(){return(0,z.Z)(this.state.member)}renderMemberStatus(e){return this.memberDeactivated?(0,D.tZ)("em",{children:(0,D.tZ)(E,{children:(0,w.t)("Deactivated")})}):e.expired?(0,D.tZ)("em",{children:(0,w.t)("Invitation Expired")}):e.pending?(0,D.tZ)("em",{children:(0,w.t)("Invitation Pending")}):(0,w.t)("Active")}renderBody(){const{organization:e}=this.props,{member:t}=this.state;if(!t)return(0,D.tZ)(u.Z,{});const{access:i,features:s}=e,n=t.invite_link,a=i.includes("org:write")&&!this.memberDeactivated,o=s.includes("team-roles"),{email:d,expired:l,pending:m}=t,b=!l,S=!m,z=y.Z.get("user").email===d;return(0,D.BX)(r.Fragment,{children:[(0,D.tZ)(I.Z,{title:(0,D.BX)(r.Fragment,{children:[(0,D.tZ)("div",{children:t.name}),(0,D.tZ)($,{children:(0,w.t)("Member Settings")})]})}),(0,D.BX)(f.s_,{children:[(0,D.tZ)(f.V9,{children:(0,w.t)("Basics")}),(0,D.tZ)(f.N,{children:(0,D.tZ)(f.Lv,{children:(0,D.BX)(G,{children:[(0,D.BX)(H,{children:[(0,D.BX)("div",{children:[(0,D.tZ)(U,{children:(0,w.t)("Email")}),(0,D.tZ)("div",{children:(0,D.tZ)(Z.Z,{href:`mailto:${d}`,children:d})})]}),(0,D.BX)("div",{children:[(0,D.tZ)(U,{children:(0,w.t)("Status")}),(0,D.tZ)("div",{"data-test-id":"member-status",children:this.renderMemberStatus(t)})]}),(0,D.BX)("div",{children:[(0,D.tZ)(U,{children:(0,w.t)("Added")}),(0,D.tZ)("div",{children:(0,D.tZ)(p.Z,{dateOnly:!0,date:t.dateCreated})})]})]}),n&&(0,D.BX)(J,{children:[(0,D.BX)("div",{children:[(0,D.tZ)(U,{children:(0,w.t)("Invite Link")}),(0,D.tZ)(v.ZP,{children:n}),(0,D.tZ)("p",{className:"help-block",children:(0,w.t)("This invite link can be used by anyone who knows it. Keep it secure!")})]}),(0,D.BX)(Y,{children:[(0,D.tZ)(c.zx,{onClick:()=>this.handleInvite(!0),children:(0,w.t)("Generate New Invite")}),b&&(0,D.tZ)(c.zx,{"data-test-id":"resend-invite",onClick:()=>this.handleInvite(!1),children:(0,w.t)("Resend Invite")})]})]})]})})})]}),S&&(0,D.BX)(f.s_,{children:[(0,D.tZ)(f.V9,{children:(0,w.t)("Authentication")}),(0,D.tZ)(f.N,{children:(0,D.tZ)(g.Z,{alignRight:!0,flexibleControlStateSize:!0,label:(0,w.t)("Reset two-factor authentication"),help:(0,w.t)("Resetting two-factor authentication will remove all two-factor authentication methods for this member."),children:(0,D.tZ)(x.ZP,{disabled:this.showResetButton(),title:this.getTooltip(),children:(0,D.tZ)(h.Z,{disabled:!this.showResetButton(),message:(0,w._N)("Are you sure you want to disable all two-factor authentication methods for [name]?",{name:t.name?t.name:"this member"}),onConfirm:this.handle2faReset,children:(0,D.tZ)(c.zx,{priority:"danger",children:(0,w.t)("Reset two-factor authentication")})})})})})]}),(0,D.tZ)(A,{enforceAllowed:!1,enforceIdpRoleRestricted:t.flags["idp:role-restricted"],enforceRetired:o,isCurrentUser:z,disabled:!a,roleList:t.roles,roleSelected:t.role,setSelected:e=>this.setState({member:{...t,role:e}})}),(0,D.tZ)(k.Z,{slugs:t.teams,children:t=>{let{teams:i,initiallyLoaded:s}=t;return(0,D.tZ)(_.Z,{enforceIdpProvisioned:!0,organization:e,selectedTeams:i,disabled:!a,onAddTeam:this.handleAddTeam,onRemoveTeam:this.handleRemoveTeam,loadingTeams:!s})}}),(0,D.tZ)(K,{children:(0,D.tZ)(c.zx,{priority:"primary",busy:this.state.busy,onClick:this.handleSave,disabled:!a,children:(0,w.t)("Save Member")})})]})}}const V=(0,B.Z)(q),$=(0,n.Z)("div",{target:"e1mjm7f06"})("color:",(e=>e.theme.gray300),";font-weight:normal;font-size:",(e=>e.theme.fontSizeLarge),";"),H=(0,n.Z)("div",{target:"e1mjm7f05"})("display:grid;grid-auto-flow:column;grid-template-columns:2fr 1fr 1fr;gap:",(0,S.Z)(2),";width:100%;@media (max-width: ",(e=>e.theme.breakpoints.small),"){grid-auto-flow:row;grid-template-columns:auto;}"),U=(0,n.Z)("div",{target:"e1mjm7f04"})("font-weight:bold;margin-bottom:",(0,S.Z)(.5),";color:",(e=>e.theme.textColor),";"),G=(0,n.Z)("div",{target:"e1mjm7f03"})({name:"8za49e",styles:"overflow:hidden;flex:1"}),J=(0,n.Z)("div",{target:"e1mjm7f02"})("border-top:1px solid ",(e=>e.theme.border),";margin-top:",(0,S.Z)(2),";padding-top:",(0,S.Z)(2),";"),Y=(0,n.Z)("div",{target:"e1mjm7f01"})("display:grid;gap:",(0,S.Z)(1),";grid-auto-flow:column;justify-content:flex-end;margin-top:",(0,S.Z)(2),";"),K=(0,n.Z)("div",{target:"e1mjm7f00"})({name:"skgbeu",styles:"display:flex;justify-content:flex-end"})}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationMembers_organizationMemberDetail_tsx.9d504b51268c0304129437cd8d4c3188.js.map