"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionReplays_index_tsx-node_modules_downsample-25e16b"],{"./app/views/performance/transactionSummary/transactionReplays/index.tsx":(t,e,r)=>{r.r(e),r.d(e,{default:()=>R}),r("../node_modules/core-js/modules/es.array.push.js");var n=r("../node_modules/react/index.js"),a=r("./app/components/acl/feature.tsx"),o=r("./app/components/alert.tsx"),i=r("./app/components/layouts/thirds.tsx"),s=r("./app/components/loadingIndicator.tsx"),l=r("./app/locale.tsx"),c=r("./app/utils/discover/eventView.tsx"),u=r("./app/utils/discover/fields.tsx"),p=r("./app/utils/queryString.tsx"),h=r("./app/utils/tokenizeSearch.tsx"),f=r("./app/utils/withOrganization.tsx"),v=r("./app/utils/withProjects.tsx"),y=r("./app/views/performance/transactionSummary/filter.tsx"),d=r("./app/views/performance/transactionSummary/pageLayout.tsx"),g=r("./app/views/performance/transactionSummary/tabs.tsx"),m=r("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),w=r("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),x=r("../node_modules/lodash/first.js"),M=r.n(x),b=r("./app/components/pagination.tsx"),A=r("./app/utils/useMedia.tsx"),S=r("./app/views/replays/replayTable/index.tsx"),Z=r("./app/views/replays/replayTable/types.tsx"),k=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function V(t){let{eventView:e,isFetching:r,pageLinks:n,replays:a}=t;const o=(0,w.u)(),s=(0,A.Z)(`(min-width: ${o.breakpoints.small})`);return(0,k.BX)(i.or,{fullWidth:!0,children:[(0,k.tZ)(S.Z,{fetchError:void 0,isFetching:r,replays:a,sort:M()(e.sorts)||{field:"started_at",kind:"asc"},visibleColumns:[Z.M.session,...s?[Z.M.slowestTransaction,Z.M.startedAt]:[],Z.M.duration,Z.M.countErrors,Z.M.activity]}),(0,k.tZ)(b.Z,{pageLinks:n})]})}V.displayName="ReplaysContent";const P=V;var j=r("../node_modules/@sentry/core/esm/exports.js"),F=r("./app/utils/discover/genericDiscoverQuery.tsx"),q=r("./app/utils/replays/fetchReplayList.tsx"),z=r("./app/utils/useApi.tsx");function E(){return(0,k.tZ)(i.T3,{withPadding:!0,children:(0,k.tZ)(o.bZ,{type:"warning",children:(0,l.t)("You don't have access to this feature")})})}function _(t){const{location:e,organization:r,projects:n}=t;return(0,k.tZ)(a.Z,{features:["session-replay-ui"],organization:r,renderDisabled:E,children:(0,k.tZ)(d.ZP,{location:e,organization:r,projects:n,tab:g.Z.Replays,getDocumentTitle:D,generateEventView:N,childComponent:I})})}function I(t){let{eventView:e,location:r,organization:a,setError:o}=t;const l=(0,m.tb)(r),u=(0,y.q0)(r),{eventView:f,replays:v,pageLinks:d,isFetching:g,fetchError:w}=function(t){let{eventsWithReplaysView:e,location:r,organization:a,spanOperationBreakdownFilter:o,eventsDisplayFilterName:i}=t;const s=(0,z.Z)(),[l,u]=(0,n.useState)({fetchError:void 0,isFetching:!0,pageLinks:null,replays:[],eventView:void 0}),f=(0,n.useCallback)((async()=>{const t=(0,m.Lc)(e.clone()),n=await async function(t){let{api:e,eventView:r,location:n,organization:a}=t;try{const[t]=await(0,F.AA)(e,`/organizations/${a.slug}/events/`,r.getEventsAPIPayload(n));return t.data[0]}catch(t){return j.Tb(t),null}}({api:s,eventView:t,location:r,organization:a}),l=(0,m.Kc)(n),f=function(t){let{percentiles:e,spanOperationBreakdownFilter:r,eventsDisplayFilterName:n,eventView:a}=t;const o=(0,m._S)(r,e)[n],i=a.clone();if(i&&o?.query){const t=new h.MY(i.query);o.query.forEach((e=>t.setFilterValues(e[0],[e[1]]))),i.query=t.formatString()}return i}({eventView:e,percentiles:l,spanOperationBreakdownFilter:o,eventsDisplayFilterName:i}),v=await async function(t){let{api:e,eventView:r,location:n,organization:a}=t;try{const[t]=await(0,F.AA)(e,`/organizations/${a.slug}/events/`,r.getEventsAPIPayload(n));return t.data}catch(t){return j.Tb(t),null}}({api:s,eventView:f??e,location:r,organization:a}),y=v?.map((t=>t.replayId)),d=c.ZP.fromNewQueryWithLocation({id:"",name:"Replays within a transaction",version:2,fields:q.p8,projects:[],query:`id:[${String(y)}]`},r);d.sorts=(0,c.vp)((0,p.ro)(r.query.sort,q.yw));const g=await(0,q.ZP)({api:s,eventView:d,location:r,organization:a}),w=g.replays?.map((t=>{let e;for(const r of v??[])r.replayId===t.id&&(!e||r["transaction.duration"]>e["transaction.duration"])&&(e=r);return{...t,txEvent:e??{}}}));u({...g,eventView:d,isFetching:!1,replays:w})}),[s,e,r,a,o,i]);return(0,n.useEffect)((()=>{f()}),[f]),l}({eventsWithReplaysView:e,location:r,organization:a,eventsDisplayFilterName:l,spanOperationBreakdownFilter:u});return(0,n.useEffect)((()=>{o(w?.message)}),[o,w]),g||!f?(0,k.tZ)(i.or,{fullWidth:!0,children:(0,k.tZ)(s.Z,{})}):v?(0,k.tZ)(P,{eventView:f,isFetching:g,location:r,organization:a,pageLinks:d,replays:v,eventsDisplayFilterName:l,spanOperationBreakdownFilter:u}):(0,k.tZ)(n.Fragment,{children:null})}function D(t){return"string"==typeof t&&String(t).trim().length>0?[String(t).trim(),(0,l.t)("Replays")].join(" — "):[(0,l.t)("Summary"),(0,l.t)("Replays")].join(" — ")}function N(t){let{location:e,transactionName:r}=t;const n=["replayId","count()","transaction.duration","trace","timestamp"],a=(0,y.q0)(e);a!==y.f1.None?n.push(`spans.${a}`):n.push(...u.$4,u.zD);const o=(0,p.ro)(e.query.query,""),i=new h.MY(o);return i.setFilterValues("event.type",["transaction"]),i.addFilterValues("transaction",[r]),i.addFilterValues("!replayId",[""]),c.ZP.fromNewQueryWithLocation({id:"",name:"Replay events within a transaction",version:2,fields:n,query:i.formatString(),projects:[],orderby:(0,p.ro)(e.query.sort,"-timestamp")},e)}E.displayName="renderNoAccess",_.displayName="TransactionReplays";const R=(0,v.Z)((0,f.Z)(_))},"../node_modules/downsample/methods/ASAP.js":(t,e)=>{function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var n={"PointValueExtractor<unknown>":t=>"function"==typeof t,XYDataPoint:t=>null!=t&&n.X(t.x)&&"number"==typeof t.y,X:t=>"number"==typeof t||t instanceof Date},a=t=>{for(var e=0,r=0;r<t.length;r+=1)e+=t[r];return e/t.length},o=(t,e)=>{for(var r=t.length,n=new Array(r),a=0;a<r;a++)n[a]=e(t[a],a);return n},i=t=>n["PointValueExtractor<unknown>"](t)?t:e=>e[t],s=(t,e)=>({x:t,y:e}),l=()=>({x:t=>{var e=n.XYDataPoint(t)?t.x:t[0];return e instanceof Date?e.getTime():e},y:t=>"y"in t?t.y:t[1],toPoint:s}),c=(t,e)=>new t.constructor(e),u=function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=[],a=0,o=0;o<e;o++)a+=t[o];for(var i=e;i<=t.length;i++)(i-e)%r==0&&n.push(a/e),a+=t[i]-t[i-e];return n},p=t=>{var e=i(t.x),r=i(t.y),n=t.toPoint;return function(t,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0===t.length)return t;for(var s,l=o(t,r),u=o(t,e),p=c(t,0),h=0,f=0;f<a;f++)h+=l[f];for(var v=a;v<=l.length;v++)(v-a)%i==0&&(s=n((u[v-a]+u[v-1])/2,h/a,v-a),p[p.length]=s),h+=l[v]-l[v-a];return p}};function h(t,e){if(t.length!=e.length)throw"Mismatched lengths";var r=t.length;0!=r&&(0==(r&r-1)?function(t,e){if(t.length!=e.length)throw"Mismatched lengths";var r=t.length;if(1!=r){for(var n=-1,a=0;a<32;a++)1<<a==r&&(n=a);if(-1==n)throw"Length is not a power of 2";for(var o=new Array(r/2),i=new Array(r/2),s=0;s<r/2;s++)o[s]=Math.cos(2*Math.PI*s/r),i[s]=Math.sin(2*Math.PI*s/r);for(var l=0;l<r;l++){var c=v(l,n);if(c>l){var u=t[l];t[l]=t[c],t[c]=u,u=e[l],e[l]=e[c],e[c]=u}}for(var p=2;p<=r;p*=2)for(var h=p/2,f=r/p,y=0;y<r;y+=p)for(var d=y,g=0;d<y+h;d++,g+=f){var m=t[d+h]*o[g]+e[d+h]*i[g],w=-t[d+h]*i[g]+e[d+h]*o[g];t[d+h]=t[d]-m,e[d+h]=e[d]-w,t[d]+=m,e[d]+=w}}}(t,e):function(t,e){if(t.length!=e.length)throw"Mismatched lengths";for(var r=t.length,n=1;n<2*r+1;)n*=2;for(var a=new Array(r),o=new Array(r),i=0;i<r;i++){var s=i*i%(2*r);a[i]=Math.cos(Math.PI*s/r),o[i]=Math.sin(Math.PI*s/r)}for(var l=new Array(n),c=new Array(n),u=0;u<r;u++)l[u]=t[u]*a[u]+e[u]*o[u],c[u]=-t[u]*o[u]+e[u]*a[u];for(var p=r;p<n;p++)l[p]=c[p]=0;var v=new Array(n),y=new Array(n);v[0]=a[0],y[0]=o[0];for(var d=1;d<r;d++)v[d]=v[n-d]=a[d],y[d]=y[n-d]=o[d];for(var g=r;g<=n-r;g++)v[g]=y[g]=0;var m=new Array(n),w=new Array(n);!function(t,e,r,n,a,o){if(t.length!=e.length||t.length!=r.length||r.length!=n.length||t.length!=a.length||a.length!=o.length)throw"Mismatched lengths";var i=t.length;t=t.slice(),e=e.slice(),r=r.slice(),n=n.slice(),h(t,e),h(r,n);for(var s=0;s<i;s++){var l=t[s]*r[s]-e[s]*n[s];e[s]=e[s]*r[s]+t[s]*n[s],t[s]=l}f(t,e);for(var c=0;c<i;c++)a[c]=t[c]/i,o[c]=e[c]/i}(l,c,v,y,m,w);for(var x=0;x<r;x++)t[x]=m[x]*a[x]+w[x]*o[x],e[x]=-m[x]*o[x]+w[x]*a[x]}(t,e))}function f(t,e){h(e,t)}function v(t,e){for(var r=0,n=0;n<e;n++)r=r<<1|1&t,t>>>=1;return r}p(l());var y,d,g,m=t=>(t=>{for(var e=a(t),r=0,n=0;n<t.length;n+=1)r+=(t[n]-e)*(t[n]-e);return Math.sqrt(r/t.length)})((t=>{var e=t.length-1;if(e<1)return[];for(var r=new Array(e),n=0;n<e;n++)r[n]=t[n+1]-t[n];return r})(t)),w=t=>{for(var e,r,n=t.length,o=a(t),i=0,s=0,l=0;l<n;l++)i+=(r=(e=t[l]-o)*e)*r,s+=r;return n*i/(s*s)},x=(y=l(),d=i(y.y),g=p(y),function t(e,n){if(0===e.length)return e;if(n<=0)throw new Error("Supplied non-positive resolution parameter to ASAP: ".concat(n));if(e.length>=2*n){var i=Math.trunc(e.length/n);return t(g(e,i,i),n)}for(var s=o(e,d),l=((t,e)=>{for(var n=t.length,o=a(t),i=Math.pow(2,Math.trunc(Math.log2(n))+1),s=new Array(i).fill(0),l=new Array(i).fill(0),c=0;c<n;c+=1)s[c]=t[c]-o;h(s,l);for(var u=0;u<s.length;u+=1)s[u]=Math.pow(s[u],2)+Math.pow(l[u],2),l[u]=0;f(s,l);for(var p=[],v=1;v<e;v++)p[v]=s[v]/s[0];var y=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,r=t.length;if(r<=1)return[[],0];var n=0,a=[];if(t.length>1)for(var o=t[1]>t[0],i=1,s=2;s<t.length;s+=1)!o&&t[s]>t[s-1]?(i=s,o=!o):o&&t[s]>t[i]?i=s:o&&t[s]<t[s-1]&&(i>1&&t[i]>e&&(a.push(i),t[i]>n&&(n=t[i])),o=!o);if(a.length<=1)for(var l=2;l<r;l+=1)a.push(l);return[a,n]}(p),d=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){a=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}}(t,e)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(y,2);return{correlations:p,peaks:d[0],maxCorrelation:d[1]}})(s,Math.round(s.length/10)),c=l.correlations,p=l.peaks,v=l.maxCorrelation,y=w(s),x=m(s),M=1,b=1,A=-1,S=s.length/10,Z=p.length-1;Z>=0;Z-=1){var k=p[Z];if(k<b||1===k)break;if(!(Math.sqrt(1-c[k])*M>Math.sqrt(1-c[M])*k)){var V=u(s,k,1),P=w(V),j=m(V);P>=y&&(j<x&&(x=j,M=k),b=Math.round(Math.max(k*Math.sqrt((v-1)/(c[k]-1)),b)),A<0&&(A=Z))}}return A>0&&(A<p.length-2&&(S=p[A+1]),b=Math.max(b,p[A]+1)),M=((t,e,r,n,a,o)=>{for(;t<=e;){var i=Math.round((t+e)/2),s=u(r,i,1);if(w(s)>=a){var l=m(s);l<n&&(o=i,n=l),t=i+1}else e=i-1}return o})(b,S,s,x,y,M),g(e,M,1)});e.Cl=x}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionReplays_index_tsx-node_modules_downsample-25e16b.df15bd584f68f8ee74ba41850ac98611.js.map