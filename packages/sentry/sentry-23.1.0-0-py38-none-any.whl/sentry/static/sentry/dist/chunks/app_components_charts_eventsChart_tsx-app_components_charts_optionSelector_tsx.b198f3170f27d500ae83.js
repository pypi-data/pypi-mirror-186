"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_eventsChart_tsx-app_components_charts_optionSelector_tsx"],{"./app/components/charts/chartZoom.tsx":(e,t,s)=>{s.d(t,{Z:()=>y});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),a=s("../node_modules/moment/moment.js"),i=s.n(a),n=s("../node_modules/query-string/index.js"),l=s("./app/actionCreators/pageFilters.tsx"),d=s("./app/components/charts/components/dataZoomInside.tsx");s("../node_modules/echarts/lib/component/dataZoomSlider.js");const p={realtime:!1,showDetail:!1,left:0,right:6,bottom:8};function c(e){return e&&Array.isArray(e)?e:[{...p,...e}]}var m=s("./app/components/charts/components/toolBox.tsx"),u=s("./app/utils/callIfFunction.tsx"),h=s("./app/utils/dates.tsx");const g=e=>e?i().utc(e).format(i().HTML5_FMT.DATETIME_LOCAL_SECONDS):null;class v extends o.Component{constructor(e){var t;super(e),t=this,(0,r.Z)(this,"history",void 0),(0,r.Z)(this,"currentPeriod",void 0),(0,r.Z)(this,"zooming",null),(0,r.Z)(this,"saveCurrentPeriod",(e=>{this.currentPeriod={period:e.period,start:g(e.start),end:g(e.end)}})),(0,r.Z)(this,"setPeriod",(function(e){let{period:s,start:r,end:o}=e,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{router:i,onZoom:d,usePageDate:p}=t.props,c=g(r),m=g(o);a&&t.history.push(t.currentPeriod),d?.({period:s,start:c,end:m}),t.zooming=()=>{if(p&&i){const e={...i.location.query,pageStart:r?(0,h.v5)(r):void 0,pageEnd:o?(0,h.v5)(o):void 0,pageStatsPeriod:s??void 0};n.stringify(e)!==n.stringify(i.location.query)&&i.push({pathname:i.location.pathname,query:e})}else(0,l.dR)({period:s,start:c?(0,h.hC)(c):c,end:m?(0,h.hC)(m):m},i);t.saveCurrentPeriod({period:s,start:r,end:o})}})),(0,r.Z)(this,"handleChartReady",(e=>{this.props.onChartReady?.(e)})),(0,r.Z)(this,"handleZoomRestore",((e,t)=>{this.history.length&&(this.setPeriod(this.history[0]),this.history=[],this.props.onRestore?.(e,t))})),(0,r.Z)(this,"handleDataZoom",((e,t)=>{const s=t.getModel(),{startValue:r,endValue:o}=s._payload.batch[0];if(null===r&&null===o){const e=this.history.pop();if(!e)return;this.setPeriod(e)}else{const e=i().utc(r),t=i().utc(o);this.setPeriod({period:null,start:e,end:t},!0)}this.props.onDataZoom?.(e,t)})),(0,r.Z)(this,"handleChartFinished",((e,t)=>{"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const s=t._componentsViews?.find((e=>e._features&&e._features.dataZoom));s&&!s._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0}),(0,u.g)(this.props.onFinished)})),this.history=[],this.saveCurrentPeriod(e)}componentDidUpdate(){this.props.disabled||this.saveCurrentPeriod(this.props)}render(){const{utc:e,start:t,end:s,disabled:r,children:o,xAxisIndex:a,router:i,onZoom:n,onRestore:l,onChartReady:p,onDataZoom:u,onFinished:g,showSlider:v,chartZoomOptions:y,...x}=this.props,f=e??void 0,b=t?(0,h.hC)(t):void 0,Z=s?(0,h.hC)(s):void 0;return o(r?{utc:f,start:b,end:Z,...x}:{isGroupedByDate:!0,onChartReady:this.handleChartReady,utc:f,start:b,end:Z,dataZoom:v?[...c({xAxisIndex:a,...y}),...(0,d.Z)({xAxisIndex:a,...y})]:(0,d.Z)({xAxisIndex:a,...y}),showTimeInTooltip:!0,toolBox:(0,m.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom,onFinished:this.handleChartFinished,onRestore:this.handleZoomRestore,...x})}}v.displayName="ChartZoom";const y=v},"./app/components/charts/components/dataZoomInside.tsx":(e,t,s)=>{s.d(t,{Z:()=>o}),s("../node_modules/echarts/lib/component/dataZoomInside.js");const r={type:"inside",zoomOnMouseWheel:!1,zoomLock:!0,throttle:50};function o(e){return e&&Array.isArray(e)?e:[{...r,...e}]}},"./app/components/charts/components/toolBox.tsx":(e,t,s)=>{function r(){let{dataZoom:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e?{dataZoom:{yAxisIndex:"none",title:{zoom:"zoom",back:"undo"},...e}}:{},...t}}function o(e,t){return{right:0,top:0,itemSize:16,z:-1,feature:r(t),...e}}s.d(t,{Z:()=>o})},"./app/components/charts/components/visualMap.tsx":(e,t,s)=>{function r(e){return e}s.d(t,{Z:()=>r}),s("../node_modules/echarts/lib/component/visualMap.js")},"./app/components/charts/errorPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});const r=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1t1x7f30"})("display:flex;flex-direction:column;justify-content:center;align-items:center;flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height||"200px"),";position:relative;border-color:transparent;margin-bottom:0;color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeExtraLarge),";")},"./app/components/charts/eventsChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>A});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),a=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),i=s("../node_modules/lodash/isEqual.js"),n=s.n(i),l=s("./app/components/charts/areaChart.tsx"),d=s("./app/components/charts/barChart.tsx"),p=s("./app/components/charts/chartZoom.tsx"),c=s("./app/components/charts/errorPanel.tsx"),m=s("./app/components/charts/lineChart.tsx"),u=s("./app/components/charts/releaseSeries.tsx"),h=s("./app/components/charts/transitionChart.tsx"),g=s("./app/components/charts/transparentLoadingMask.tsx"),v=s("./app/components/charts/utils.tsx"),y=s("./app/components/charts/worldMapChart.tsx"),x=s("./app/icons/index.tsx"),f=s("./app/locale.tsx"),b=s("./app/utils.tsx"),Z=s("./app/utils/discover/charts.tsx"),D=s("./app/utils/discover/fields.tsx"),S=s("./app/utils/queryString.tsx"),j=s("./app/components/charts/eventsGeoRequest.tsx"),C=s("./app/components/charts/eventsRequest.tsx"),_=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class P extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{seriesSelection:{},forceUpdate:!1}),(0,r.Z)(this,"handleLegendSelectChanged",(e=>{const{disableableSeries:t=[]}=this.props,{selected:s}=e,r=Object.keys(s).reduce(((e,r)=>{const o=["Releases","Other"].includes(r)||t.includes(r);return e[r]=!o||s[r],e}),{});this.setState({seriesSelection:r,forceUpdate:!0},(()=>this.setState({forceUpdate:!1})))}))}shouldComponentUpdate(e,t){return!(!t.forceUpdate&&n()(this.state.seriesSelection,t.seriesSelection)&&(e.reloading||!e.timeseriesData||n()(this.props.timeseriesData,e.timeseriesData)&&n()(this.props.releaseSeries,e.releaseSeries)&&n()(this.props.previousTimeseriesData,e.previousTimeseriesData)&&n()(this.props.tableData,e.tableData)&&n()(this.props.additionalSeries,e.additionalSeries)))}getChartComponent(){const{showDaily:e,timeseriesData:t,yAxis:s,chartComponent:r}=this.props;if((0,b.ri)(r))return r;if(e)return d.v;if(t.length>1)switch((0,D.fD)(s)){case"line":return m.w;case"area":return l.T;default:throw new Error(`Unknown multi plot type for ${s}`)}return l.T}render(){const{theme:e,loading:t,reloading:s,yAxis:r,releaseSeries:o,zoomRenderProps:a,timeseriesData:i,previousTimeseriesData:n,showLegend:l,legendOptions:p,chartOptions:c,currentSeriesNames:m,previousSeriesNames:u,seriesTransformer:h,previousSeriesTransformer:g,colors:x,height:b,timeframe:S,topEvents:j,tableData:C,fromDiscover:P,timeseriesResultsTypes:T,additionalSeries:w,...A}=this.props,{seriesSelection:R}=this.state;let M=this.getChartComponent();if(M===y.y){const{data:e,title:t}=(0,v.JT)(C),s=[{seriesName:t,data:e}];return(0,_.tZ)(y.y,{series:s,fromDiscover:P})}const k=[...m.length>0?m:[(0,f.t)("Current")],...u.length>0?u:[(0,f.t)("Previous")],...w?w.map((e=>e.name)):[]],z=(0,f.t)("Releases"),L=j&&j+1===i.length;L&&k.push("Other"),Array.isArray(o)&&k.push(z);const N=o&&o[0],O=Array.isArray(o)&&N?.markLine?.data&&N.markLine.data.length>=v.XO,q=Array.isArray(o)&&0===Object.keys(R).length&&O?{[z]:!1}:R,E=l?{right:16,top:12,data:k,selected:q,...p??{}}:void 0;let I=Array.isArray(o)?[...i,...o]:i,W=n;h&&(I=h(I)),g&&(W=W?.map((e=>g(e))));const F=i.length?x?.slice(0,I.length)??[...e.charts.getColorPalette(i.length-2-(L?1:0))]:void 0;F&&F.length&&L&&F.push(e.chartOther);const Q={colors:F,grid:{left:"24px",right:"24px",top:"32px",bottom:"12px"},seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",truncate:80,valueFormatter:(e,t)=>{const s=t?.replace(/^previous /,"").split(":").pop()?.trim();return s?T?(0,Z.CX)(e,T[s]):(0,Z.CX)(e,(0,D.Px)(s)):(0,Z.CX)(e,"number")}},xAxis:S?{min:S.start,max:S.end}:void 0,yAxis:{axisLabel:{color:e.chartLabel,formatter:e=>{if(T){const t=1===new Set(Object.values(T)).size?T[r]:"number";return(0,Z.x1)(e,t)}return(0,Z.gu)(e,(0,D.Px)(r))}}},...c??{},animation:typeof M!=typeof d.v&&void 0};return(0,_.tZ)(M,{...A,...a,...Q,legend:E,onLegendSelectChanged:this.handleLegendSelectChanged,series:I,previousPeriod:W||void 0,height:b,additionalSeries:w})}}P.displayName="Chart";const T=(0,a.b)(P);class w extends o.Component{isStacked(){const{topEvents:e,yAxis:t}=this.props;return"number"==typeof e&&e>0||Array.isArray(t)&&t.length>1}render(){const{api:e,organization:t,period:s,utc:r,query:a,router:i,start:n,end:l,projects:d,environments:m,showLegend:b,minutesThresholdToDisplaySeconds:Z,yAxis:P,disablePrevious:w,disableReleases:A,emphasizeReleases:R,currentSeriesName:M,previousSeriesName:k,seriesTransformer:z,previousSeriesTransformer:L,field:N,interval:O,showDaily:q,topEvents:E,orderby:I,confirmedQuery:W,colors:F,chartHeader:Q,legendOptions:U,chartOptions:$,preserveReleaseQueryParams:B,releaseQueryExtra:Y,disableableSeries:X,chartComponent:G,usePageZoom:H,height:J,withoutZerofill:V,fromDiscover:K,additionalSeries:ee,loadingAdditionalSeries:te,reloadingAdditionalSeries:se,...re}=this.props,oe=!w&&!n&&!l,ae=(0,S.qP)(P),ie=ae.map((e=>{let t=e&&(0,D.GO)(e)?(0,D.vp)(e):e;return t&&t.length>60&&(t=t.substr(0,60)+"..."),t})),ne=k?[k]:ie.map((e=>(0,f.t)("previous %s",e))),le=M?[M]:ie,de=q?"1d":O||(0,v.ZS)(this.props,"high");let pe=e=>{let{zoomRenderProps:t,releaseSeries:s,errored:r,loading:a,reloading:i,results:n,timeseriesData:l,previousTimeseriesData:d,timeframe:p,tableData:m,timeseriesResultsTypes:u}=e;if(r)return(0,_.tZ)(c.Z,{children:(0,_.tZ)(x.FC,{color:"gray300",size:"lg"})});const v=n||l;return(0,_.BX)(h.Z,{loading:a,reloading:i||!!se,height:J?`${J}px`:void 0,children:[(0,_.tZ)(g.Z,{visible:i||!!se}),o.isValidElement(Q)&&Q,(0,_.tZ)(T,{zoomRenderProps:t,loading:a||!!te,reloading:i||!!se,showLegend:b,minutesThresholdToDisplaySeconds:Z,releaseSeries:s||[],timeseriesData:v??[],previousTimeseriesData:d,currentSeriesNames:le,previousSeriesNames:ne,seriesTransformer:z,additionalSeries:ee,previousSeriesTransformer:L,stacked:this.isStacked(),yAxis:ae[0],showDaily:q,colors:F,legendOptions:U,chartOptions:$,disableableSeries:X,chartComponent:G,height:J,timeframe:p,topEvents:E,tableData:m??[],fromDiscover:K,timeseriesResultsTypes:u})]})};if(!A){const e=pe;pe=t=>(0,_.tZ)(u.Z,{utc:r,period:s,start:n,end:l,projects:d,environments:m,emphasizeReleases:R,preserveQueryParams:B,queryExtra:Y,children:s=>{let{releaseSeries:r}=s;return e({...t,releaseSeries:r})}})}return(0,_.tZ)(p.Z,{router:i,period:s,start:n,end:l,utc:r,usePageDate:H,...re,children:r=>G===y.y?(0,_.tZ)(j.Z,{api:e,organization:t,yAxis:P,query:a,orderby:I,projects:d,period:s,start:n,end:l,environments:m,referrer:re.referrer,children:e=>{let{errored:t,loading:s,reloading:o,tableData:a}=e;return pe({errored:t,loading:s,reloading:o,zoomRenderProps:r,tableData:a})}}):(0,_.tZ)(C.Z,{...re,api:e,organization:t,period:s,project:d,environment:m,start:n,end:l,interval:de,query:a,includePrevious:oe,currentSeriesNames:le,previousSeriesNames:ne,yAxis:P,field:N,orderby:I,topEvents:E,confirmedQuery:W,partial:!0,withoutZerofill:V&&!this.isStacked(),children:e=>pe({...e,zoomRenderProps:r})})})}}w.displayName="EventsChart";const A=w},"./app/components/charts/eventsGeoRequest.tsx":(e,t,s)=>{s.d(t,{Z:()=>d});var r=s("../node_modules/react/index.js"),o=s("./app/utils/dates.tsx"),a=s("./app/utils/discover/eventView.tsx"),i=s("./app/utils/discover/genericDiscoverQuery.tsx"),n=s("./app/utils/toArray.tsx"),l=s("./app/utils/usePrevious.tsx");const d=e=>{let{api:t,organization:s,yAxis:d,query:p,orderby:c,projects:m,period:u,start:h,end:g,environments:v,referrer:y,children:x}=e;const f=(0,r.useMemo)((()=>a.ZP.fromSavedQuery({id:void 0,name:"",version:2,fields:(0,n.Z)(d),query:p,orderby:c??"",projects:m,range:u??"",start:h?(0,o.v5)(h):void 0,end:g?(0,o.v5)(g):void 0,environment:v})),[d,p,c,m,u,h,g,v]),[b,Z]=(0,r.useState)(void 0),[D,S]=(0,r.useState)(!1),[j,C]=(0,r.useState)(!1),_=(0,l.Z)(t),P=(0,l.Z)(f),T=(0,l.Z)(s.slug),w=(0,l.Z)(y);return(0,r.useEffect)((()=>{let e=!0;return C(!1),_===t&&P===f&&T===s.slug&&w===y||S(!0),(0,i.AA)(t,`/organizations/${s.slug}/events-geo/`,{...f.generateQueryStringObject(),referrer:y}).then((t=>{e&&(Z([t[0]]),S(!1))})).catch((()=>{e&&(C(!0),S(!1))})),()=>{e=!1}}),[t,f,s.slug,y,_,P,T,w]),x({errored:j,loading:!b&&!j,reloading:D,tableData:b})}},"./app/components/charts/eventsRequest.tsx":(e,t,s)=>{s.d(t,{Z:()=>Z});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),a=s("../node_modules/lodash/isEqual.js"),i=s.n(a),n=s("../node_modules/lodash/omitBy.js"),l=s.n(n),d=s("./app/actionCreators/events.tsx"),p=s("./app/actionCreators/indicator.tsx"),c=s("./app/components/charts/loadingPanel.tsx"),m=s("./app/components/charts/utils.tsx"),u=s("./app/locale.tsx"),h=s("./app/utils.tsx"),g=s("./app/utils/discover/fieldRenderers.tsx"),v=s("./app/utils/discover/fields.tsx"),y=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const x=["api","children","organization","loading","queryBatching","generatePathname"],f=e=>l()(e,((e,t)=>x.includes(t)));class b extends o.PureComponent{constructor(){var e;super(...arguments),e=this,(0,r.Z)(this,"state",{reloading:!!this.props.loading,errored:!1,timeseriesData:null,fetchedWithPrevious:!1}),(0,r.Z)(this,"unmounting",!1),(0,r.Z)(this,"fetchData",(async()=>{const{api:e,confirmedQuery:t,onError:s,expired:r,name:o,hideError:a,...i}=this.props;let n,l=null;if(!1!==t){if(this.setState((e=>({reloading:null!==e.timeseriesData,errored:!1,errorMessage:void 0}))),r)n=(0,u.t)("%s has an invalid date range. Please try a more recent date range.",o),(0,p.Iw)(n,{append:!0}),this.setState({errored:!0,errorMessage:n});else try{e.clear(),l=await(0,d.lI)(e,i)}catch(e){n=e&&e.responseJSON&&e.responseJSON.detail?e.responseJSON.detail:(0,u.t)("Error loading chart data"),a||(0,p.Iw)(n),s&&s(n),this.setState({errored:!0,errorMessage:n})}this.unmounting||(this.setState({reloading:!1,timeseriesData:l,fetchedWithPrevious:i.includePrevious}),i.dataLoadedCallback&&i.dataLoadedCallback(l))}})),(0,r.Z)(this,"getData",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const{fetchedWithPrevious:s}=e.state,{period:r,includePrevious:o}=e.props,a=s||(0,m.Sw)(o,r),i=Math.floor(t.length/2);return{current:a?t.slice(i):t,previous:a?t.slice(0,i):null}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){i()(f(e),f(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}calculateTotalsPerTimestamp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>1e3*e;return e.map(((e,s)=>{let[r,o]=e;return{name:t(r,o,s),value:o.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)}}))}transformPreviousPeriodData(e,t,s){return t?{seriesName:s??"Previous",data:this.calculateTotalsPerTimestamp(t,((t,s,r)=>1e3*e[r][0])),stack:"previous"}:null}transformAggregatedTimeseries(e){return{seriesName:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",data:this.calculateTotalsPerTimestamp(e)}}transformTimeseriesData(e,t,s){let r=1;if(s){const e=t?.units?.[(0,v.LY)(s)];r=(e&&(g.a_[e]??g.en[e]))??1}return[{seriesName:s||"Current",data:e.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)*r}}))}]}transformComparisonTimeseriesData(e){return[{seriesName:"comparisonCount()",data:e.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{comparisonCount:s}=t;return e+(s??0)}),0)}}))}]}processData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0;const{data:r,isMetricsData:o,totals:a,meta:i}=e,{includeTransformedData:n,includeTimeAggregation:l,timeAggregationSeriesName:d,currentSeriesNames:p,previousSeriesNames:c,comparisonDelta:u}=this.props,{current:h,previous:g}=this.getData(r);return{data:n?this.transformTimeseriesData(h,i,s??p?.[t]):[],comparisonData:n&&u?this.transformComparisonTimeseriesData(h):[],allData:r,originalData:h,totals:a,isMetricsData:o,originalPreviousData:g,previousData:n?this.transformPreviousPeriodData(h,g,(s?(0,m.TE)(s):void 0)??c?.[t]):null,timeAggregatedData:l?this.transformAggregatedTimeseries(h,d||""):{},timeframe:e.start&&e.end?g?{start:500*(e.start+e.end),end:1e3*e.end}:{start:1e3*e.start,end:1e3*e.end}:void 0}}render(){const{children:e,showLoading:t,...s}=this.props,{topEvents:r,yAxis:o}=this.props,{timeseriesData:a,reloading:i,errored:n,errorMessage:l}=this.state,d=this.props.loading||null===a;if(t&&d)return(0,y.tZ)(c.Z,{"data-test-id":"events-request-loading"});if((0,m.Xe)(a,(0,h.ri)(r))){let t;const r={},o=Object.keys(a).map(((e,s)=>{const o=a[e],i=this.processData(o,s,(0,v.bQ)(e));return t||(t=i.timeframe),i.isMetricsData&&(r[e]={isMetricsData:i.isMetricsData}),[o.order||0,i.data[0],i.previousData,{isMetricsData:i.isMetricsData}]})).sort(((e,t)=>e[0]-t[0])),p={};Object.keys(a).forEach((e=>{const t=a[e].meta?.fields[(0,v.LY)(e)];t&&(p[e]=t)}));const c=o.map((e=>e[1])),m=o.some((e=>null===e[2]))?void 0:o.map((e=>e[2]));return e({loading:d,reloading:i,errored:n,errorMessage:l,results:c,timeframe:t,previousTimeseriesData:m,seriesAdditionalInfo:r,timeseriesResultsTypes:p,...s})}if(a){const t=o&&("string"==typeof o?o:o[0]),r=t&&a.meta?.fields[(0,v.LY)(t)],p=r?{[t]:r}:void 0,{data:c,comparisonData:m,allData:u,originalData:h,totals:g,originalPreviousData:y,previousData:x,timeAggregatedData:f,timeframe:b,isMetricsData:Z}=this.processData(a);return e({loading:d,reloading:i,errored:n,errorMessage:l,seriesAdditionalInfo:{[this.props.currentSeriesNames?.[0]??"current"]:{isMetricsData:Z}},timeseriesData:c,comparisonTimeseriesData:m,allTimeseriesData:u,originalTimeseriesData:h,timeseriesTotals:g,originalPreviousTimeseriesData:y,previousTimeseriesData:x?[x]:x,timeAggregatedData:f,timeframe:b,timeseriesResultsTypes:p,...s})}return e({loading:d,reloading:i,errored:n,errorMessage:l,...s})}}b.displayName="EventsRequest",(0,r.Z)(b,"defaultProps",{period:void 0,start:null,end:null,interval:"1d",comparisonDelta:void 0,limit:15,query:"",includePrevious:!0,includeTransformedData:!0});const Z=b},"./app/components/charts/lineChart.tsx":(e,t,s)=>{s.d(t,{w:()=>i});var r=s("./app/components/charts/series/lineSeries.tsx"),o=s("./app/components/charts/baseChart.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{series:t,seriesOptions:s,...i}=e;return(0,a.tZ)(o.Z,{...i,series:t.map((e=>{let{seriesName:t,data:o,dataArray:a,...i}=e;return(0,r.Z)({...s,...i,name:t,data:a||o?.map((e=>{let{value:t,name:s}=e;return[s,t]})),animation:!1,animationThreshold:1,animationDuration:0})}))})}i.displayName="LineChart"},"./app/components/charts/optionSelector.tsx":(e,t,s)=>{s.d(t,{Z:()=>m});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),a=s("./app/components/compactSelect.tsx"),i=s("./app/components/featureBadge.tsx"),n=s("./app/components/truncate.tsx"),l=s("./app/utils.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{options:t,onChange:s,selected:r,title:i,featureType:p,multiple:m,...u}=e;const h=(0,o.useMemo)((()=>t.map((e=>({...e,label:(0,d.tZ)(n.Z,{value:String(e.label),maxLength:60,expandDirection:"left"})})))),[t]);return(0,d.tZ)(a.Z,{size:"sm",options:h,value:r,onChange:e=>{s(m?e.map((e=>e.value)):e.value)},isOptionDisabled:function(e){return e.disabled||m&&3===r.length&&!r.includes(e.value)},multiple:m,triggerProps:{borderless:!0,prefix:(0,d.BX)(o.Fragment,{children:[i,(0,l.ri)(p)?(0,d.tZ)(c,{type:p}):null]})},position:"bottom-end",...u})}p.displayName="OptionSelector";const c=(0,r.Z)(i.Z,{target:"e56rtee0"})({name:"6og82r",styles:"margin-left:0px"}),m=p},"./app/components/charts/releaseSeries.tsx":(e,t,s)=>{s.d(t,{Z:()=>j});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),a=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),i=s("../node_modules/lodash/isEqual.js"),n=s.n(i),l=s("../node_modules/lodash/memoize.js"),d=s.n(l),p=s("../node_modules/lodash/partition.js"),c=s.n(p),m=s("./app/actionCreators/indicator.tsx"),u=s("./app/components/charts/components/markLine.tsx"),h=s("./app/locale.tsx"),g=s("./app/utils.tsx"),v=s("./app/utils/dates.tsx"),y=s("./app/utils/formatters.tsx"),x=s("./app/utils/parseLinkHeader.tsx"),f=s("./app/utils/withApi.tsx"),b=s("./app/utils/withOrganization.tsx"),Z=s("./app/utils/withSentryRouter.tsx");function D(e,t,s){const r={};return Object.keys(s).forEach((e=>{let t=s[e];!t||"start"!==e&&"end"!==e||(t=(0,v.v5)(t)),t&&(r[e]=t)})),e.clear(),e.requestPromise(`/organizations/${t.slug}/releases/stats/`,{includeAllArgs:!0,method:"GET",query:r})}class S extends o.Component{constructor(){var e;super(...arguments),e=this,(0,r.Z)(this,"state",{releases:null,releaseSeries:[]}),(0,r.Z)(this,"_isMounted",!1),(0,r.Z)(this,"getOrganizationReleasesMemoized",d()(((e,t,s)=>D(e,t,s)),((e,t,s)=>Object.values(s).map((e=>JSON.stringify(e))).join("-")))),(0,r.Z)(this,"getReleaseSeries",(function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{organization:r,router:o,tooltip:a,environments:i,start:n,end:l,period:d,preserveQueryParams:p,queryExtra:c,theme:m}=e.props,x={...c};r.features.includes("global-views")&&(x.project=o.location.query.project),p&&(x.environment=[...i],x.start=n?(0,v.v5)(n):void 0,x.end=l?(0,v.v5)(l):void 0,x.statsPeriod=d||void 0);const f=(0,u.Z)({animation:!1,lineStyle:{color:m.purple300,opacity:.3,type:"solid",...s},label:{show:!1},data:t.map((e=>({xAxis:+new Date(e.date),name:(0,y.ko)(e.version,!0),value:(0,y.ko)(e.version,!0),onClick:()=>{o.push({pathname:`/organizations/${r.slug}/releases/${e.version}/`,query:x})},label:{formatter:()=>(0,y.ko)(e.version,!0)}}))),tooltip:a||{trigger:"item",formatter:t=>{let{data:s}=t;const r=(0,v.L0)(s.value,"MMM D, YYYY LT",{local:!e.props.utc}),o=(0,g.YU)((0,y.ko)(s.name,!0));return['<div class="tooltip-series">',`<div><span class="tooltip-label"><strong>${(0,h.t)("Release")}</strong></span> ${o}</div>`,"</div>",'<div class="tooltip-footer">',r,"</div>","</div>",'<div class="tooltip-arrow"></div>'].join("")}}});return{seriesName:"Releases",color:m.purple200,data:[],markLine:f}}))}componentDidMount(){this._isMounted=!0;const{releases:e}=this.props;e?this.setReleasesWithSeries(e):this.fetchData()}componentDidUpdate(e){n()(e.projects,this.props.projects)&&n()(e.environments,this.props.environments)&&n()(e.start,this.props.start)&&n()(e.end,this.props.end)&&n()(e.period,this.props.period)&&n()(e.query,this.props.query)?n()(e.emphasizeReleases,this.props.emphasizeReleases)||this.setReleasesWithSeries(this.state.releases):this.fetchData()}componentWillUnmount(){this._isMounted=!1,this.props.api.clear()}async fetchData(){const{api:e,organization:t,projects:s,environments:r,period:o,start:a,end:i,memoized:n,query:l}=this.props,d={start:a,end:i,project:s,environment:r,statsPeriod:o,query:l};let p=!0;const c=[];for(;p;)try{const s=n?this.getOrganizationReleasesMemoized:D,[r,,o]=await s(e,t,d);c.push(...r),this._isMounted&&this.setReleasesWithSeries(c);const a=o?.getResponseHeader("Link");if(a){const e=(0,x.Z)(a);p=e?.next?.results??!1,d.cursor=e.next.cursor}else p=!1}catch{(0,m.Iw)((0,h.t)("Error fetching releases")),p=!1}}setReleasesWithSeries(e){const{emphasizeReleases:t=[]}=this.props,s=[];if(t.length){const[r,o]=c()(e,(e=>!t.includes(e.version)));r.length&&s.push(this.getReleaseSeries(r,{type:"dotted"})),o.length&&s.push(this.getReleaseSeries(o,{opacity:.8}))}else s.push(this.getReleaseSeries(e));this.setState({releases:e,releaseSeries:s})}render(){const{children:e}=this.props;return e({releases:this.state.releases,releaseSeries:this.state.releaseSeries})}}S.displayName="ReleaseSeries";const j=(0,Z.Z)((0,b.Z)((0,f.Z)((0,a.b)(S))))},"./app/components/charts/transitionChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/react/index.js"),a=s("./app/components/charts/loadingPanel.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class n extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{prevReloading:this.props.reloading,prevLoading:this.props.loading,key:1})}static getDerivedStateFromProps(e,t){const s=t.prevReloading,r=e.reloading,o=t.prevLoading,a=e.loading;return o!==a?{prevReloading:r,prevLoading:a,key:t.key+1}:a?{prevReloading:r,prevLoading:a,key:t.key}:s&&!r?{prevReloading:r,prevLoading:a,key:t.key+1}:{prevReloading:r,prevLoading:a,key:t.key}}render(){const{height:e,loading:t,reloading:s}=this.props;return t&&!s?(0,i.tZ)(a.Z,{height:e,"data-test-id":"events-request-loading"}):(0,i.tZ)(o.Fragment,{children:this.props.children},String(this.state.key))}}n.displayName="TransitionChart",(0,r.Z)(n,"defaultProps",{height:"200px"});const l=n},"./app/components/charts/transparentLoadingMask.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("./app/components/loadingMask.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const i=(0,r.Z)((e=>{let{className:t,visible:s,children:r,...i}=e;const n=s?{...i,"data-test-id":"loading-placeholder"}:i;return(0,a.tZ)(o.Z,{className:t,...n,children:r})}),{target:"e1t3xibm0"})((e=>!e.visible&&"display: none;"),";opacity:0.4;z-index:1;")},"./app/components/charts/worldMapChart.tsx":(e,t,s)=>{s.d(t,{y:()=>c});var r=s("../node_modules/react/index.js"),o=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),a=s("../node_modules/echarts/lib/core/echarts.js"),i=s("../node_modules/lodash/max.js"),n=s.n(i),l=s("./app/components/charts/components/visualMap.tsx");s("../node_modules/echarts/lib/chart/map.js");var d=s("./app/components/charts/baseChart.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){let{series:t,seriesOptions:i,fromDiscover:c,fromDiscoverQueryList:m,...u}=e;const h=(0,o.u)(),[g,v]=(0,r.useState)((()=>({countryToCodeMap:null,map:null,codeToCountryMap:null})));if((0,r.useEffect)((()=>{let e=!1;return e||async function(){try{const[e,t]=await Promise.all([s.e("app_data_countryCodesMap_tsx").then(s.bind(s,"./app/data/countryCodesMap.tsx")),s.e("app_data_world_json").then(s.t.bind(s,"./app/data/world.json",19))]),r=e.default,o=t.default;a.je?.("sentryWorld",o);const i={};for(const e in o)i[r[e]]=e;v({countryToCodeMap:r,map:o,codeToCountryMap:i})}catch{}}(),()=>{e=!0}}),[]),null===g.countryToCodeMap||null===g.map)return null;const y=t.map((e=>{let{seriesName:t,data:s,...r}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{map:""};return{roam:!0,...e,emphasis:{label:{show:!1},...e.emphasis},type:"map"}}({...i,...r,map:"sentryWorld",name:t,nameMap:g.countryToCodeMap??void 0,aspectScale:.85,zoom:c?1.1:m?.9:1.3,center:[10.97,m?-12:9.71],itemStyle:{areaColor:h.gray200,borderColor:h.backgroundSecondary},emphasis:{itemStyle:{areaColor:h.pink300},label:{show:!1}},data:s,silent:m,roam:!m})})),x=n()(t.map((e=>{let{data:t}=e;return n()(t.map((e=>{let{value:t}=e;return t})))})))||1;return(0,p.tZ)(d.Z,{options:{backgroundColor:m?void 0:h.background,visualMap:[(0,l.Z)({show:!m,left:c?void 0:"right",right:c?5:void 0,min:0,max:x,inRange:{color:[h.purple200,h.purple300]},text:["High","Low"],textStyle:{color:h.textColor},calculable:!1})]},...u,yAxis:null,xAxis:null,series:y,tooltip:{formatter:e=>{const{marker:t,name:s,value:r}=Array.isArray(e)?e[0]:e;if(isNaN(r))return"";const o="number"==typeof r?r.toLocaleString():"";return[`<div class="tooltip-series tooltip-series-solo">\n               <div><span class="tooltip-label">${t} <strong>${g.codeToCountryMap?.[s]||s}</strong></span> ${o}</div>\n            </div>`,'<div class="tooltip-arrow"></div>'].join("")}},height:c?400:void 0})}c.displayName="WorldMapChart"}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_eventsChart_tsx-app_components_charts_optionSelector_tsx.f5a063b6c6d4339d0eec128935f3924d.js.map