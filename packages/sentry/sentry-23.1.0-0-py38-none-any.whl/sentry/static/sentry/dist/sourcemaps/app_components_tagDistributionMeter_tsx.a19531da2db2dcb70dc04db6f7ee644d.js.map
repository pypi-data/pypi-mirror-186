{"version":3,"file":"chunks/app_components_tagDistributionMeter_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/tagDistributionMeter.tsx"],"sourcesContent":["import {Fragment} from 'react';\nimport isPropValid from '@emotion/is-prop-valid';\nimport styled from '@emotion/styled';\nimport {LocationDescriptor} from 'history';\n\nimport {TagSegment} from 'sentry/actionCreators/events';\nimport Link from 'sentry/components/links/link';\nimport Tooltip from 'sentry/components/tooltip';\nimport Version from 'sentry/components/version';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {percent} from 'sentry/utils';\n\ntype Props = {\n  segments: TagSegment[];\n  title: string;\n  totalValues: number;\n  colors?: string[];\n  hasError?: boolean;\n  isLoading?: boolean;\n  onTagClick?: (title: string, value: TagSegment) => void;\n  renderEmpty?: () => React.ReactNode;\n  renderError?: () => React.ReactNode;\n  renderLoading?: () => React.ReactNode;\n  showReleasePackage?: boolean;\n  showTitle?: boolean;\n};\n\nexport type SegmentValue = {\n  index: number;\n  onClick: () => void;\n  to: LocationDescriptor;\n};\n\nfunction TagDistributionMeter({\n  colors = COLORS,\n  isLoading = false,\n  hasError = false,\n  renderLoading = () => null,\n  renderEmpty = () => <p>{t('No recent data.')}</p>,\n  renderError = () => null,\n  showReleasePackage = false,\n  showTitle = true,\n  segments,\n  title,\n  totalValues,\n  onTagClick,\n}: Props) {\n  function renderTitle() {\n    if (!Array.isArray(segments) || segments.length <= 0) {\n      return (\n        <Title>\n          <TitleType>{title}</TitleType>\n        </Title>\n      );\n    }\n\n    const largestSegment = segments[0];\n    const pct = percent(largestSegment.count, totalValues);\n    const pctLabel = Math.floor(pct);\n    const renderLabel = () => {\n      switch (title) {\n        case 'release':\n          return (\n            <Label>\n              <Version\n                version={largestSegment.name}\n                anchor={false}\n                tooltipRawVersion\n                withPackage={showReleasePackage}\n                truncate\n              />\n            </Label>\n          );\n        default:\n          return <Label>{largestSegment.name || t('n/a')}</Label>;\n      }\n    };\n\n    return (\n      <Title>\n        <TitleType>{title}</TitleType>\n        <TitleDescription>\n          {renderLabel()}\n          {isLoading || hasError ? null : <Percent>{pctLabel}%</Percent>}\n        </TitleDescription>\n      </Title>\n    );\n  }\n\n  function renderSegments() {\n    if (isLoading) {\n      return renderLoading();\n    }\n\n    if (hasError) {\n      return <SegmentBar>{renderError()}</SegmentBar>;\n    }\n\n    if (totalValues === 0) {\n      return <SegmentBar>{renderEmpty()}</SegmentBar>;\n    }\n\n    return (\n      <SegmentBar>\n        {segments.map((value, index) => {\n          const pct = percent(value.count, totalValues);\n          const pctLabel = Math.floor(pct);\n          const renderTooltipValue = () => {\n            switch (title) {\n              case 'release':\n                return (\n                  <Version\n                    version={value.name}\n                    anchor={false}\n                    withPackage={showReleasePackage}\n                  />\n                );\n              default:\n                return value.name || t('n/a');\n            }\n          };\n\n          const tooltipHtml = (\n            <Fragment>\n              <div className=\"truncate\">{renderTooltipValue()}</div>\n              {pctLabel}%\n            </Fragment>\n          );\n\n          const segmentProps: SegmentValue = {\n            index,\n            to: value.url,\n            onClick: () => onTagClick?.(title, value),\n          };\n\n          return (\n            <div key={value.value} style={{width: pct + '%'}}>\n              <Tooltip title={tooltipHtml} containerDisplayMode=\"block\">\n                {value.isOther ? (\n                  <OtherSegment\n                    aria-label={t('Other')}\n                    color={colors[colors.length - 1]}\n                  />\n                ) : (\n                  <Segment\n                    aria-label={t(\n                      'Add the %s %s segment tag to the search query',\n                      title,\n                      value.value\n                    )}\n                    color={colors[index]}\n                    {...segmentProps}\n                  />\n                )}\n              </Tooltip>\n            </div>\n          );\n        })}\n      </SegmentBar>\n    );\n  }\n\n  const totalVisible = segments.reduce((sum, value) => sum + value.count, 0);\n  const hasOther = totalVisible < totalValues;\n\n  if (hasOther) {\n    segments.push({\n      isOther: true,\n      name: t('Other'),\n      value: 'other',\n      count: totalValues - totalVisible,\n      url: '',\n    });\n  }\n\n  return (\n    <TagSummary>\n      {showTitle && renderTitle()}\n      {renderSegments()}\n    </TagSummary>\n  );\n}\n\nexport default TagDistributionMeter;\n\nconst COLORS = [\n  '#3A3387',\n  '#5F40A3',\n  '#8C4FBD',\n  '#B961D3',\n  '#DE76E4',\n  '#EF91E8',\n  '#F7B2EC',\n  '#FCD8F4',\n  '#FEEBF9',\n];\n\nconst TagSummary = styled('div')`\n  margin-bottom: ${space(1)};\n`;\n\nconst SegmentBar = styled('div')`\n  display: flex;\n  overflow: hidden;\n  border-radius: ${p => p.theme.borderRadius};\n`;\n\nconst Title = styled('div')`\n  display: flex;\n  font-size: ${p => p.theme.fontSizeSmall};\n  justify-content: space-between;\n  margin-bottom: ${space(0.25)};\n  line-height: 1.1;\n`;\n\nconst TitleType = styled('div')`\n  color: ${p => p.theme.textColor};\n  font-weight: bold;\n  ${p => p.theme.overflowEllipsis};\n`;\n\nconst TitleDescription = styled('div')`\n  display: flex;\n  color: ${p => p.theme.gray300};\n  text-align: right;\n`;\n\nconst Label = styled('div')`\n  ${p => p.theme.overflowEllipsis};\n  max-width: 150px;\n`;\n\nconst Percent = styled('div')`\n  font-weight: bold;\n  font-variant-numeric: tabular-nums;\n  padding-left: ${space(0.5)};\n  color: ${p => p.theme.textColor};\n`;\n\nconst OtherSegment = styled('span')<{color: string}>`\n  display: block;\n  width: 100%;\n  height: 16px;\n  color: inherit;\n  outline: none;\n  background-color: ${p => p.color};\n`;\n\nconst Segment = styled(Link, {shouldForwardProp: isPropValid})<{color: string}>`\n  display: block;\n  width: 100%;\n  height: 16px;\n  color: inherit;\n  outline: none;\n  background-color: ${p => p.color};\n  border-radius: 0;\n`;\n"],"names":["TagDistributionMeter","colors","COLORS","isLoading","hasError","renderLoading","renderEmpty","t","renderError","showReleasePackage","showTitle","segments","title","totalValues","onTagClick","totalVisible","reduce","sum","value","count","push","isOther","name","url","TagSummary","Array","isArray","length","Title","TitleType","largestSegment","pct","percent","pctLabel","Math","floor","TitleDescription","Label","version","anchor","tooltipRawVersion","withPackage","truncate","Percent","renderTitle","SegmentBar","map","index","tooltipHtml","Fragment","className","segmentProps","to","onClick","style","width","containerDisplayMode","OtherSegment","color","Segment","space","p","theme","borderRadius","fontSizeSmall","textColor","overflowEllipsis","gray300","Link","shouldForwardProp","isPropValid"],"sourceRoot":""}