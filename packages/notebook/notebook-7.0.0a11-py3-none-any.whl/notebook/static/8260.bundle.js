"use strict";(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[8260,6507],{86507:(e,s,t)=>{t.r(s),t.d(s,{IDocumentProviderFactory:()=>i,ProviderMock:()=>r,WebSocketProvider:()=>c});class r{constructor(){this._isDisposed=!1}get isDisposed(){return this._isDisposed}get ready(){return Promise.resolve()}dispose(){this.isDisposed||(this._isDisposed=!0)}}var o=t(76103);const i=new o.Token("@jupyterlab/docprovider:IDocumentProviderFactory");var n=t(90877),a=t(68770),h=t(7191),d=t(90829);class c{constructor(e){this._ready=new o.PromiseDelegate,this._isDisposed=!1,this._path=e.path,this._contentType=e.contentType,this._format=e.format,this._serverUrl=e.url,this._ydoc=e.model.ydoc,this._awareness=e.model.awareness;const s=e.user;s.ready.then((()=>{this._onUserChanged(s)})).catch((e=>console.error(e))),s.userChanged.connect(this._onUserChanged,this);const t=a.ServerConnection.makeSettings(),r=n.URLExt.join(t.baseUrl,"api/yjs/roomid",encodeURIComponent(this._path)),i={method:"PUT",body:JSON.stringify({format:this._format,type:this._contentType})};a.ServerConnection.makeRequest(r,i,t).then((e=>{if(200!==e.status&&201!==e.status)throw new a.ServerConnection.ResponseError(e);return e.text()})).then((e=>{this._yWebsocketProvider=new d.WebsocketProvider(this._serverUrl,e,this._ydoc,{awareness:this._awareness})})).then((()=>this._ready.resolve())).catch((e=>console.warn(e)))}get isDisposed(){return this._isDisposed}get ready(){return this._ready.promise}dispose(){this.isDisposed||(this._isDisposed=!0,this._yWebsocketProvider.destroy(),h.Signal.clearData(this))}_onUserChanged(e){this._awareness.setLocalStateField("user",e.identity)}}}}]);