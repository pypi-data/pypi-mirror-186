import{defineComponent as b,resolveComponent as $,openBlock as u,createBlock as x,withCtx as S,createElementBlock as d,Fragment as m,renderList as g,createElementVNode as a,ref as p,createTextVNode as C,toDisplayString as h,createCommentVNode as w}from"vue";import{ContentLoader as L}from"vue-content-loader";function _e(){import("data:text/javascript,")}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var y;const _=(y=globalThis.udata_front)!==null&&y!==void 0?y:{components:{},translations:[]};function U(e,t,r,o){_.components[e]||(_.components[e]=[]);const n={component:t,hook:e,module:r,name:o};return _.components[e].push(n),n}function T(e,t){const r={messages:e,module:t};return _.translations.push(r),r}globalThis.udata_front=_;let s={csvapiUrl:null,dataEndpoint:null,filters:[],page:1,pageSize:10,sortBy:null,sortDesc:!1,totalRows:0};function z(e){s={...s,...e}}function k(e){let t=0;if(e&&e==="page"?t=s.pageSize*(s.page-1):s.page=1,!s.dataEndpoint)throw Error("No dataEndpoint configured. Use configure() before to add it.");const r=new URL(s.dataEndpoint);if(r.searchParams.set("_shape","objects"),r.searchParams.set("_rowid","hide"),r.searchParams.set("_size",s.pageSize.toString()),r.searchParams.set("_offset",t.toString()),s.filters.forEach(({field:o,value:n,comp:i})=>{r.searchParams.set(`${o}__${i}`,n)}),s.sortBy){const o=s.sortDesc?"_sort_desc":"_sort";r.searchParams.set(o,s.sortBy)}return r}function N(e){const t=k(e);return fetch(t.toString()).then(r=>{const o=r.json();return r.ok||Promise.reject(o),o})}function j(e){if(!s.csvapiUrl)throw Error("No csvapiUrl configured. Use configure() before to add it.");const t=new URL(s.csvapiUrl);return t.pathname="/apify",t.searchParams.set("url",encodeURI(e)),t.searchParams.set("analysis","yes"),fetch(t.toString()).then(r=>{const o=r.json();return r.ok||Promise.reject(o),o})}function Y(e,t){const r=document.querySelector(e);return r?r.getAttribute(t):null}function E(e){return Y(`meta[name=${e}]`,"content")}const B=E("tabular-csvapi-url"),v=E("tabular-page-size"),P=(e,t)=>{const r=e.__vccOpts||e;for(const[o,n]of t)r[o]=n;return r},O=b({components:{ContentLoader:L},setup(){return{getY(e){return 16+4+e*(16*2+24)}}}}),D=a("rect",{x:"16",y:"16",rx:"4",ry:"4",width:"112",height:"24"},null,-1),A=a("rect",{x:"160",y:"16",rx:"4",ry:"4",width:"116",height:"24"},null,-1),R=a("rect",{x:"308",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1),q=a("rect",{x:"480",y:"16",rx:"4",ry:"4",width:"106",height:"24"},null,-1),F=a("rect",{x:"618",y:"16",rx:"4",ry:"4",width:"140",height:"24"},null,-1),V=a("rect",{x:"790",y:"16",rx:"4",ry:"4",width:"144",height:"24"},null,-1),I=a("rect",{x:"966",y:"16",rx:"4",ry:"4",width:"142",height:"24"},null,-1),M=a("rect",{x:"4",y:"56",rx:"4",ry:"4",width:"1116",height:"4"},null,-1),K=["y"],G=["y"],H=["y"],J=["y"],Q=["y"],W=["y"],X=["y"];function Z(e,t,r,o,n,i){const c=$("ContentLoader");return u(),x(c,{width:1124,height:300,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},{default:S(()=>[D,A,R,q,F,V,I,M,(u(),d(m,null,g(5,l=>(u(),d(m,null,[a("rect",{x:"16",y:e.getY(l),rx:"4",ry:"4",width:"112",height:"32"},null,8,K),a("rect",{x:"160",y:e.getY(l),rx:"4",ry:"4",width:"116",height:"32"},null,8,G),a("rect",{x:"308",y:e.getY(l),rx:"4",ry:"4",width:"140",height:"32"},null,8,H),a("rect",{x:"480",y:e.getY(l),rx:"4",ry:"4",width:"106",height:"32"},null,8,J),a("rect",{x:"618",y:e.getY(l),rx:"4",ry:"4",width:"140",height:"32"},null,8,Q),a("rect",{x:"790",y:e.getY(l),rx:"4",ry:"4",width:"144",height:"32"},null,8,W),a("rect",{x:"966",y:e.getY(l),rx:"4",ry:"4",width:"142",height:"32"},null,8,X)],64))),64))]),_:1})}const ee=P(O,[["render",Z]]),te=b({components:{Loader:ee},props:{resource:{type:Object,required:!0}},setup(e){const t=p([]),r=p([]),o=p(null),n=p(null),i=p(!0),c=p(!1);return z({csvapiUrl:B,pageSize:v}),j(e.resource.url).then(l=>{if(l.ok)return z({dataEndpoint:l.endpoint}),N("apify").then(f=>{f.ok?(r.value=f.rows,t.value=f.columns,o.value=f.total,n.value=f.columns.length):c.value=!0}).catch(()=>c.value=!0).finally(()=>i.value=!1);c.value=!0,i.value=!1}).catch(()=>{c.value=!0,i.value=!1}),{hasError:c,loading:i,columns:t,rows:r,rowCount:o,columnCount:n,tabular_page_size:v}}}),re={key:0,class:"bg-alt-green-tilleul-verveine fr-p-3v fr-my-2w"},oe={class:"fr-grid-row fr-m-0"},ne=a("span",{class:"fr-icon-warning-line","aria-hidden":"true"},null,-1),ae={class:"fr-table fr-table--no-background fr-p-0 fr-pt-0-5v fr-m-0"},ie={class:"fr-mb-3w"},le={class:"fr-sr-only"},se={scope:"col"},ce={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle fr-px-5v"},ue={class:"fr-col"},de={class:"fr-col-auto"},fe=["href"];function he(e,t,r,o,n,i){const c=$("Loader");return u(),d(m,null,[e.hasError?(u(),d("div",re,[a("p",oe,[ne,C(" "+h(e.$t("The preview of this file failed to load.")),1)])])):w("",!0),e.loading?(u(),x(c,{key:1})):w("",!0),!e.hasError&&!e.loading?(u(),d(m,{key:2},[a("div",ae,[a("table",ie,[a("caption",le,h(e.$t("Preview of {name}",{name:e.resource.title})),1),a("thead",null,[a("tr",null,[(u(!0),d(m,null,g(e.columns,l=>(u(),d("th",se,h(l),1))),256))])]),a("tbody",null,[(u(!0),d(m,null,g(e.rows,l=>(u(),d("tr",null,[(u(!0),d(m,null,g(e.columns,f=>(u(),d("td",null,h(l[f]),1))),256))]))),256))])])]),a("div",ce,[a("div",ue,h(e.$t("{count} columns",e.columnCount))+" \u2014 "+h(e.$t("Showing the first {shown} of {count} rows",{shown:Math.min(e.tabular_page_size,e.rowCount),count:e.rowCount})),1),a("div",de,[a("a",{href:e.resource.preview_url,class:"fr-btn fr-btn--icon-left fr-icon-test-tube-line"},h(e.$t("Explore data")),9,fe)])])],64)):w("",!0)],64)}const me=P(te,[["render",he]]),pe={en:{"Preview of {name}":e=>{const{normalize:t,interpolate:r,named:o}=e;return t(["Preview of ",r(o("name"))])},"{count} columns":e=>{const{normalize:t,interpolate:r,named:o,plural:n}=e;return n([t([r(o("count"))," columns"]),t([r(o("count"))," column"]),t([r(o("count"))," columns"])])},"Showing the first {shown} of {count} rows":e=>{const{normalize:t,interpolate:r,named:o,plural:n}=e;return n([t(["No rows in file"]),t(["Showing the only row"]),t(["Showing the first ",r(o("shown"))," of ",r(o("count"))," rows"])])},"Explore data":e=>{const{normalize:t}=e;return t(["Explore data"])},"The preview of this file failed to load.":e=>{const{normalize:t}=e;return t(["The preview of this file failed to load."])}},es:{"Preview of {name}":e=>{const{normalize:t}=e;return t([])},"{count} columns":e=>{const{normalize:t}=e;return t([])},"Showing the first {shown} of {count} rows":e=>{const{normalize:t}=e;return t([])},"Explore data":e=>{const{normalize:t}=e;return t([])},"The preview of this file failed to load.":e=>{const{normalize:t}=e;return t([])}},fr:{"Preview of {name}":e=>{const{normalize:t,interpolate:r,named:o}=e;return t(["Pr\xE9visualisation de ",r(o("name"))])},"{count} columns":e=>{const{normalize:t,interpolate:r,named:o,plural:n}=e;return n([t([r(o("count"))," colonnes"]),t([r(o("count"))," colonne"]),t([r(o("count"))," colonnes"])])},"Showing the first {shown} of {count} rows":e=>{const{normalize:t,interpolate:r,named:o,plural:n}=e;return n([t(["Pas de ligne dans le fichier"]),t(["Affichage de la seule ligne"]),t(["Affichage des ",r(o("shown"))," premi\xE8res lignes sur ",r(o("count"))])])},"Explore data":e=>{const{normalize:t}=e;return t(["Explorer les donn\xE9es"])},"The preview of this file failed to load.":e=>{const{normalize:t}=e;return t(["La pr\xE9visualisation de ce fichier n'a pas pu \xEAtre charg\xE9e."])}},it:{"Preview of {name}":e=>{const{normalize:t}=e;return t([])},"{count} columns":e=>{const{normalize:t}=e;return t([])},"{count} rows":e=>{const{normalize:t}=e;return t([])},"Explore data":e=>{const{normalize:t}=e;return t([])},"The preview of this file failed to load.":e=>{const{normalize:t}=e;return t([])}},sr:{"Preview of {name}":e=>{const{normalize:t}=e;return t([])},"{count} columns":e=>{const{normalize:t}=e;return t([])},"{count} rows":e=>{const{normalize:t}=e;return t([])},"Explore data":e=>{const{normalize:t}=e;return t([])},"The preview of this file failed to load.":e=>{const{normalize:t}=e;return t([])}}};U("explore",me,"udata-tabular-preview","explore");T(pe,"udata-tabular-preview");export{_e as __vite_legacy_guard};
